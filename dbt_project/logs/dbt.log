[0m12:10:46.991440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db3abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3de760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3de820>]}


============================== 12:10:46.995680 | 54e91933-1027-4b0a-adbf-554b5ddf7ba5 ==============================
[0m12:10:46.995680 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:10:46.996173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:10:47.178490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54e91933-1027-4b0a-adbf-554b5ddf7ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e05ef70>]}
[0m12:10:47.237430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54e91933-1027-4b0a-adbf-554b5ddf7ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4f0460>]}
[0m12:10:47.238208 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:10:47.243627 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:10:47.244421 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:10:47.244779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '54e91933-1027-4b0a-adbf-554b5ddf7ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6a8580>]}
[0m12:10:47.853709 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.simple_dbt_project.fct_user_events_incremental' (models/marts/fct_user_events_incremental.sql) depends on a source named 'raw.user_events' which was not found
[0m12:10:47.854844 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.89375496, "process_user_time": 2.482825, "process_kernel_time": 0.290318, "process_mem_max_rss": "121828", "process_in_blocks": "21200", "process_out_blocks": "1685", "command_success": false}
[0m12:10:47.855307 [debug] [MainThread]: Command `dbt run` failed at 12:10:47.855217 after 0.89 seconds
[0m12:10:47.855652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db3abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a052b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d05a30>]}
[0m12:10:47.856022 [debug] [MainThread]: Flushing usage events
[0m12:11:08.755528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5c6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbc1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbc1610>]}


============================== 12:11:08.759595 | b7689d7b-3298-43f0-98bd-a88b02d842c4 ==============================
[0m12:11:08.759595 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:11:08.760191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_orders --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:11:08.933355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7689d7b-3298-43f0-98bd-a88b02d842c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad440220>]}
[0m12:11:08.982301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7689d7b-3298-43f0-98bd-a88b02d842c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac41d670>]}
[0m12:11:08.982928 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:11:08.987986 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:11:08.988675 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:11:08.989023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b7689d7b-3298-43f0-98bd-a88b02d842c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaed4550>]}
[0m12:11:09.574322 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.simple_dbt_project.fct_user_events_incremental' (models/marts/fct_user_events_incremental.sql) depends on a source named 'raw.user_events' which was not found
[0m12:11:09.575371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.84356344, "process_user_time": 2.338231, "process_kernel_time": 0.172017, "process_mem_max_rss": "122072", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m12:11:09.575815 [debug] [MainThread]: Command `dbt run` failed at 12:11:09.575713 after 0.84 seconds
[0m12:11:09.576137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5c6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa550b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa550c10>]}
[0m12:11:09.576438 [debug] [MainThread]: Flushing usage events
[0m12:11:38.697837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb004df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad6c2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad6c2d00>]}


============================== 12:11:38.702284 | f3369c6d-d13b-42c6-82f1-9d16f2b750df ==============================
[0m12:11:38.702284 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:11:38.702741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_orders --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:11:38.864177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3369c6d-d13b-42c6-82f1-9d16f2b750df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef043a0>]}
[0m12:11:38.912654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3369c6d-d13b-42c6-82f1-9d16f2b750df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7ac970>]}
[0m12:11:38.913224 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:11:38.918179 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:11:38.918894 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:11:38.919181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f3369c6d-d13b-42c6-82f1-9d16f2b750df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9d9130>]}
[0m12:11:39.509437 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.simple_dbt_project.fct_user_events_incremental' (models/marts/fct_user_events_incremental.sql) depends on a source named 'raw.user_events' which was not found
[0m12:11:39.510414 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8379602, "process_user_time": 2.350213, "process_kernel_time": 0.177393, "process_mem_max_rss": "122180", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m12:11:39.510821 [debug] [MainThread]: Command `dbt run` failed at 12:11:39.510722 after 0.84 seconds
[0m12:11:39.511126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb004df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2963a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2962e0>]}
[0m12:11:39.511393 [debug] [MainThread]: Flushing usage events
[0m12:12:04.459643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91291e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e900280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e900e20>]}


============================== 12:12:04.464911 | c5f370ac-d96f-4b62-a9b5-aebde64167d8 ==============================
[0m12:12:04.464911 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:12:04.465376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_orders --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:12:04.630372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5f370ac-d96f-4b62-a9b5-aebde64167d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd7c3d0>]}
[0m12:12:04.680021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5f370ac-d96f-4b62-a9b5-aebde64167d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9c3ca0>]}
[0m12:12:04.680703 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:12:04.685658 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:12:04.686438 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:12:04.686785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c5f370ac-d96f-4b62-a9b5-aebde64167d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc54220>]}
[0m12:12:05.300603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5f370ac-d96f-4b62-a9b5-aebde64167d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d53beb0>]}
[0m12:12:05.312173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5f370ac-d96f-4b62-a9b5-aebde64167d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d53bf40>]}
[0m12:12:05.312575 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m12:12:05.312975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5f370ac-d96f-4b62-a9b5-aebde64167d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd24fd0>]}
[0m12:12:05.313845 [info ] [MainThread]: 
[0m12:12:05.314420 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:12:05.315296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:12:05.321823 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:12:05.322339 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:12:05.322657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:05.333870 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:12:05.334977 [debug] [ThreadPool]: On list_airflow: Close
[0m12:12:05.336913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m12:12:05.344634 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:12:05.345423 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m12:12:05.345783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:05.349352 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:12:05.349974 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:12:05.350244 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:12:05.353337 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.0 seconds
[0m12:12:05.354683 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m12:12:05.355052 [debug] [ThreadPool]: On list_airflow_public: Close
[0m12:12:05.363344 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:05.363803 [debug] [MainThread]: On master: BEGIN
[0m12:12:05.364049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:12:05.366486 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:12:05.366778 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:05.367058 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:12:05.368955 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:12:05.369719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5f370ac-d96f-4b62-a9b5-aebde64167d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4891f0>]}
[0m12:12:05.370055 [debug] [MainThread]: On master: ROLLBACK
[0m12:12:05.370380 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:05.370601 [debug] [MainThread]: On master: BEGIN
[0m12:12:05.371047 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:12:05.371292 [debug] [MainThread]: On master: COMMIT
[0m12:12:05.371525 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:05.371758 [debug] [MainThread]: On master: COMMIT
[0m12:12:05.372080 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:12:05.372310 [debug] [MainThread]: On master: Close
[0m12:12:05.372788 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:12:05.373182 [info ] [MainThread]: 
[0m12:12:05.379446 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.stg_orders
[0m12:12:05.379989 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_orders .................................. [RUN]
[0m12:12:05.380567 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.stg_orders)
[0m12:12:05.380914 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m12:12:05.386488 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m12:12:05.388956 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 12:12:05.381199 => 12:12:05.388725
[0m12:12:05.389300 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.stg_orders
[0m12:12:05.488141 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m12:12:05.493429 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:12:05.494463 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m12:12:05.495163 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:12:05.529991 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:12:05.533148 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:12:05.533535 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m12:12:05.541231 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:12:05.549937 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:12:05.550477 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:12:05.551685 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:12:05.568096 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:12:05.568774 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:12:05.569091 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:12:05.570095 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:12:05.578162 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."stg_orders__dbt_backup"
[0m12:12:05.581768 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:12:05.582155 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
drop view if exists "airflow"."public"."stg_orders__dbt_backup" cascade
[0m12:12:05.582747 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:12:05.583912 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 12:12:05.389485 => 12:12:05.583742
[0m12:12:05.584293 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: Close
[0m12:12:05.585113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5f370ac-d96f-4b62-a9b5-aebde64167d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0ae190>]}
[0m12:12:05.586155 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.20s]
[0m12:12:05.587790 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.stg_orders
[0m12:12:05.589333 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:05.589635 [debug] [MainThread]: On master: BEGIN
[0m12:12:05.589956 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:12:05.594392 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:12:05.594871 [debug] [MainThread]: On master: COMMIT
[0m12:12:05.595217 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:05.595486 [debug] [MainThread]: On master: COMMIT
[0m12:12:05.595822 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:12:05.596149 [debug] [MainThread]: On master: Close
[0m12:12:05.596774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:05.597253 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m12:12:05.597554 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m12:12:05.598015 [info ] [MainThread]: 
[0m12:12:05.598401 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m12:12:05.599143 [debug] [MainThread]: Command end result
[0m12:12:05.746571 [info ] [MainThread]: 
[0m12:12:05.748372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:05.749997 [info ] [MainThread]: 
[0m12:12:05.750608 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:12:05.753921 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.320488, "process_user_time": 2.756949, "process_kernel_time": 0.285519, "process_mem_max_rss": "128696", "process_out_blocks": "2387", "process_in_blocks": "0"}
[0m12:12:05.755822 [debug] [MainThread]: Command `dbt run` succeeded at 12:12:05.755263 after 1.32 seconds
[0m12:12:05.757237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91291e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd24fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d53bee0>]}
[0m12:12:05.758556 [debug] [MainThread]: Flushing usage events
[0m12:15:03.052538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8022dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8df430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8dfee0>]}


============================== 12:15:03.056771 | dde9f24d-940b-4c17-89a7-c8276086b0be ==============================
[0m12:15:03.056771 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:15:03.057320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_orders --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m12:15:03.212557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dde9f24d-940b-4c17-89a7-c8276086b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8059ef70>]}
[0m12:15:03.267917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dde9f24d-940b-4c17-89a7-c8276086b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8290fdc0>]}
[0m12:15:03.268675 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:15:03.274511 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:15:03.306210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:15:03.306762 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:15:03.311498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dde9f24d-940b-4c17-89a7-c8276086b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c979ee0>]}
[0m12:15:03.322534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dde9f24d-940b-4c17-89a7-c8276086b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca3fd60>]}
[0m12:15:03.322939 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m12:15:03.323259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dde9f24d-940b-4c17-89a7-c8276086b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca3fee0>]}
[0m12:15:03.324224 [info ] [MainThread]: 
[0m12:15:03.324899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:15:03.325807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:15:03.334831 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:15:03.335271 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:15:03.335545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:03.345156 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:15:03.346283 [debug] [ThreadPool]: On list_airflow: Close
[0m12:15:03.347742 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m12:15:03.353586 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:15:03.354035 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m12:15:03.354331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:03.357816 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:15:03.358344 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:15:03.358631 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:15:03.363150 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.0 seconds
[0m12:15:03.364821 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m12:15:03.365872 [debug] [ThreadPool]: On list_airflow_public: Close
[0m12:15:03.374848 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:03.375328 [debug] [MainThread]: On master: BEGIN
[0m12:15:03.375632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:03.379358 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:15:03.379821 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:03.380194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:15:03.383881 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:15:03.385217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dde9f24d-940b-4c17-89a7-c8276086b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c980430>]}
[0m12:15:03.385849 [debug] [MainThread]: On master: ROLLBACK
[0m12:15:03.386555 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:03.386989 [debug] [MainThread]: On master: BEGIN
[0m12:15:03.387722 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:15:03.388573 [debug] [MainThread]: On master: COMMIT
[0m12:15:03.389378 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:03.389951 [debug] [MainThread]: On master: COMMIT
[0m12:15:03.390735 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:15:03.391325 [debug] [MainThread]: On master: Close
[0m12:15:03.392683 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:15:03.393115 [info ] [MainThread]: 
[0m12:15:03.401890 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.stg_orders
[0m12:15:03.402479 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_orders .................................. [RUN]
[0m12:15:03.403144 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.stg_orders)
[0m12:15:03.403571 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m12:15:03.411033 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m12:15:03.412835 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 12:15:03.403794 => 12:15:03.412586
[0m12:15:03.413203 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.stg_orders
[0m12:15:03.554223 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m12:15:03.556494 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:15:03.557174 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m12:15:03.557791 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:15:03.564831 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:15:03.565431 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:15:03.565858 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m12:15:03.571083 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:15:03.577054 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:15:03.577635 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:15:03.578856 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:15:03.592636 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:15:03.593242 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:15:03.593658 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:15:03.594816 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:15:03.601775 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."stg_orders__dbt_backup"
[0m12:15:03.605660 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:15:03.606186 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
drop view if exists "airflow"."public"."stg_orders__dbt_backup" cascade
[0m12:15:03.606958 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:15:03.608466 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 12:15:03.413427 => 12:15:03.608265
[0m12:15:03.608990 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: Close
[0m12:15:03.609984 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dde9f24d-940b-4c17-89a7-c8276086b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf6e700>]}
[0m12:15:03.610657 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.21s]
[0m12:15:03.611665 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.stg_orders
[0m12:15:03.613674 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:03.614218 [debug] [MainThread]: On master: BEGIN
[0m12:15:03.614547 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:15:03.618428 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:15:03.619405 [debug] [MainThread]: On master: COMMIT
[0m12:15:03.620186 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:03.620688 [debug] [MainThread]: On master: COMMIT
[0m12:15:03.621232 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:15:03.621651 [debug] [MainThread]: On master: Close
[0m12:15:03.622788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:03.623606 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m12:15:03.624023 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m12:15:03.624451 [info ] [MainThread]: 
[0m12:15:03.625670 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m12:15:03.627239 [debug] [MainThread]: Command end result
[0m12:15:03.637402 [info ] [MainThread]: 
[0m12:15:03.638170 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:03.640476 [info ] [MainThread]: 
[0m12:15:03.641187 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:15:03.643814 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.61616594, "process_user_time": 2.127671, "process_kernel_time": 0.383245, "process_mem_max_rss": "121916", "process_out_blocks": "3288", "process_in_blocks": "0"}
[0m12:15:03.644578 [debug] [MainThread]: Command `dbt run` succeeded at 12:15:03.644446 after 0.62 seconds
[0m12:15:03.645254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8022dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb67820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8059ef70>]}
[0m12:15:03.646235 [debug] [MainThread]: Flushing usage events
[0m12:18:01.964098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1c7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88801730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88801c10>]}


============================== 12:18:01.968522 | 72d17d3c-b310-471d-9a69-cf79b82b17e2 ==============================
[0m12:18:01.968522 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:18:01.969203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:18:02.111668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72d17d3c-b310-471d-9a69-cf79b82b17e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff888c5df0>]}
[0m12:18:02.159761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72d17d3c-b310-471d-9a69-cf79b82b17e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d86e370>]}
[0m12:18:02.160347 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:18:02.165641 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:18:02.187547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:02.187879 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:02.191915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72d17d3c-b310-471d-9a69-cf79b82b17e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87988e20>]}
[0m12:18:02.202613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72d17d3c-b310-471d-9a69-cf79b82b17e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a56c10>]}
[0m12:18:02.203001 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m12:18:02.203636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72d17d3c-b310-471d-9a69-cf79b82b17e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a56d90>]}
[0m12:18:02.204825 [info ] [MainThread]: 
[0m12:18:02.205558 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:18:02.206525 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:18:02.213355 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:18:02.213689 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:18:02.213975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:02.219383 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:18:02.220686 [debug] [ThreadPool]: On list_airflow: Close
[0m12:18:02.222360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m12:18:02.227026 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:18:02.227422 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m12:18:02.227736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:02.231272 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:18:02.231814 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:18:02.232129 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:18:02.234619 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m12:18:02.236035 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m12:18:02.236423 [debug] [ThreadPool]: On list_airflow_public: Close
[0m12:18:02.243685 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:02.244043 [debug] [MainThread]: On master: BEGIN
[0m12:18:02.244289 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:02.246569 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:18:02.246865 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:02.247147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:18:02.251955 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:18:02.253024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72d17d3c-b310-471d-9a69-cf79b82b17e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87988f70>]}
[0m12:18:02.253511 [debug] [MainThread]: On master: ROLLBACK
[0m12:18:02.253941 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:02.254193 [debug] [MainThread]: On master: BEGIN
[0m12:18:02.254617 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:18:02.254862 [debug] [MainThread]: On master: COMMIT
[0m12:18:02.255089 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:02.255309 [debug] [MainThread]: On master: COMMIT
[0m12:18:02.255645 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:18:02.255933 [debug] [MainThread]: On master: Close
[0m12:18:02.256445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:18:02.256850 [info ] [MainThread]: 
[0m12:18:02.264644 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.my_first_model
[0m12:18:02.265087 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_orders
[0m12:18:02.265492 [info ] [Thread-1  ]: 1 of 4 START sql view model public.my_first_model .............................. [RUN]
[0m12:18:02.266032 [info ] [Thread-2  ]: 2 of 4 START sql view model public.stg_orders .................................. [RUN]
[0m12:18:02.267405 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.my_first_model)
[0m12:18:02.268008 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_airflow, now model.simple_dbt_project.stg_orders)
[0m12:18:02.268363 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.my_first_model
[0m12:18:02.268676 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m12:18:02.273395 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.my_first_model"
[0m12:18:02.275672 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m12:18:02.277056 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 12:18:02.273671 => 12:18:02.276891
[0m12:18:02.277381 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_orders
[0m12:18:02.291470 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (compile): 12:18:02.268908 => 12:18:02.291011
[0m12:18:02.297901 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.my_first_model
[0m12:18:02.303731 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m12:18:02.307201 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.my_first_model"
[0m12:18:02.308703 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:18:02.308999 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m12:18:02.309291 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:18:02.309584 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:18:02.310080 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: BEGIN
[0m12:18:02.310813 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:18:02.313115 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m12:18:02.313578 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:18:02.313958 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m12:18:02.314302 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:18:02.314736 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:18:02.315148 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */

  create view "airflow"."public"."my_first_model__dbt_tmp"
    
    
  as (
    -- Simple example model
SELECT 1 as id, 'Example' as name
UNION ALL
SELECT 2 as id, 'Test' as name
  );
[0m12:18:02.316075 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:18:02.316436 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:18:02.321070 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:18:02.323353 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:18:02.323048 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:18:02.323768 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model__dbt_tmp" rename to "my_first_model"
[0m12:18:02.324060 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:18:02.326057 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:18:02.326550 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:18:02.326323 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:18:02.333815 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:18:02.337217 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:18:02.337541 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:18:02.337810 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:18:02.335303 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:18:02.338266 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:18:02.338914 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:18:02.338694 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m12:18:02.342754 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public"."stg_orders__dbt_backup"
[0m12:18:02.343036 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:18:02.345572 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:18:02.347441 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
drop view if exists "airflow"."public"."stg_orders__dbt_backup" cascade
[0m12:18:02.347146 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."my_first_model__dbt_backup"
[0m12:18:02.348037 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:18:02.348354 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
drop view if exists "airflow"."public"."my_first_model__dbt_backup" cascade
[0m12:18:02.348898 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:18:02.350048 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (execute): 12:18:02.303995 => 12:18:02.349905
[0m12:18:02.350331 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: Close
[0m12:18:02.349174 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:18:02.350939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d17d3c-b310-471d-9a69-cf79b82b17e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8785a2e0>]}
[0m12:18:02.352446 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 12:18:02.277617 => 12:18:02.352179
[0m12:18:02.353974 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: Close
[0m12:18:02.354880 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d17d3c-b310-471d-9a69-cf79b82b17e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87899f10>]}
[0m12:18:02.355498 [info ] [Thread-2  ]: 2 of 4 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m12:18:02.356032 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_orders
[0m12:18:02.353333 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.my_first_model ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m12:18:02.356625 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.my_first_model
[0m12:18:02.357102 [debug] [Thread-4  ]: Began running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:18:02.357415 [debug] [Thread-3  ]: Began running node model.simple_dbt_project.fct_daily_sales
[0m12:18:02.357770 [info ] [Thread-4  ]: 3 of 4 START sql table model public.fct_customer_purchase_patterns ............. [RUN]
[0m12:18:02.358166 [info ] [Thread-3  ]: 4 of 4 START sql table model public.fct_daily_sales ............................ [RUN]
[0m12:18:02.358856 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_customer_purchase_patterns'
[0m12:18:02.359406 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_daily_sales'
[0m12:18:02.359751 [debug] [Thread-4  ]: Began compiling node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:18:02.360058 [debug] [Thread-3  ]: Began compiling node model.simple_dbt_project.fct_daily_sales
[0m12:18:02.362635 [debug] [Thread-4  ]: Writing injected SQL for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:18:02.365212 [debug] [Thread-3  ]: Writing injected SQL for node "model.simple_dbt_project.fct_daily_sales"
[0m12:18:02.366760 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (compile): 12:18:02.360262 => 12:18:02.366587
[0m12:18:02.367089 [debug] [Thread-4  ]: Began executing node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:18:02.383970 [debug] [Thread-4  ]: Writing runtime sql for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:18:02.384527 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (compile): 12:18:02.362879 => 12:18:02.384326
[0m12:18:02.384992 [debug] [Thread-3  ]: Began executing node model.simple_dbt_project.fct_daily_sales
[0m12:18:02.388561 [debug] [Thread-3  ]: Writing runtime sql for node "model.simple_dbt_project.fct_daily_sales"
[0m12:18:02.389451 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:18:02.389769 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: BEGIN
[0m12:18:02.390051 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:18:02.390365 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:18:02.391725 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: BEGIN
[0m12:18:02.392252 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:18:02.393815 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m12:18:02.394152 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:18:02.394494 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */

  
    

  create  table "airflow"."public"."fct_customer_purchase_patterns__dbt_tmp"
  
  
    as
  
  (
    

WITH customer_purchases AS (
    SELECT
        customer_id,
        order_date,
        amount,
        -- Common interview question: calculate days between purchases
        LAG(order_date) OVER (
            PARTITION BY customer_id 
            ORDER BY order_date
        ) as previous_order_date,
        -- Calculate running total
        SUM(amount) OVER (
            PARTITION BY customer_id 
            ORDER BY order_date
            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
        ) as lifetime_spend
    FROM "airflow"."public"."stg_orders"
    WHERE status = 'completed'
),

purchase_metrics AS (
    SELECT
        customer_id,
        order_date,
        amount,
        previous_order_date,
        lifetime_spend,
        -- Common interview question: handle NULL for first purchase
        COALESCE(
            DATE_DIFF('day', previous_order_date, order_date),
            0
        ) as days_since_previous_order
    FROM customer_purchases
)

SELECT
    customer_id,
    COUNT(*) as total_orders,
    AVG(amount) as avg_order_value,
    AVG(days_since_previous_order) as avg_days_between_orders,
    MAX(lifetime_spend) as total_lifetime_spend,
    -- Common interview question: categorize customers
    CASE 
        WHEN MAX(lifetime_spend) > 1000 THEN 'high_value'
        WHEN MAX(lifetime_spend) > 500 THEN 'medium_value'
        ELSE 'low_value'
    END as customer_segment
FROM purchase_metrics
GROUP BY 1
  );
  
[0m12:18:02.394916 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:18:02.395290 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:18:02.395679 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */

  
    

  create  table "airflow"."public"."fct_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', order_date) as date,
        COUNT(DISTINCT order_id) as total_orders,
        COUNT(DISTINCT customer_id) as unique_customers,
        SUM(amount) as total_amount
    FROM "airflow"."public"."stg_orders"
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT
    date,
    total_orders,
    unique_customers,
    total_amount,
    total_amount / NULLIF(total_orders, 0) as avg_order_value,
    total_amount / NULLIF(unique_customers, 0) as avg_customer_spend
FROM daily_sales
  );
  
[0m12:18:02.396232 [debug] [Thread-4  ]: Postgres adapter: Postgres error: function date_diff(unknown, date, date) does not exist
LINE 43:             DATE_DIFF('day', previous_order_date, order_date...
                     ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m12:18:02.396561 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: ROLLBACK
[0m12:18:02.397107 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (execute): 12:18:02.367296 => 12:18:02.396922
[0m12:18:02.397456 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: Close
[0m12:18:02.401860 [debug] [Thread-4  ]: Database Error in model fct_customer_purchase_patterns (models/marts/fct_customer_purchase_patterns.sql)
  function date_diff(unknown, date, date) does not exist
  LINE 43:             DATE_DIFF('day', previous_order_date, order_date...
                       ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/simple_dbt_project/models/marts/fct_customer_purchase_patterns.sql
[0m12:18:02.402243 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
[0m12:18:02.402568 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d17d3c-b310-471d-9a69-cf79b82b17e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86f58fd0>]}
[0m12:18:02.405235 [error] [Thread-4  ]: 3 of 4 ERROR creating sql table model public.fct_customer_purchase_patterns .... [[31mERROR[0m in 0.04s]
[0m12:18:02.405724 [debug] [Thread-4  ]: Finished running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:18:02.404774 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:18:02.406214 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m12:18:02.406727 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:18:02.409812 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:18:02.410136 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:18:02.410402 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:18:02.411043 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:18:02.412952 [debug] [Thread-3  ]: Applying DROP to: "airflow"."public"."fct_daily_sales__dbt_backup"
[0m12:18:02.414668 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:18:02.414993 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
drop table if exists "airflow"."public"."fct_daily_sales__dbt_backup" cascade
[0m12:18:02.415415 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:18:02.416409 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (execute): 12:18:02.385248 => 12:18:02.416262
[0m12:18:02.416824 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: Close
[0m12:18:02.417621 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d17d3c-b310-471d-9a69-cf79b82b17e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86f519d0>]}
[0m12:18:02.418475 [info ] [Thread-3  ]: 4 of 4 OK created sql table model public.fct_daily_sales ....................... [[32mSELECT 2[0m in 0.06s]
[0m12:18:02.419245 [debug] [Thread-3  ]: Finished running node model.simple_dbt_project.fct_daily_sales
[0m12:18:02.420869 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:02.421270 [debug] [MainThread]: On master: BEGIN
[0m12:18:02.421556 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:02.424249 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:18:02.424607 [debug] [MainThread]: On master: COMMIT
[0m12:18:02.425170 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:02.425451 [debug] [MainThread]: On master: COMMIT
[0m12:18:02.425998 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:18:02.426288 [debug] [MainThread]: On master: Close
[0m12:18:02.426839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:02.427130 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m12:18:02.427398 [debug] [MainThread]: Connection 'model.simple_dbt_project.my_first_model' was properly closed.
[0m12:18:02.427642 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_customer_purchase_patterns' was properly closed.
[0m12:18:02.427858 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_daily_sales' was properly closed.
[0m12:18:02.428126 [info ] [MainThread]: 
[0m12:18:02.428434 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m12:18:02.429286 [debug] [MainThread]: Command end result
[0m12:18:02.438224 [info ] [MainThread]: 
[0m12:18:02.438628 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:18:02.438947 [info ] [MainThread]: 
[0m12:18:02.439350 [error] [MainThread]:   Database Error in model fct_customer_purchase_patterns (models/marts/fct_customer_purchase_patterns.sql)
  function date_diff(unknown, date, date) does not exist
  LINE 43:             DATE_DIFF('day', previous_order_date, order_date...
                       ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/simple_dbt_project/models/marts/fct_customer_purchase_patterns.sql
[0m12:18:02.439689 [info ] [MainThread]: 
[0m12:18:02.440099 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:18:02.440891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.50172555, "process_user_time": 1.920695, "process_kernel_time": 0.175245, "process_mem_max_rss": "182340", "process_out_blocks": "1659", "command_success": false, "process_in_blocks": "0"}
[0m12:18:02.441323 [debug] [MainThread]: Command `dbt run` failed at 12:18:02.441229 after 0.50 seconds
[0m12:18:02.441651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1c7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d86e370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86f92730>]}
[0m12:18:02.441959 [debug] [MainThread]: Flushing usage events
[0m12:23:06.000782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa13cebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea41d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea41610>]}


============================== 12:23:06.005695 | 6593238f-9034-49d4-aca3-f6db781750ac ==============================
[0m12:23:06.005695 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:23:06.006337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m12:23:06.149671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6593238f-9034-49d4-aca3-f6db781750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0287100>]}
[0m12:23:06.199233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6593238f-9034-49d4-aca3-f6db781750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de199d0>]}
[0m12:23:06.199892 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:23:06.205978 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:23:06.230505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:23:06.230907 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:23:06.235124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6593238f-9034-49d4-aca3-f6db781750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db88ee0>]}
[0m12:23:06.245522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6593238f-9034-49d4-aca3-f6db781750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc56cd0>]}
[0m12:23:06.245905 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m12:23:06.246198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6593238f-9034-49d4-aca3-f6db781750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc56e50>]}
[0m12:23:06.247221 [info ] [MainThread]: 
[0m12:23:06.247781 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:23:06.248762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:23:06.255806 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:23:06.256196 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:23:06.256599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:06.264849 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:23:06.265847 [debug] [ThreadPool]: On list_airflow: Close
[0m12:23:06.267179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m12:23:06.271616 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:23:06.271936 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m12:23:06.272181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:06.275281 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:23:06.275674 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:23:06.275954 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:23:06.278561 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.0 seconds
[0m12:23:06.279866 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m12:23:06.280229 [debug] [ThreadPool]: On list_airflow_public: Close
[0m12:23:06.287707 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:06.288083 [debug] [MainThread]: On master: BEGIN
[0m12:23:06.288346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:23:06.290455 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:23:06.290771 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:06.291056 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:23:06.295437 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:23:06.296245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6593238f-9034-49d4-aca3-f6db781750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd78f10>]}
[0m12:23:06.296611 [debug] [MainThread]: On master: ROLLBACK
[0m12:23:06.296965 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:06.297283 [debug] [MainThread]: On master: BEGIN
[0m12:23:06.297716 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:23:06.297964 [debug] [MainThread]: On master: COMMIT
[0m12:23:06.298188 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:06.298408 [debug] [MainThread]: On master: COMMIT
[0m12:23:06.298717 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:23:06.298962 [debug] [MainThread]: On master: Close
[0m12:23:06.299442 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:23:06.299762 [info ] [MainThread]: 
[0m12:23:06.305225 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.my_first_model
[0m12:23:06.305594 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_orders
[0m12:23:06.305980 [info ] [Thread-1  ]: 1 of 4 START sql view model public.my_first_model .............................. [RUN]
[0m12:23:06.306378 [info ] [Thread-2  ]: 2 of 4 START sql view model public.stg_orders .................................. [RUN]
[0m12:23:06.306944 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.my_first_model)
[0m12:23:06.307399 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_airflow, now model.simple_dbt_project.stg_orders)
[0m12:23:06.307771 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.my_first_model
[0m12:23:06.308086 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m12:23:06.312683 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.my_first_model"
[0m12:23:06.314683 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m12:23:06.316640 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 12:23:06.312937 => 12:23:06.316467
[0m12:23:06.317018 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_orders
[0m12:23:06.317355 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (compile): 12:23:06.308316 => 12:23:06.317213
[0m12:23:06.334722 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.my_first_model
[0m12:23:06.339485 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m12:23:06.343270 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.my_first_model"
[0m12:23:06.344671 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:23:06.345003 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m12:23:06.345297 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:23:06.345578 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:23:06.346050 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: BEGIN
[0m12:23:06.346639 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:23:06.348310 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m12:23:06.348685 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:23:06.349032 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m12:23:06.349358 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:23:06.349685 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:23:06.350077 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */

  create view "airflow"."public"."my_first_model__dbt_tmp"
    
    
  as (
    -- Simple example model
SELECT 1 as id, 'Example' as name
UNION ALL
SELECT 2 as id, 'Test' as name
  );
[0m12:23:06.352141 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:23:06.352438 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:23:06.357034 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:23:06.359601 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model" rename to "my_first_model__dbt_backup"
[0m12:23:06.359261 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:23:06.359990 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:23:06.360562 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:06.360822 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:06.362691 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:23:06.364860 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model__dbt_tmp" rename to "my_first_model"
[0m12:23:06.364534 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:23:06.365229 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:23:06.365487 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:06.373838 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:06.376435 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:23:06.376753 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:23:06.377021 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:23:06.375533 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:23:06.377395 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:23:06.377732 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:23:06.379750 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m12:23:06.380040 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:23:06.383829 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public"."stg_orders__dbt_backup"
[0m12:23:06.385506 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."my_first_model__dbt_backup"
[0m12:23:06.388788 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:23:06.389078 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
drop view if exists "airflow"."public"."my_first_model__dbt_backup" cascade
[0m12:23:06.388284 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:23:06.389456 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
drop view if exists "airflow"."public"."stg_orders__dbt_backup" cascade
[0m12:23:06.390242 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:23:06.391231 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (execute): 12:23:06.339730 => 12:23:06.391096
[0m12:23:06.391739 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: Close
[0m12:23:06.391488 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:23:06.392411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6593238f-9034-49d4-aca3-f6db781750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1418b0>]}
[0m12:23:06.394063 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.my_first_model ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:23:06.393587 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 12:23:06.317528 => 12:23:06.393416
[0m12:23:06.394996 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: Close
[0m12:23:06.394627 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.my_first_model
[0m12:23:06.395659 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6593238f-9034-49d4-aca3-f6db781750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da98520>]}
[0m12:23:06.396215 [info ] [Thread-2  ]: 2 of 4 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m12:23:06.396705 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_orders
[0m12:23:06.397366 [debug] [Thread-4  ]: Began running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:23:06.397696 [debug] [Thread-3  ]: Began running node model.simple_dbt_project.fct_daily_sales
[0m12:23:06.398035 [info ] [Thread-4  ]: 3 of 4 START sql table model public.fct_customer_purchase_patterns ............. [RUN]
[0m12:23:06.398460 [info ] [Thread-3  ]: 4 of 4 START sql table model public.fct_daily_sales ............................ [RUN]
[0m12:23:06.399051 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_customer_purchase_patterns'
[0m12:23:06.399581 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_daily_sales'
[0m12:23:06.399928 [debug] [Thread-4  ]: Began compiling node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:23:06.400240 [debug] [Thread-3  ]: Began compiling node model.simple_dbt_project.fct_daily_sales
[0m12:23:06.403326 [debug] [Thread-4  ]: Writing injected SQL for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:23:06.405365 [debug] [Thread-3  ]: Writing injected SQL for node "model.simple_dbt_project.fct_daily_sales"
[0m12:23:06.406701 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (compile): 12:23:06.400466 => 12:23:06.406550
[0m12:23:06.407069 [debug] [Thread-4  ]: Began executing node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:23:06.407397 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (compile): 12:23:06.403625 => 12:23:06.407259
[0m12:23:06.422915 [debug] [Thread-3  ]: Began executing node model.simple_dbt_project.fct_daily_sales
[0m12:23:06.422574 [debug] [Thread-4  ]: Writing runtime sql for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:23:06.426039 [debug] [Thread-3  ]: Writing runtime sql for node "model.simple_dbt_project.fct_daily_sales"
[0m12:23:06.427167 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:23:06.427496 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: BEGIN
[0m12:23:06.427780 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:23:06.428273 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: BEGIN
[0m12:23:06.428504 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:23:06.427999 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:23:06.430968 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:23:06.431687 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:23:06.432006 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */

  
    

  create  table "airflow"."public"."fct_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', order_date) as date,
        COUNT(DISTINCT order_id) as total_orders,
        COUNT(DISTINCT customer_id) as unique_customers,
        SUM(amount) as total_amount
    FROM "airflow"."public"."stg_orders"
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT
    date,
    total_orders,
    unique_customers,
    total_amount,
    total_amount / NULLIF(total_orders, 0) as avg_order_value,
    total_amount / NULLIF(unique_customers, 0) as avg_customer_spend
FROM daily_sales
  );
  
[0m12:23:06.431297 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m12:23:06.432381 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:23:06.432762 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */

  
    

  create  table "airflow"."public"."fct_customer_purchase_patterns__dbt_tmp"
  
  
    as
  
  (
    

WITH customer_purchases AS (
    SELECT
        customer_id,
        order_date,
        amount,
        -- Common interview question: calculate days between purchases
        LAG(order_date) OVER (
            PARTITION BY customer_id 
            ORDER BY order_date
        ) as previous_order_date,
        -- Calculate running total
        SUM(amount) OVER (
            PARTITION BY customer_id 
            ORDER BY order_date
            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
        ) as lifetime_spend
    FROM "airflow"."public"."stg_orders"
    WHERE status = 'completed'
),

purchase_metrics AS (
    SELECT
        customer_id,
        order_date,
        amount,
        previous_order_date,
        lifetime_spend,
        -- Common interview question: handle NULL for first purchase
        COALESCE(
            DATE_DIFF('day', previous_order_date, order_date),
            0
        ) as days_since_previous_order
    FROM customer_purchases
)

SELECT
    customer_id,
    COUNT(*) as total_orders,
    AVG(amount) as avg_order_value,
    AVG(days_since_previous_order) as avg_days_between_orders,
    MAX(lifetime_spend) as total_lifetime_spend,
    -- Common interview question: categorize customers
    CASE 
        WHEN MAX(lifetime_spend) > 1000 THEN 'high_value'
        WHEN MAX(lifetime_spend) > 500 THEN 'medium_value'
        ELSE 'low_value'
    END as customer_segment
FROM purchase_metrics
GROUP BY 1
  );
  
[0m12:23:06.433860 [debug] [Thread-4  ]: Postgres adapter: Postgres error: function date_diff(unknown, date, date) does not exist
LINE 43:             DATE_DIFF('day', previous_order_date, order_date...
                     ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m12:23:06.434235 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: ROLLBACK
[0m12:23:06.434859 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (execute): 12:23:06.407568 => 12:23:06.434655
[0m12:23:06.435226 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: Close
[0m12:23:06.437317 [debug] [Thread-4  ]: Database Error in model fct_customer_purchase_patterns (models/marts/fct_customer_purchase_patterns.sql)
  function date_diff(unknown, date, date) does not exist
  LINE 43:             DATE_DIFF('day', previous_order_date, order_date...
                       ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/simple_dbt_project/models/marts/fct_customer_purchase_patterns.sql
[0m12:23:06.437924 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6593238f-9034-49d4-aca3-f6db781750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dabc070>]}
[0m12:23:06.438410 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
[0m12:23:06.438854 [error] [Thread-4  ]: 3 of 4 ERROR creating sql table model public.fct_customer_purchase_patterns .... [[31mERROR[0m in 0.04s]
[0m12:23:06.441810 [debug] [Thread-4  ]: Finished running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:23:06.441336 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:23:06.442212 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m12:23:06.442700 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:06.444592 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:23:06.444884 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m12:23:06.445268 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:06.448445 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:23:06.448750 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:23:06.449006 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:23:06.450487 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:23:06.452137 [debug] [Thread-3  ]: Applying DROP to: "airflow"."public"."fct_daily_sales__dbt_backup"
[0m12:23:06.453764 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:23:06.454057 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
drop table if exists "airflow"."public"."fct_daily_sales__dbt_backup" cascade
[0m12:23:06.455935 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:23:06.456904 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (execute): 12:23:06.423157 => 12:23:06.456772
[0m12:23:06.457188 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: Close
[0m12:23:06.457787 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6593238f-9034-49d4-aca3-f6db781750ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d150730>]}
[0m12:23:06.458278 [info ] [Thread-3  ]: 4 of 4 OK created sql table model public.fct_daily_sales ....................... [[32mSELECT 2[0m in 0.06s]
[0m12:23:06.458707 [debug] [Thread-3  ]: Finished running node model.simple_dbt_project.fct_daily_sales
[0m12:23:06.459805 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:06.460081 [debug] [MainThread]: On master: BEGIN
[0m12:23:06.460353 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:23:06.462584 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:23:06.462937 [debug] [MainThread]: On master: COMMIT
[0m12:23:06.463216 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:06.463455 [debug] [MainThread]: On master: COMMIT
[0m12:23:06.463744 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:23:06.463980 [debug] [MainThread]: On master: Close
[0m12:23:06.464431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:06.464684 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m12:23:06.464906 [debug] [MainThread]: Connection 'model.simple_dbt_project.my_first_model' was properly closed.
[0m12:23:06.465119 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_customer_purchase_patterns' was properly closed.
[0m12:23:06.465327 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_daily_sales' was properly closed.
[0m12:23:06.465616 [info ] [MainThread]: 
[0m12:23:06.465876 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m12:23:06.466555 [debug] [MainThread]: Command end result
[0m12:23:06.474349 [info ] [MainThread]: 
[0m12:23:06.474712 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:23:06.474964 [info ] [MainThread]: 
[0m12:23:06.475209 [error] [MainThread]:   Database Error in model fct_customer_purchase_patterns (models/marts/fct_customer_purchase_patterns.sql)
  function date_diff(unknown, date, date) does not exist
  LINE 43:             DATE_DIFF('day', previous_order_date, order_date...
                       ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/simple_dbt_project/models/marts/fct_customer_purchase_patterns.sql
[0m12:23:06.475492 [info ] [MainThread]: 
[0m12:23:06.475850 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:23:06.476501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.50129676, "process_user_time": 2.118186, "process_kernel_time": 0.22394, "process_mem_max_rss": "190240", "process_out_blocks": "1661", "command_success": false, "process_in_blocks": "0"}
[0m12:23:06.476919 [debug] [MainThread]: Command `dbt run` failed at 12:23:06.476823 after 0.50 seconds
[0m12:23:06.477237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa13cebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de199d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db0c040>]}
[0m12:23:06.477549 [debug] [MainThread]: Flushing usage events
[0m12:24:23.984021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0357bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad981d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad981610>]}


============================== 12:24:23.988542 | ad234c9f-b1cc-4d47-94f7-3688ab0f9703 ==============================
[0m12:24:23.988542 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:24:23.988987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:24:24.132552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad234c9f-b1cc-4d47-94f7-3688ab0f9703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf1c9100>]}
[0m12:24:24.182468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad234c9f-b1cc-4d47-94f7-3688ab0f9703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd769d0>]}
[0m12:24:24.183118 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:24:24.189285 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:24:24.211099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:24.211525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:24.216285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad234c9f-b1cc-4d47-94f7-3688ab0f9703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacae6ee0>]}
[0m12:24:24.226688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad234c9f-b1cc-4d47-94f7-3688ab0f9703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacbb4cd0>]}
[0m12:24:24.227086 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m12:24:24.227557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad234c9f-b1cc-4d47-94f7-3688ab0f9703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacbb4e50>]}
[0m12:24:24.228598 [info ] [MainThread]: 
[0m12:24:24.229220 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:24:24.230184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:24:24.238218 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:24:24.238656 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:24:24.238915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:24.242150 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:24:24.243127 [debug] [ThreadPool]: On list_airflow: Close
[0m12:24:24.244536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m12:24:24.248651 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:24:24.248962 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m12:24:24.249202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:24.251342 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:24:24.251690 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:24:24.252006 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:24:24.253828 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.0 seconds
[0m12:24:24.255197 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m12:24:24.255548 [debug] [ThreadPool]: On list_airflow_public: Close
[0m12:24:24.263378 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:24.263808 [debug] [MainThread]: On master: BEGIN
[0m12:24:24.264057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:24:24.266497 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:24:24.266833 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:24.267137 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:24:24.271250 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:24:24.272207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad234c9f-b1cc-4d47-94f7-3688ab0f9703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaccd6f10>]}
[0m12:24:24.272596 [debug] [MainThread]: On master: ROLLBACK
[0m12:24:24.272969 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:24.273214 [debug] [MainThread]: On master: BEGIN
[0m12:24:24.273612 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:24:24.273905 [debug] [MainThread]: On master: COMMIT
[0m12:24:24.274155 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:24.274385 [debug] [MainThread]: On master: COMMIT
[0m12:24:24.274693 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:24:24.274944 [debug] [MainThread]: On master: Close
[0m12:24:24.275428 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:24:24.275722 [info ] [MainThread]: 
[0m12:24:24.282184 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.my_first_model
[0m12:24:24.282588 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_orders
[0m12:24:24.282956 [info ] [Thread-1  ]: 1 of 4 START sql view model public.my_first_model .............................. [RUN]
[0m12:24:24.283409 [info ] [Thread-2  ]: 2 of 4 START sql view model public.stg_orders .................................. [RUN]
[0m12:24:24.284140 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.my_first_model)
[0m12:24:24.284652 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.simple_dbt_project.stg_orders'
[0m12:24:24.285013 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.my_first_model
[0m12:24:24.285323 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m12:24:24.290391 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.my_first_model"
[0m12:24:24.293280 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m12:24:24.294995 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 12:24:24.290780 => 12:24:24.294813
[0m12:24:24.295313 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (compile): 12:24:24.285555 => 12:24:24.295179
[0m12:24:24.295583 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_orders
[0m12:24:24.295902 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.my_first_model
[0m12:24:24.323909 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m12:24:24.324835 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.my_first_model"
[0m12:24:24.326433 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:24:24.326797 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m12:24:24.327076 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:24:24.327574 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: BEGIN
[0m12:24:24.327835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:24:24.327312 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:24:24.330741 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m12:24:24.331329 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:24:24.331637 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m12:24:24.331094 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:24:24.332009 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:24:24.332404 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */

  create view "airflow"."public"."my_first_model__dbt_tmp"
    
    
  as (
    -- Simple example model
SELECT 1 as id, 'Example' as name
UNION ALL
SELECT 2 as id, 'Test' as name
  );
[0m12:24:24.334846 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:24:24.335195 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:24:24.340110 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:24:24.342812 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model" rename to "my_first_model__dbt_backup"
[0m12:24:24.342466 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:24:24.343232 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:24:24.343514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:24:24.345551 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:24:24.346073 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model__dbt_tmp" rename to "my_first_model"
[0m12:24:24.345842 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:24:24.348093 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:24:24.348595 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:24:24.348373 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:24:24.357977 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:24:24.358817 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:24:24.360047 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:24:24.360306 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:24:24.359730 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:24:24.360668 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:24:24.360962 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:24:24.362188 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:24:24.362471 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m12:24:24.366450 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."my_first_model__dbt_backup"
[0m12:24:24.370874 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:24:24.371178 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
drop view if exists "airflow"."public"."my_first_model__dbt_backup" cascade
[0m12:24:24.368166 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public"."stg_orders__dbt_backup"
[0m12:24:24.371704 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:24:24.372046 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
drop view if exists "airflow"."public"."stg_orders__dbt_backup" cascade
[0m12:24:24.372308 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:24:24.373331 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (execute): 12:24:24.312096 => 12:24:24.373189
[0m12:24:24.373833 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: Close
[0m12:24:24.374386 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad234c9f-b1cc-4d47-94f7-3688ab0f9703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaca4cbb0>]}
[0m12:24:24.374908 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.my_first_model ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:24:24.375386 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.my_first_model
[0m12:24:24.373592 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:24:24.376567 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 12:24:24.296118 => 12:24:24.376439
[0m12:24:24.376883 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: Close
[0m12:24:24.377469 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad234c9f-b1cc-4d47-94f7-3688ab0f9703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacab7a00>]}
[0m12:24:24.377977 [info ] [Thread-2  ]: 2 of 4 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m12:24:24.378436 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_orders
[0m12:24:24.379139 [debug] [Thread-4  ]: Began running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:24:24.379466 [debug] [Thread-3  ]: Began running node model.simple_dbt_project.fct_daily_sales
[0m12:24:24.379828 [info ] [Thread-4  ]: 3 of 4 START sql table model public.fct_customer_purchase_patterns ............. [RUN]
[0m12:24:24.380258 [info ] [Thread-3  ]: 4 of 4 START sql table model public.fct_daily_sales ............................ [RUN]
[0m12:24:24.380904 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_customer_purchase_patterns'
[0m12:24:24.381430 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_daily_sales'
[0m12:24:24.381774 [debug] [Thread-4  ]: Began compiling node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:24:24.382093 [debug] [Thread-3  ]: Began compiling node model.simple_dbt_project.fct_daily_sales
[0m12:24:24.385271 [debug] [Thread-4  ]: Writing injected SQL for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:24:24.387319 [debug] [Thread-3  ]: Writing injected SQL for node "model.simple_dbt_project.fct_daily_sales"
[0m12:24:24.388388 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (compile): 12:24:24.382313 => 12:24:24.388227
[0m12:24:24.388777 [debug] [Thread-4  ]: Began executing node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:24:24.389178 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (compile): 12:24:24.385539 => 12:24:24.388949
[0m12:24:24.406200 [debug] [Thread-3  ]: Began executing node model.simple_dbt_project.fct_daily_sales
[0m12:24:24.406703 [debug] [Thread-4  ]: Writing runtime sql for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:24:24.410163 [debug] [Thread-3  ]: Writing runtime sql for node "model.simple_dbt_project.fct_daily_sales"
[0m12:24:24.411297 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:24:24.411682 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: BEGIN
[0m12:24:24.412018 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:24:24.412544 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: BEGIN
[0m12:24:24.412796 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:24:24.412279 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:24:24.416855 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:24:24.417254 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:24:24.417619 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */

  
    

  create  table "airflow"."public"."fct_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', order_date) as date,
        COUNT(DISTINCT order_id) as total_orders,
        COUNT(DISTINCT customer_id) as unique_customers,
        SUM(amount) as total_amount
    FROM "airflow"."public"."stg_orders"
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT
    date,
    total_orders,
    unique_customers,
    total_amount,
    total_amount / NULLIF(total_orders, 0) as avg_order_value,
    total_amount / NULLIF(unique_customers, 0) as avg_customer_spend
FROM daily_sales
  );
  
[0m12:24:24.418168 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m12:24:24.418496 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:24:24.418955 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */

  
    

  create  table "airflow"."public"."fct_customer_purchase_patterns__dbt_tmp"
  
  
    as
  
  (
    

WITH customer_purchases AS (
    SELECT
        customer_id,
        order_date,
        amount,
        -- Common interview question: calculate days between purchases
        LAG(order_date) OVER (
            PARTITION BY customer_id 
            ORDER BY order_date
        ) as previous_order_date,
        -- Calculate running total
        SUM(amount) OVER (
            PARTITION BY customer_id 
            ORDER BY order_date
            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
        ) as lifetime_spend
    FROM "airflow"."public"."stg_orders"
    WHERE status = 'completed'
),

purchase_metrics AS (
    SELECT
        customer_id,
        order_date,
        amount,
        previous_order_date,
        lifetime_spend,
        -- Common interview question: handle NULL for first purchase
        COALESCE(
            DATE_DIFF('day', previous_order_date, order_date),
            0
        ) as days_since_previous_order
    FROM customer_purchases
)

SELECT
    customer_id,
    COUNT(*) as total_orders,
    AVG(amount) as avg_order_value,
    AVG(days_since_previous_order) as avg_days_between_orders,
    MAX(lifetime_spend) as total_lifetime_spend,
    -- Common interview question: categorize customers
    CASE 
        WHEN MAX(lifetime_spend) > 1000 THEN 'high_value'
        WHEN MAX(lifetime_spend) > 500 THEN 'medium_value'
        ELSE 'low_value'
    END as customer_segment
FROM purchase_metrics
GROUP BY 1
  );
  
[0m12:24:24.420263 [debug] [Thread-4  ]: Postgres adapter: Postgres error: function date_diff(unknown, date, date) does not exist
LINE 43:             DATE_DIFF('day', previous_order_date, order_date...
                     ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m12:24:24.420716 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: ROLLBACK
[0m12:24:24.421476 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (execute): 12:24:24.389383 => 12:24:24.421268
[0m12:24:24.421918 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: Close
[0m12:24:24.424336 [debug] [Thread-4  ]: Database Error in model fct_customer_purchase_patterns (models/marts/fct_customer_purchase_patterns.sql)
  function date_diff(unknown, date, date) does not exist
  LINE 43:             DATE_DIFF('day', previous_order_date, order_date...
                       ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/simple_dbt_project/models/marts/fct_customer_purchase_patterns.sql
[0m12:24:24.424711 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
[0m12:24:24.425074 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad234c9f-b1cc-4d47-94f7-3688ab0f9703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaca1a400>]}
[0m12:24:24.428258 [error] [Thread-4  ]: 3 of 4 ERROR creating sql table model public.fct_customer_purchase_patterns .... [[31mERROR[0m in 0.04s]
[0m12:24:24.428808 [debug] [Thread-4  ]: Finished running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:24:24.427667 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:24:24.429379 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m12:24:24.429941 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:24:24.432290 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:24:24.432678 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m12:24:24.433336 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:24:24.436828 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:24:24.437263 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:24:24.437586 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:24:24.438816 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:24:24.440926 [debug] [Thread-3  ]: Applying DROP to: "airflow"."public"."fct_daily_sales__dbt_backup"
[0m12:24:24.443216 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:24:24.443740 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
drop table if exists "airflow"."public"."fct_daily_sales__dbt_backup" cascade
[0m12:24:24.445123 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:24:24.446474 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (execute): 12:24:24.406915 => 12:24:24.446323
[0m12:24:24.446840 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: Close
[0m12:24:24.447476 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad234c9f-b1cc-4d47-94f7-3688ab0f9703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac1b3760>]}
[0m12:24:24.448004 [info ] [Thread-3  ]: 4 of 4 OK created sql table model public.fct_daily_sales ....................... [[32mSELECT 2[0m in 0.07s]
[0m12:24:24.448485 [debug] [Thread-3  ]: Finished running node model.simple_dbt_project.fct_daily_sales
[0m12:24:24.449868 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:24.450194 [debug] [MainThread]: On master: BEGIN
[0m12:24:24.450431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:24:24.452555 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:24:24.452929 [debug] [MainThread]: On master: COMMIT
[0m12:24:24.453195 [debug] [MainThread]: Using postgres connection "master"
[0m12:24:24.453429 [debug] [MainThread]: On master: COMMIT
[0m12:24:24.453810 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:24:24.454263 [debug] [MainThread]: On master: Close
[0m12:24:24.454857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:24.455240 [debug] [MainThread]: Connection 'model.simple_dbt_project.my_first_model' was properly closed.
[0m12:24:24.455519 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m12:24:24.455802 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_customer_purchase_patterns' was properly closed.
[0m12:24:24.456065 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_daily_sales' was properly closed.
[0m12:24:24.456388 [info ] [MainThread]: 
[0m12:24:24.456680 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m12:24:24.457449 [debug] [MainThread]: Command end result
[0m12:24:24.464813 [info ] [MainThread]: 
[0m12:24:24.465163 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:24:24.465447 [info ] [MainThread]: 
[0m12:24:24.465835 [error] [MainThread]:   Database Error in model fct_customer_purchase_patterns (models/marts/fct_customer_purchase_patterns.sql)
  function date_diff(unknown, date, date) does not exist
  LINE 43:             DATE_DIFF('day', previous_order_date, order_date...
                       ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/simple_dbt_project/models/marts/fct_customer_purchase_patterns.sql
[0m12:24:24.466164 [info ] [MainThread]: 
[0m12:24:24.466970 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:24:24.467655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5097066, "process_user_time": 1.986036, "process_kernel_time": 0.147779, "process_mem_max_rss": "182180", "process_out_blocks": "1662", "command_success": false, "process_in_blocks": "0"}
[0m12:24:24.468068 [debug] [MainThread]: Command `dbt run` failed at 12:24:24.467972 after 0.51 seconds
[0m12:24:24.468371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0357bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd769d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaca69ee0>]}
[0m12:24:24.468667 [debug] [MainThread]: Flushing usage events
[0m12:27:12.736964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bde9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89404d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89404ca0>]}


============================== 12:27:12.742217 | 1412baf0-52fb-4fbb-8c6c-29f06aeb4724 ==============================
[0m12:27:12.742217 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:27:12.744766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:27:12.917589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1412baf0-52fb-4fbb-8c6c-29f06aeb4724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89404670>]}
[0m12:27:12.971985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1412baf0-52fb-4fbb-8c6c-29f06aeb4724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e477940>]}
[0m12:27:12.972667 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:27:12.979214 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:27:13.007143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:27:13.007576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:27:13.011970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1412baf0-52fb-4fbb-8c6c-29f06aeb4724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88557eb0>]}
[0m12:27:13.023279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1412baf0-52fb-4fbb-8c6c-29f06aeb4724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88629ca0>]}
[0m12:27:13.023715 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m12:27:13.024299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1412baf0-52fb-4fbb-8c6c-29f06aeb4724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88629e20>]}
[0m12:27:13.025543 [info ] [MainThread]: 
[0m12:27:13.026457 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:27:13.027550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:27:13.035628 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:27:13.036281 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:27:13.036588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:13.046333 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:27:13.047415 [debug] [ThreadPool]: On list_airflow: Close
[0m12:27:13.049165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m12:27:13.054609 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:27:13.055210 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m12:27:13.055520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:13.058855 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:27:13.059384 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:27:13.059675 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:27:13.062368 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.0 seconds
[0m12:27:13.064343 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m12:27:13.064887 [debug] [ThreadPool]: On list_airflow_public: Close
[0m12:27:13.073004 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:13.073518 [debug] [MainThread]: On master: BEGIN
[0m12:27:13.073825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:13.077223 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:27:13.077616 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:13.077971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:27:13.084097 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:27:13.085084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1412baf0-52fb-4fbb-8c6c-29f06aeb4724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88747940>]}
[0m12:27:13.085469 [debug] [MainThread]: On master: ROLLBACK
[0m12:27:13.085840 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:13.086094 [debug] [MainThread]: On master: BEGIN
[0m12:27:13.086560 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:27:13.086875 [debug] [MainThread]: On master: COMMIT
[0m12:27:13.087152 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:13.087390 [debug] [MainThread]: On master: COMMIT
[0m12:27:13.087752 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:27:13.088040 [debug] [MainThread]: On master: Close
[0m12:27:13.088577 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:27:13.088991 [info ] [MainThread]: 
[0m12:27:13.095504 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.my_first_model
[0m12:27:13.095887 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_orders
[0m12:27:13.096277 [info ] [Thread-1  ]: 1 of 4 START sql view model public.my_first_model .............................. [RUN]
[0m12:27:13.096657 [info ] [Thread-2  ]: 2 of 4 START sql view model public.stg_orders .................................. [RUN]
[0m12:27:13.097387 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.my_first_model)
[0m12:27:13.097914 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_airflow, now model.simple_dbt_project.stg_orders)
[0m12:27:13.098297 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.my_first_model
[0m12:27:13.098616 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m12:27:13.103597 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.my_first_model"
[0m12:27:13.107045 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m12:27:13.108523 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 12:27:13.104156 => 12:27:13.108332
[0m12:27:13.108880 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (compile): 12:27:13.098869 => 12:27:13.108719
[0m12:27:13.109187 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_orders
[0m12:27:13.109508 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.my_first_model
[0m12:27:13.138431 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m12:27:13.139529 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.my_first_model"
[0m12:27:13.140639 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:27:13.141056 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m12:27:13.141373 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:27:13.141949 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: BEGIN
[0m12:27:13.142255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:27:13.141611 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:27:13.144979 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:27:13.145606 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:27:13.145907 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */

  create view "airflow"."public"."my_first_model__dbt_tmp"
    
    
  as (
    -- Simple example model
SELECT 1 as id, 'Example' as name
UNION ALL
SELECT 2 as id, 'Test' as name
  );
[0m12:27:13.145357 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m12:27:13.146279 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:27:13.146727 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m12:27:13.149045 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:27:13.149512 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:27:13.155474 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:27:13.158761 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model" rename to "my_first_model__dbt_backup"
[0m12:27:13.158286 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:27:13.159170 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:27:13.159475 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:13.161665 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:27:13.162264 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model__dbt_tmp" rename to "my_first_model"
[0m12:27:13.161991 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:13.164660 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:27:13.165321 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:27:13.165073 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:13.175821 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:27:13.176442 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:27:13.176746 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:27:13.176200 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:13.177965 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:27:13.178472 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:27:13.178808 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:27:13.178250 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:27:13.183728 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."my_first_model__dbt_backup"
[0m12:27:13.184120 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m12:27:13.186773 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:27:13.189035 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
drop view if exists "airflow"."public"."my_first_model__dbt_backup" cascade
[0m12:27:13.188627 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public"."stg_orders__dbt_backup"
[0m12:27:13.189610 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:27:13.190006 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
drop view if exists "airflow"."public"."stg_orders__dbt_backup" cascade
[0m12:27:13.190666 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:27:13.191739 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (execute): 12:27:13.126727 => 12:27:13.191580
[0m12:27:13.192247 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: Close
[0m12:27:13.192822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1412baf0-52fb-4fbb-8c6c-29f06aeb4724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884bfca0>]}
[0m12:27:13.193310 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.my_first_model ......................... [[32mCREATE VIEW[0m in 0.10s]
[0m12:27:13.193834 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.my_first_model
[0m12:27:13.192012 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:27:13.195124 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 12:27:13.109744 => 12:27:13.194973
[0m12:27:13.195501 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: Close
[0m12:27:13.196155 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1412baf0-52fb-4fbb-8c6c-29f06aeb4724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884dce50>]}
[0m12:27:13.197517 [info ] [Thread-2  ]: 2 of 4 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m12:27:13.198239 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_orders
[0m12:27:13.199402 [debug] [Thread-4  ]: Began running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:27:13.199904 [debug] [Thread-3  ]: Began running node model.simple_dbt_project.fct_daily_sales
[0m12:27:13.200286 [info ] [Thread-4  ]: 3 of 4 START sql table model public.fct_customer_purchase_patterns ............. [RUN]
[0m12:27:13.200846 [info ] [Thread-3  ]: 4 of 4 START sql table model public.fct_daily_sales ............................ [RUN]
[0m12:27:13.201794 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_customer_purchase_patterns'
[0m12:27:13.202648 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_daily_sales'
[0m12:27:13.203059 [debug] [Thread-4  ]: Began compiling node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:27:13.203399 [debug] [Thread-3  ]: Began compiling node model.simple_dbt_project.fct_daily_sales
[0m12:27:13.206906 [debug] [Thread-4  ]: Writing injected SQL for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:27:13.209421 [debug] [Thread-3  ]: Writing injected SQL for node "model.simple_dbt_project.fct_daily_sales"
[0m12:27:13.210558 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (compile): 12:27:13.203623 => 12:27:13.210388
[0m12:27:13.210933 [debug] [Thread-4  ]: Began executing node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:27:13.211290 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (compile): 12:27:13.207381 => 12:27:13.211124
[0m12:27:13.226934 [debug] [Thread-3  ]: Began executing node model.simple_dbt_project.fct_daily_sales
[0m12:27:13.228888 [debug] [Thread-4  ]: Writing runtime sql for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:27:13.233588 [debug] [Thread-3  ]: Writing runtime sql for node "model.simple_dbt_project.fct_daily_sales"
[0m12:27:13.235122 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:27:13.235543 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: BEGIN
[0m12:27:13.235875 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:27:13.236580 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: BEGIN
[0m12:27:13.236987 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:27:13.236114 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:27:13.241097 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:27:13.241556 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:27:13.241875 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */

  
    

  create  table "airflow"."public"."fct_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', order_date) as date,
        COUNT(DISTINCT order_id) as total_orders,
        COUNT(DISTINCT customer_id) as unique_customers,
        SUM(amount) as total_amount
    FROM "airflow"."public"."stg_orders"
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT
    date,
    total_orders,
    unique_customers,
    total_amount,
    total_amount / NULLIF(total_orders, 0) as avg_order_value,
    total_amount / NULLIF(unique_customers, 0) as avg_customer_spend
FROM daily_sales
  );
  
[0m12:27:13.242303 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m12:27:13.242628 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:27:13.243038 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */

  
    

  create  table "airflow"."public"."fct_customer_purchase_patterns__dbt_tmp"
  
  
    as
  
  (
    

WITH customer_purchases AS (
    SELECT
        customer_id,
        order_date,
        amount,
        -- Common interview question: calculate days between purchases
        LAG(order_date) OVER (
            PARTITION BY customer_id 
            ORDER BY order_date
        ) as previous_order_date,
        -- Calculate running total
        SUM(amount) OVER (
            PARTITION BY customer_id 
            ORDER BY order_date
            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
        ) as lifetime_spend
    FROM "airflow"."public"."stg_orders"
    WHERE status = 'completed'
),

purchase_metrics AS (
    SELECT
        customer_id,
        order_date,
        amount,
        previous_order_date,
        lifetime_spend,
        -- Common interview question: handle NULL for first purchase
        COALESCE(
            DATE_DIFF('day', previous_order_date, order_date),
            0
        ) as days_since_previous_order
    FROM customer_purchases
)

SELECT
    customer_id,
    COUNT(*) as total_orders,
    AVG(amount) as avg_order_value,
    AVG(days_since_previous_order) as avg_days_between_orders,
    MAX(lifetime_spend) as total_lifetime_spend,
    -- Common interview question: categorize customers
    CASE 
        WHEN MAX(lifetime_spend) > 1000 THEN 'high_value'
        WHEN MAX(lifetime_spend) > 500 THEN 'medium_value'
        ELSE 'low_value'
    END as customer_segment
FROM purchase_metrics
GROUP BY 1
  );
  
[0m12:27:13.244284 [debug] [Thread-4  ]: Postgres adapter: Postgres error: function date_diff(unknown, date, date) does not exist
LINE 43:             DATE_DIFF('day', previous_order_date, order_date...
                     ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m12:27:13.244736 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: ROLLBACK
[0m12:27:13.245342 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (execute): 12:27:13.211470 => 12:27:13.245129
[0m12:27:13.245911 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: Close
[0m12:27:13.247899 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
[0m12:27:13.249668 [debug] [Thread-4  ]: Database Error in model fct_customer_purchase_patterns (models/marts/fct_customer_purchase_patterns.sql)
  function date_diff(unknown, date, date) does not exist
  LINE 43:             DATE_DIFF('day', previous_order_date, order_date...
                       ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/simple_dbt_project/models/marts/fct_customer_purchase_patterns.sql
[0m12:27:13.252857 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1412baf0-52fb-4fbb-8c6c-29f06aeb4724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884687c0>]}
[0m12:27:13.253340 [error] [Thread-4  ]: 3 of 4 ERROR creating sql table model public.fct_customer_purchase_patterns .... [[31mERROR[0m in 0.05s]
[0m12:27:13.253821 [debug] [Thread-4  ]: Finished running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:27:13.252358 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:27:13.254352 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m12:27:13.254972 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:13.257369 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:27:13.258057 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m12:27:13.258732 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:13.262586 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:27:13.263052 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:27:13.263370 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:27:13.264857 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:27:13.267304 [debug] [Thread-3  ]: Applying DROP to: "airflow"."public"."fct_daily_sales__dbt_backup"
[0m12:27:13.269399 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:27:13.270087 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
drop table if exists "airflow"."public"."fct_daily_sales__dbt_backup" cascade
[0m12:27:13.272641 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:27:13.273877 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (execute): 12:27:13.229126 => 12:27:13.273734
[0m12:27:13.274202 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: Close
[0m12:27:13.274904 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1412baf0-52fb-4fbb-8c6c-29f06aeb4724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88629ee0>]}
[0m12:27:13.275394 [info ] [Thread-3  ]: 4 of 4 OK created sql table model public.fct_daily_sales ....................... [[32mSELECT 2[0m in 0.07s]
[0m12:27:13.275910 [debug] [Thread-3  ]: Finished running node model.simple_dbt_project.fct_daily_sales
[0m12:27:13.277593 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:13.277928 [debug] [MainThread]: On master: BEGIN
[0m12:27:13.278183 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:13.281469 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:27:13.282101 [debug] [MainThread]: On master: COMMIT
[0m12:27:13.282718 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:13.283039 [debug] [MainThread]: On master: COMMIT
[0m12:27:13.283419 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:27:13.283681 [debug] [MainThread]: On master: Close
[0m12:27:13.284207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:13.284504 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m12:27:13.284805 [debug] [MainThread]: Connection 'model.simple_dbt_project.my_first_model' was properly closed.
[0m12:27:13.285048 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_customer_purchase_patterns' was properly closed.
[0m12:27:13.285265 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_daily_sales' was properly closed.
[0m12:27:13.285584 [info ] [MainThread]: 
[0m12:27:13.285901 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m12:27:13.286871 [debug] [MainThread]: Command end result
[0m12:27:13.295149 [info ] [MainThread]: 
[0m12:27:13.295539 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:27:13.295994 [info ] [MainThread]: 
[0m12:27:13.297043 [error] [MainThread]:   Database Error in model fct_customer_purchase_patterns (models/marts/fct_customer_purchase_patterns.sql)
  function date_diff(unknown, date, date) does not exist
  LINE 43:             DATE_DIFF('day', previous_order_date, order_date...
                       ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/simple_dbt_project/models/marts/fct_customer_purchase_patterns.sql
[0m12:27:13.297789 [info ] [MainThread]: 
[0m12:27:13.298271 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:27:13.299737 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5895528, "process_user_time": 2.145756, "process_kernel_time": 0.302965, "process_mem_max_rss": "142576", "process_out_blocks": "1661", "command_success": false, "process_in_blocks": "0"}
[0m12:27:13.300241 [debug] [MainThread]: Command `dbt run` failed at 12:27:13.300149 after 0.59 seconds
[0m12:27:13.300557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bde9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884da3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887db160>]}
[0m12:27:13.300885 [debug] [MainThread]: Flushing usage events
[0m12:27:53.303170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03abf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada04d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada04ca0>]}


============================== 12:27:53.308186 | 71e5653f-02cf-4f1b-8a74-6ea01655c91b ==============================
[0m12:27:53.308186 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:27:53.309118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m12:27:53.463753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71e5653f-02cf-4f1b-8a74-6ea01655c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada04670>]}
[0m12:27:53.515993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71e5653f-02cf-4f1b-8a74-6ea01655c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b8f940>]}
[0m12:27:53.516678 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:27:53.522596 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:27:53.550906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:27:53.551552 [debug] [MainThread]: Partial parsing: updated file: simple_dbt_project://models/marts/fct_customer_purchase_patterns.sql
[0m12:27:53.639687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71e5653f-02cf-4f1b-8a74-6ea01655c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7cc730>]}
[0m12:27:53.651629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71e5653f-02cf-4f1b-8a74-6ea01655c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc5abb0>]}
[0m12:27:53.652106 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m12:27:53.652631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71e5653f-02cf-4f1b-8a74-6ea01655c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc5ae20>]}
[0m12:27:53.653726 [info ] [MainThread]: 
[0m12:27:53.654524 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:27:53.655468 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:27:53.662296 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:27:53.662790 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:27:53.663078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:53.668200 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:27:53.669194 [debug] [ThreadPool]: On list_airflow: Close
[0m12:27:53.671282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m12:27:53.676175 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:27:53.676618 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m12:27:53.676881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:53.679471 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:27:53.679925 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:27:53.680274 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:27:53.683171 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.0 seconds
[0m12:27:53.684649 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m12:27:53.685064 [debug] [ThreadPool]: On list_airflow_public: Close
[0m12:27:53.693097 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:53.693508 [debug] [MainThread]: On master: BEGIN
[0m12:27:53.693763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:53.696349 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:27:53.696721 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:53.697038 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:27:53.701269 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:27:53.702194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71e5653f-02cf-4f1b-8a74-6ea01655c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacbece80>]}
[0m12:27:53.702569 [debug] [MainThread]: On master: ROLLBACK
[0m12:27:53.702927 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:53.703196 [debug] [MainThread]: On master: BEGIN
[0m12:27:53.703632 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:27:53.703926 [debug] [MainThread]: On master: COMMIT
[0m12:27:53.704256 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:53.704535 [debug] [MainThread]: On master: COMMIT
[0m12:27:53.704874 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:27:53.705154 [debug] [MainThread]: On master: Close
[0m12:27:53.705659 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:27:53.705991 [info ] [MainThread]: 
[0m12:27:53.711598 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.my_first_model
[0m12:27:53.711969 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_orders
[0m12:27:53.712368 [info ] [Thread-1  ]: 1 of 4 START sql view model public.my_first_model .............................. [RUN]
[0m12:27:53.712809 [info ] [Thread-2  ]: 2 of 4 START sql view model public.stg_orders .................................. [RUN]
[0m12:27:53.713696 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.my_first_model)
[0m12:27:53.714287 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.simple_dbt_project.stg_orders'
[0m12:27:53.714647 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.my_first_model
[0m12:27:53.714999 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m12:27:53.720006 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.my_first_model"
[0m12:27:53.723136 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m12:27:53.724662 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (compile): 12:27:53.715233 => 12:27:53.724447
[0m12:27:53.725117 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.my_first_model
[0m12:27:53.725515 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 12:27:53.720567 => 12:27:53.725341
[0m12:27:53.743267 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_orders
[0m12:27:53.761062 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.my_first_model"
[0m12:27:53.761804 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m12:27:53.762833 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:27:53.763161 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:27:53.764041 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m12:27:53.764353 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:27:53.763513 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: BEGIN
[0m12:27:53.764966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:27:53.767143 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m12:27:53.767515 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:27:53.768090 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:27:53.768411 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */

  create view "airflow"."public"."my_first_model__dbt_tmp"
    
    
  as (
    -- Simple example model
SELECT 1 as id, 'Example' as name
UNION ALL
SELECT 2 as id, 'Test' as name
  );
[0m12:27:53.767760 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:27:53.768834 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m12:27:53.770264 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:27:53.770561 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:27:53.775112 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:27:53.778439 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:27:53.777952 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:27:53.778892 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model" rename to "my_first_model__dbt_backup"
[0m12:27:53.779218 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:53.781669 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:27:53.782329 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:27:53.782087 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:53.784601 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:27:53.785141 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model__dbt_tmp" rename to "my_first_model"
[0m12:27:53.784904 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:53.793053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:53.795843 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:27:53.797214 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:27:53.797508 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:27:53.796836 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:27:53.797881 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:27:53.798219 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:27:53.798575 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m12:27:53.804024 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public"."stg_orders__dbt_backup"
[0m12:27:53.804425 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:27:53.807294 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:27:53.809564 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
drop view if exists "airflow"."public"."stg_orders__dbt_backup" cascade
[0m12:27:53.809228 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."my_first_model__dbt_backup"
[0m12:27:53.810239 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:27:53.810579 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
drop view if exists "airflow"."public"."my_first_model__dbt_backup" cascade
[0m12:27:53.811051 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:27:53.812151 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 12:27:53.749280 => 12:27:53.811990
[0m12:27:53.812692 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: Close
[0m12:27:53.813311 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e5653f-02cf-4f1b-8a74-6ea01655c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac791280>]}
[0m12:27:53.812440 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:27:53.813865 [info ] [Thread-2  ]: 2 of 4 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m12:27:53.816649 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_orders
[0m12:27:53.816120 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (execute): 12:27:53.725699 => 12:27:53.815939
[0m12:27:53.817302 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: Close
[0m12:27:53.817698 [debug] [Thread-4  ]: Began running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:27:53.818162 [debug] [Thread-3  ]: Began running node model.simple_dbt_project.fct_daily_sales
[0m12:27:53.818780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e5653f-02cf-4f1b-8a74-6ea01655c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac3916a0>]}
[0m12:27:53.819243 [info ] [Thread-4  ]: 3 of 4 START sql table model public.fct_customer_purchase_patterns ............. [RUN]
[0m12:27:53.819822 [info ] [Thread-3  ]: 4 of 4 START sql table model public.fct_daily_sales ............................ [RUN]
[0m12:27:53.820921 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.my_first_model ......................... [[32mCREATE VIEW[0m in 0.11s]
[0m12:27:53.821603 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_customer_purchase_patterns'
[0m12:27:53.822277 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_daily_sales'
[0m12:27:53.822779 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.my_first_model
[0m12:27:53.823136 [debug] [Thread-4  ]: Began compiling node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:27:53.823483 [debug] [Thread-3  ]: Began compiling node model.simple_dbt_project.fct_daily_sales
[0m12:27:53.826221 [debug] [Thread-4  ]: Writing injected SQL for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:27:53.829076 [debug] [Thread-3  ]: Writing injected SQL for node "model.simple_dbt_project.fct_daily_sales"
[0m12:27:53.830546 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (compile): 12:27:53.823852 => 12:27:53.830308
[0m12:27:53.830945 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (compile): 12:27:53.826683 => 12:27:53.830780
[0m12:27:53.831590 [debug] [Thread-3  ]: Began executing node model.simple_dbt_project.fct_daily_sales
[0m12:27:53.831256 [debug] [Thread-4  ]: Began executing node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:27:53.849168 [debug] [Thread-3  ]: Writing runtime sql for node "model.simple_dbt_project.fct_daily_sales"
[0m12:27:53.852502 [debug] [Thread-4  ]: Writing runtime sql for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:27:53.853576 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:27:53.853900 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: BEGIN
[0m12:27:53.854188 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:27:53.854695 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: BEGIN
[0m12:27:53.854954 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:27:53.854418 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:27:53.857968 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:27:53.858620 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:27:53.858921 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */

  
    

  create  table "airflow"."public"."fct_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', order_date) as date,
        COUNT(DISTINCT order_id) as total_orders,
        COUNT(DISTINCT customer_id) as unique_customers,
        SUM(amount) as total_amount
    FROM "airflow"."public"."stg_orders"
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT
    date,
    total_orders,
    unique_customers,
    total_amount,
    total_amount / NULLIF(total_orders, 0) as avg_order_value,
    total_amount / NULLIF(unique_customers, 0) as avg_customer_spend
FROM daily_sales
  );
  
[0m12:27:53.858369 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m12:27:53.859357 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:27:53.859818 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */

  
    

  create  table "airflow"."public"."fct_customer_purchase_patterns__dbt_tmp"
  
  
    as
  
  (
    

WITH customer_orders AS (
    SELECT
        customer_id,
        order_date,
        amount,
        LAG(order_date) OVER (
            PARTITION BY customer_id 
            ORDER BY order_date
        ) as previous_order_date
    FROM "airflow"."public"."stg_orders"
),

customer_metrics AS (
    SELECT
        customer_id,
        COUNT(*) as total_orders,
        SUM(amount) as total_amount,
        MIN(order_date) as first_order_date,
        MAX(order_date) as last_order_date,
        AVG(amount) as avg_order_amount,
        -- Use PostgreSQL's date subtraction instead of DATE_DIFF
        AVG(
            CASE 
                WHEN previous_order_date IS NOT NULL 
                THEN (order_date - previous_order_date)
            END
        ) as avg_days_between_orders
    FROM customer_orders
    GROUP BY customer_id
)

SELECT
    customer_id,
    total_orders,
    total_amount,
    first_order_date,
    last_order_date,
    avg_order_amount,
    EXTRACT(epoch FROM avg_days_between_orders) / 86400 as avg_days_between_orders,
    CASE
        WHEN total_orders >= 10 THEN 'High'
        WHEN total_orders >= 5 THEN 'Medium'
        ELSE 'Low'
    END as frequency_segment,
    CASE
        WHEN avg_order_amount >= 200 THEN 'Premium'
        WHEN avg_order_amount >= 100 THEN 'Standard'
        ELSE 'Basic'
    END as value_segment
FROM customer_metrics
  );
  
[0m12:27:53.861754 [debug] [Thread-4  ]: Postgres adapter: Postgres error: function pg_catalog.date_part(unknown, numeric) does not exist
LINE 52:     EXTRACT(epoch FROM avg_days_between_orders) / 86400 as a...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m12:27:53.862232 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: ROLLBACK
[0m12:27:53.862836 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (execute): 12:27:53.849432 => 12:27:53.862654
[0m12:27:53.863454 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: Close
[0m12:27:53.863185 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
[0m12:27:53.865848 [debug] [Thread-4  ]: Database Error in model fct_customer_purchase_patterns (models/marts/fct_customer_purchase_patterns.sql)
  function pg_catalog.date_part(unknown, numeric) does not exist
  LINE 52:     EXTRACT(epoch FROM avg_days_between_orders) / 86400 as a...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/simple_dbt_project/models/marts/fct_customer_purchase_patterns.sql
[0m12:27:53.870476 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e5653f-02cf-4f1b-8a74-6ea01655c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7ba940>]}
[0m12:27:53.869874 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:27:53.871463 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m12:27:53.871073 [error] [Thread-4  ]: 3 of 4 ERROR creating sql table model public.fct_customer_purchase_patterns .... [[31mERROR[0m in 0.05s]
[0m12:27:53.872260 [debug] [Thread-4  ]: Finished running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:27:53.872569 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:53.875132 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:27:53.875530 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m12:27:53.876067 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:53.879736 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:27:53.880368 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:27:53.880699 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:27:53.881792 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:27:53.883989 [debug] [Thread-3  ]: Applying DROP to: "airflow"."public"."fct_daily_sales__dbt_backup"
[0m12:27:53.885959 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:27:53.886485 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
drop table if exists "airflow"."public"."fct_daily_sales__dbt_backup" cascade
[0m12:27:53.891065 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:27:53.892699 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (execute): 12:27:53.831778 => 12:27:53.892524
[0m12:27:53.893127 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: Close
[0m12:27:53.893842 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e5653f-02cf-4f1b-8a74-6ea01655c91b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac78b670>]}
[0m12:27:53.894425 [info ] [Thread-3  ]: 4 of 4 OK created sql table model public.fct_daily_sales ....................... [[32mSELECT 2[0m in 0.07s]
[0m12:27:53.895032 [debug] [Thread-3  ]: Finished running node model.simple_dbt_project.fct_daily_sales
[0m12:27:53.896370 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:53.897490 [debug] [MainThread]: On master: BEGIN
[0m12:27:53.898067 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:53.901061 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:27:53.901652 [debug] [MainThread]: On master: COMMIT
[0m12:27:53.901927 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:53.902522 [debug] [MainThread]: On master: COMMIT
[0m12:27:53.903248 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:27:53.903559 [debug] [MainThread]: On master: Close
[0m12:27:53.904119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:53.904407 [debug] [MainThread]: Connection 'model.simple_dbt_project.my_first_model' was properly closed.
[0m12:27:53.904673 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m12:27:53.904902 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_customer_purchase_patterns' was properly closed.
[0m12:27:53.905163 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_daily_sales' was properly closed.
[0m12:27:53.905481 [info ] [MainThread]: 
[0m12:27:53.905830 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m12:27:53.906775 [debug] [MainThread]: Command end result
[0m12:27:53.916158 [info ] [MainThread]: 
[0m12:27:53.916621 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:27:53.916995 [info ] [MainThread]: 
[0m12:27:53.917519 [error] [MainThread]:   Database Error in model fct_customer_purchase_patterns (models/marts/fct_customer_purchase_patterns.sql)
  function pg_catalog.date_part(unknown, numeric) does not exist
  LINE 52:     EXTRACT(epoch FROM avg_days_between_orders) / 86400 as a...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/simple_dbt_project/models/marts/fct_customer_purchase_patterns.sql
[0m12:27:53.917923 [info ] [MainThread]: 
[0m12:27:53.918622 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:27:53.919750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6427755, "process_user_time": 2.135257, "process_kernel_time": 0.19993, "process_mem_max_rss": "142632", "process_out_blocks": "2444", "command_success": false, "process_in_blocks": "0"}
[0m12:27:53.920322 [debug] [MainThread]: Command `dbt run` failed at 12:27:53.920212 after 0.64 seconds
[0m12:27:53.920662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03abf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b8f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface0c160>]}
[0m12:27:53.920992 [debug] [MainThread]: Flushing usage events
[0m12:28:24.975740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9176afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed42790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed42d00>]}


============================== 12:28:24.980401 | 34a42b75-322c-41ce-bfad-7d9d37482217 ==============================
[0m12:28:24.980401 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:28:24.981098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m12:28:25.129012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34a42b75-322c-41ce-bfad-7d9d37482217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee05d60>]}
[0m12:28:25.181671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34a42b75-322c-41ce-bfad-7d9d37482217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee2d970>]}
[0m12:28:25.182341 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:28:25.188130 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:28:25.214358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:28:25.215070 [debug] [MainThread]: Partial parsing: updated file: simple_dbt_project://models/marts/fct_customer_purchase_patterns.sql
[0m12:28:25.301956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34a42b75-322c-41ce-bfad-7d9d37482217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd0b700>]}
[0m12:28:25.315640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34a42b75-322c-41ce-bfad-7d9d37482217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df62b80>]}
[0m12:28:25.316102 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m12:28:25.316666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a42b75-322c-41ce-bfad-7d9d37482217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df62df0>]}
[0m12:28:25.317794 [info ] [MainThread]: 
[0m12:28:25.318921 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:25.319989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:28:25.327131 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:28:25.327643 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:28:25.327924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:25.332981 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:28:25.334053 [debug] [ThreadPool]: On list_airflow: Close
[0m12:28:25.336179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m12:28:25.340551 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:28:25.340930 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m12:28:25.341177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:25.343747 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:28:25.344319 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:28:25.344696 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:28:25.348549 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.0 seconds
[0m12:28:25.350051 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m12:28:25.350443 [debug] [ThreadPool]: On list_airflow_public: Close
[0m12:28:25.358258 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:25.358671 [debug] [MainThread]: On master: BEGIN
[0m12:28:25.358947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:25.361387 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:25.361762 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:25.362067 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:25.366429 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:28:25.367363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a42b75-322c-41ce-bfad-7d9d37482217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8def8eb0>]}
[0m12:28:25.367733 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:25.368091 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:25.368363 [debug] [MainThread]: On master: BEGIN
[0m12:28:25.368806 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:25.369113 [debug] [MainThread]: On master: COMMIT
[0m12:28:25.369425 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:25.369736 [debug] [MainThread]: On master: COMMIT
[0m12:28:25.370103 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:28:25.370393 [debug] [MainThread]: On master: Close
[0m12:28:25.370915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:25.371247 [info ] [MainThread]: 
[0m12:28:25.376902 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.my_first_model
[0m12:28:25.377621 [info ] [Thread-1  ]: 1 of 4 START sql view model public.my_first_model .............................. [RUN]
[0m12:28:25.377297 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_orders
[0m12:28:25.378191 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.my_first_model)
[0m12:28:25.378626 [info ] [Thread-2  ]: 2 of 4 START sql view model public.stg_orders .................................. [RUN]
[0m12:28:25.379030 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.my_first_model
[0m12:28:25.379604 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_airflow, now model.simple_dbt_project.stg_orders)
[0m12:28:25.384286 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.my_first_model"
[0m12:28:25.384716 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m12:28:25.387036 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m12:28:25.388196 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (compile): 12:28:25.379875 => 12:28:25.388005
[0m12:28:25.388579 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 12:28:25.385114 => 12:28:25.388424
[0m12:28:25.389169 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_orders
[0m12:28:25.388839 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.my_first_model
[0m12:28:25.419423 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m12:28:25.420884 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.my_first_model"
[0m12:28:25.421989 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:28:25.422383 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m12:28:25.422693 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:28:25.423266 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: BEGIN
[0m12:28:25.423551 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:28:25.422940 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:28:25.426258 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:28:25.426961 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:28:25.427319 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */

  create view "airflow"."public"."my_first_model__dbt_tmp"
    
    
  as (
    -- Simple example model
SELECT 1 as id, 'Example' as name
UNION ALL
SELECT 2 as id, 'Test' as name
  );
[0m12:28:25.426683 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m12:28:25.427728 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:28:25.428133 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m12:28:25.429455 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:25.429781 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:28:25.434570 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:28:25.437571 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:28:25.437151 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:28:25.438004 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model" rename to "my_first_model__dbt_backup"
[0m12:28:25.438335 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:25.440559 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:28:25.441100 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:28:25.440867 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:25.443281 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:28:25.443845 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model__dbt_tmp" rename to "my_first_model"
[0m12:28:25.443580 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:25.453940 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:28:25.454563 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:28:25.454841 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:28:25.454323 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:25.456134 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:28:25.456681 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:28:25.456986 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:28:25.456455 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m12:28:25.462186 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public"."stg_orders__dbt_backup"
[0m12:28:25.462553 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:28:25.465149 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:28:25.467356 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
drop view if exists "airflow"."public"."stg_orders__dbt_backup" cascade
[0m12:28:25.466975 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."my_first_model__dbt_backup"
[0m12:28:25.468045 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:28:25.468423 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
drop view if exists "airflow"."public"."my_first_model__dbt_backup" cascade
[0m12:28:25.468689 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:25.469799 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 12:28:25.389380 => 12:28:25.469658
[0m12:28:25.470343 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: Close
[0m12:28:25.470927 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34a42b75-322c-41ce-bfad-7d9d37482217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dce2040>]}
[0m12:28:25.471477 [info ] [Thread-2  ]: 2 of 4 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m12:28:25.471986 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_orders
[0m12:28:25.470083 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:28:25.473535 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (execute): 12:28:25.407854 => 12:28:25.473382
[0m12:28:25.473923 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: Close
[0m12:28:25.474305 [debug] [Thread-4  ]: Began running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:28:25.474640 [debug] [Thread-3  ]: Began running node model.simple_dbt_project.fct_daily_sales
[0m12:28:25.475244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34a42b75-322c-41ce-bfad-7d9d37482217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dce9d00>]}
[0m12:28:25.475653 [info ] [Thread-4  ]: 3 of 4 START sql table model public.fct_customer_purchase_patterns ............. [RUN]
[0m12:28:25.476207 [info ] [Thread-3  ]: 4 of 4 START sql table model public.fct_daily_sales ............................ [RUN]
[0m12:28:25.477009 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.my_first_model ......................... [[32mCREATE VIEW[0m in 0.10s]
[0m12:28:25.477677 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_customer_purchase_patterns'
[0m12:28:25.478663 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_daily_sales'
[0m12:28:25.479349 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.my_first_model
[0m12:28:25.479916 [debug] [Thread-4  ]: Began compiling node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:28:25.480299 [debug] [Thread-3  ]: Began compiling node model.simple_dbt_project.fct_daily_sales
[0m12:28:25.483028 [debug] [Thread-4  ]: Writing injected SQL for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:28:25.485230 [debug] [Thread-3  ]: Writing injected SQL for node "model.simple_dbt_project.fct_daily_sales"
[0m12:28:25.486681 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (compile): 12:28:25.483357 => 12:28:25.486498
[0m12:28:25.487011 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (compile): 12:28:25.480702 => 12:28:25.486874
[0m12:28:25.487684 [debug] [Thread-4  ]: Began executing node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:28:25.487325 [debug] [Thread-3  ]: Began executing node model.simple_dbt_project.fct_daily_sales
[0m12:28:25.509344 [debug] [Thread-3  ]: Writing runtime sql for node "model.simple_dbt_project.fct_daily_sales"
[0m12:28:25.509741 [debug] [Thread-4  ]: Writing runtime sql for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:28:25.510804 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:28:25.511181 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: BEGIN
[0m12:28:25.511497 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:28:25.511996 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: BEGIN
[0m12:28:25.512599 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:28:25.511722 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:28:25.515475 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:28:25.516104 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:28:25.516449 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */

  
    

  create  table "airflow"."public"."fct_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', order_date) as date,
        COUNT(DISTINCT order_id) as total_orders,
        COUNT(DISTINCT customer_id) as unique_customers,
        SUM(amount) as total_amount
    FROM "airflow"."public"."stg_orders"
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT
    date,
    total_orders,
    unique_customers,
    total_amount,
    total_amount / NULLIF(total_orders, 0) as avg_order_value,
    total_amount / NULLIF(unique_customers, 0) as avg_customer_spend
FROM daily_sales
  );
  
[0m12:28:25.515861 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m12:28:25.516848 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:28:25.517204 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */

  
    

  create  table "airflow"."public"."fct_customer_purchase_patterns__dbt_tmp"
  
  
    as
  
  (
    

WITH customer_orders AS (
    SELECT
        customer_id,
        order_date,
        amount,
        LAG(order_date) OVER (
            PARTITION BY customer_id 
            ORDER BY order_date
        ) as previous_order_date
    FROM "airflow"."public"."stg_orders"
),

customer_metrics AS (
    SELECT
        customer_id,
        COUNT(*) as total_orders,
        SUM(amount) as total_amount,
        MIN(order_date) as first_order_date,
        MAX(order_date) as last_order_date,
        AVG(amount) as avg_order_amount,
        -- Use PostgreSQL's date subtraction
        AVG(
            CASE 
                WHEN previous_order_date IS NOT NULL 
                THEN DATE_PART('day', order_date::timestamp - previous_order_date::timestamp)
            END
        ) as avg_days_between_orders
    FROM customer_orders
    GROUP BY customer_id
)

SELECT
    customer_id,
    total_orders,
    total_amount,
    first_order_date,
    last_order_date,
    avg_order_amount,
    avg_days_between_orders,
    CASE
        WHEN total_orders >= 10 THEN 'High'
        WHEN total_orders >= 5 THEN 'Medium'
        ELSE 'Low'
    END as frequency_segment,
    CASE
        WHEN avg_order_amount >= 200 THEN 'Premium'
        WHEN avg_order_amount >= 100 THEN 'Standard'
        ELSE 'Basic'
    END as value_segment
FROM customer_metrics
  );
  
[0m12:28:25.520607 [debug] [Thread-4  ]: SQL status: SELECT 3 in 0.0 seconds
[0m12:28:25.524087 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:28:25.524696 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */
alter table "airflow"."public"."fct_customer_purchase_patterns__dbt_tmp" rename to "fct_customer_purchase_patterns"
[0m12:28:25.524452 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
[0m12:28:25.527136 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:28:25.527713 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m12:28:25.527465 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:25.531032 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: COMMIT
[0m12:28:25.531652 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:28:25.531983 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: COMMIT
[0m12:28:25.531405 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:25.534540 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:28:25.534919 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m12:28:25.535261 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m12:28:25.537203 [debug] [Thread-4  ]: Applying DROP to: "airflow"."public"."fct_customer_purchase_patterns__dbt_backup"
[0m12:28:25.539349 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:28:25.539931 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */
drop table if exists "airflow"."public"."fct_customer_purchase_patterns__dbt_backup" cascade
[0m12:28:25.539689 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:28:25.541480 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:28:25.542033 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:28:25.542344 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:28:25.541799 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:28:25.543497 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (execute): 12:28:25.487898 => 12:28:25.543347
[0m12:28:25.544056 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: Close
[0m12:28:25.543790 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:28:25.544727 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34a42b75-322c-41ce-bfad-7d9d37482217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d8d0550>]}
[0m12:28:25.547505 [info ] [Thread-4  ]: 3 of 4 OK created sql table model public.fct_customer_purchase_patterns ........ [[32mSELECT 3[0m in 0.07s]
[0m12:28:25.546899 [debug] [Thread-3  ]: Applying DROP to: "airflow"."public"."fct_daily_sales__dbt_backup"
[0m12:28:25.548724 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:28:25.549029 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
drop table if exists "airflow"."public"."fct_daily_sales__dbt_backup" cascade
[0m12:28:25.548054 [debug] [Thread-4  ]: Finished running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:28:25.551820 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:28:25.553320 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (execute): 12:28:25.506490 => 12:28:25.553154
[0m12:28:25.553679 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: Close
[0m12:28:25.554311 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34a42b75-322c-41ce-bfad-7d9d37482217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9b0d60>]}
[0m12:28:25.554793 [info ] [Thread-3  ]: 4 of 4 OK created sql table model public.fct_daily_sales ....................... [[32mSELECT 2[0m in 0.08s]
[0m12:28:25.555281 [debug] [Thread-3  ]: Finished running node model.simple_dbt_project.fct_daily_sales
[0m12:28:25.556562 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:25.556908 [debug] [MainThread]: On master: BEGIN
[0m12:28:25.557193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:25.561521 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:28:25.561932 [debug] [MainThread]: On master: COMMIT
[0m12:28:25.562196 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:25.562452 [debug] [MainThread]: On master: COMMIT
[0m12:28:25.562748 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:28:25.562993 [debug] [MainThread]: On master: Close
[0m12:28:25.563490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:25.563744 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m12:28:25.563968 [debug] [MainThread]: Connection 'model.simple_dbt_project.my_first_model' was properly closed.
[0m12:28:25.564189 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_customer_purchase_patterns' was properly closed.
[0m12:28:25.564409 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_daily_sales' was properly closed.
[0m12:28:25.564728 [info ] [MainThread]: 
[0m12:28:25.565044 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m12:28:25.565991 [debug] [MainThread]: Command end result
[0m12:28:25.573915 [info ] [MainThread]: 
[0m12:28:25.574400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:25.574822 [info ] [MainThread]: 
[0m12:28:25.575317 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:28:25.576175 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6307503, "process_user_time": 2.120786, "process_kernel_time": 0.180066, "process_mem_max_rss": "142600", "process_out_blocks": "2441", "process_in_blocks": "0"}
[0m12:28:25.576702 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:25.576601 after 0.63 seconds
[0m12:28:25.577017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9176afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc6f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee05d60>]}
[0m12:28:25.577417 [debug] [MainThread]: Flushing usage events
[0m12:29:14.586642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a8ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83081d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83081610>]}


============================== 12:29:14.590787 | 7c1740e4-70c4-4aab-8c9b-5b32c77e8a3e ==============================
[0m12:29:14.590787 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:29:14.591649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:14.740860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c1740e4-70c4-4aab-8c9b-5b32c77e8a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848c0100>]}
[0m12:29:14.790722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c1740e4-70c4-4aab-8c9b-5b32c77e8a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8245a9d0>]}
[0m12:29:14.791433 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:29:14.797215 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:29:14.821355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:14.821846 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:14.826137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c1740e4-70c4-4aab-8c9b-5b32c77e8a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821caee0>]}
[0m12:29:14.839794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c1740e4-70c4-4aab-8c9b-5b32c77e8a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82298cd0>]}
[0m12:29:14.840342 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m12:29:14.840934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1740e4-70c4-4aab-8c9b-5b32c77e8a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82298e50>]}
[0m12:29:14.842317 [info ] [MainThread]: 
[0m12:29:14.843183 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:29:14.844527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:29:14.852486 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:29:14.852881 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:29:14.853122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:14.858346 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:29:14.859415 [debug] [ThreadPool]: On list_airflow: Close
[0m12:29:14.860926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m12:29:14.865578 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:29:14.865979 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m12:29:14.866219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:14.869041 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:29:14.869512 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:29:14.869838 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:29:14.876804 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.0 seconds
[0m12:29:14.878553 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m12:29:14.878972 [debug] [ThreadPool]: On list_airflow_public: Close
[0m12:29:14.887170 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:14.887516 [debug] [MainThread]: On master: BEGIN
[0m12:29:14.887761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:14.890329 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:29:14.890650 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:14.890940 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:29:14.895154 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:29:14.896004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1740e4-70c4-4aab-8c9b-5b32c77e8a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff823bbf10>]}
[0m12:29:14.896414 [debug] [MainThread]: On master: ROLLBACK
[0m12:29:14.896760 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:14.897001 [debug] [MainThread]: On master: BEGIN
[0m12:29:14.897383 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:29:14.897657 [debug] [MainThread]: On master: COMMIT
[0m12:29:14.897883 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:14.898100 [debug] [MainThread]: On master: COMMIT
[0m12:29:14.898410 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:29:14.898658 [debug] [MainThread]: On master: Close
[0m12:29:14.899144 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:29:14.899569 [info ] [MainThread]: 
[0m12:29:14.905150 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.my_first_model
[0m12:29:14.905516 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_orders
[0m12:29:14.905901 [info ] [Thread-1  ]: 1 of 4 START sql view model public.my_first_model .............................. [RUN]
[0m12:29:14.906308 [info ] [Thread-2  ]: 2 of 4 START sql view model public.stg_orders .................................. [RUN]
[0m12:29:14.906956 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.my_first_model)
[0m12:29:14.907496 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.simple_dbt_project.stg_orders'
[0m12:29:14.907822 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.my_first_model
[0m12:29:14.908137 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m12:29:14.912736 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.my_first_model"
[0m12:29:14.914865 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m12:29:14.915877 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (compile): 12:29:14.908343 => 12:29:14.915723
[0m12:29:14.916244 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.my_first_model
[0m12:29:14.916572 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 12:29:14.912998 => 12:29:14.916436
[0m12:29:14.933818 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_orders
[0m12:29:14.939245 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.my_first_model"
[0m12:29:14.942712 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m12:29:14.943887 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:29:14.944228 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: BEGIN
[0m12:29:14.944543 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:29:14.945058 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m12:29:14.945335 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:29:14.944767 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:29:14.947682 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:29:14.948022 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:29:14.948303 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */

  create view "airflow"."public"."my_first_model__dbt_tmp"
    
    
  as (
    -- Simple example model
SELECT 1 as id, 'Example' as name
UNION ALL
SELECT 2 as id, 'Test' as name
  );
[0m12:29:14.949918 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m12:29:14.950472 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:29:14.950761 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m12:29:14.950222 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:29:14.955275 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:29:14.955945 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model" rename to "my_first_model__dbt_backup"
[0m12:29:14.955666 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:29:14.958338 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:29:14.959045 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:29:14.958732 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:29:14.961033 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:29:14.961522 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model__dbt_tmp" rename to "my_first_model"
[0m12:29:14.961296 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:29:14.963446 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:29:14.963930 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:29:14.963715 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:29:14.973589 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:29:14.974850 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:29:14.975152 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:29:14.975428 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:29:14.973960 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:29:14.975792 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:29:14.976123 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:29:14.976437 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m12:29:14.980429 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public"."stg_orders__dbt_backup"
[0m12:29:14.980724 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:29:14.984956 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."my_first_model__dbt_backup"
[0m12:29:14.985510 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:29:14.985864 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
drop view if exists "airflow"."public"."my_first_model__dbt_backup" cascade
[0m12:29:14.983235 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:29:14.986251 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
drop view if exists "airflow"."public"."stg_orders__dbt_backup" cascade
[0m12:29:14.986965 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:29:14.987252 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:29:14.988360 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (execute): 12:29:14.916735 => 12:29:14.988213
[0m12:29:14.989787 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: Close
[0m12:29:14.990442 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1740e4-70c4-4aab-8c9b-5b32c77e8a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff820d96d0>]}
[0m12:29:14.990924 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.my_first_model ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m12:29:14.991439 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.my_first_model
[0m12:29:14.989486 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 12:29:14.939439 => 12:29:14.989337
[0m12:29:14.991979 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: Close
[0m12:29:14.992630 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1740e4-70c4-4aab-8c9b-5b32c77e8a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8209a8b0>]}
[0m12:29:14.993126 [info ] [Thread-2  ]: 2 of 4 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m12:29:14.993947 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_orders
[0m12:29:14.995440 [debug] [Thread-4  ]: Began running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:29:14.995850 [debug] [Thread-3  ]: Began running node model.simple_dbt_project.fct_daily_sales
[0m12:29:14.996392 [info ] [Thread-4  ]: 3 of 4 START sql table model public.fct_customer_purchase_patterns ............. [RUN]
[0m12:29:14.996940 [info ] [Thread-3  ]: 4 of 4 START sql table model public.fct_daily_sales ............................ [RUN]
[0m12:29:14.998034 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_customer_purchase_patterns'
[0m12:29:14.998662 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_daily_sales'
[0m12:29:14.999014 [debug] [Thread-4  ]: Began compiling node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:29:14.999341 [debug] [Thread-3  ]: Began compiling node model.simple_dbt_project.fct_daily_sales
[0m12:29:15.002733 [debug] [Thread-4  ]: Writing injected SQL for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:29:15.004976 [debug] [Thread-3  ]: Writing injected SQL for node "model.simple_dbt_project.fct_daily_sales"
[0m12:29:15.006370 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (compile): 12:29:14.999591 => 12:29:15.006167
[0m12:29:15.006726 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (compile): 12:29:15.003057 => 12:29:15.006586
[0m12:29:15.007372 [debug] [Thread-3  ]: Began executing node model.simple_dbt_project.fct_daily_sales
[0m12:29:15.007023 [debug] [Thread-4  ]: Began executing node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:29:15.023674 [debug] [Thread-3  ]: Writing runtime sql for node "model.simple_dbt_project.fct_daily_sales"
[0m12:29:15.026800 [debug] [Thread-4  ]: Writing runtime sql for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:29:15.027779 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:29:15.028188 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: BEGIN
[0m12:29:15.028814 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:29:15.028552 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:29:15.029360 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: BEGIN
[0m12:29:15.029995 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:29:15.031776 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:29:15.032178 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:29:15.032557 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */

  
    

  create  table "airflow"."public"."fct_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', order_date) as date,
        COUNT(DISTINCT order_id) as total_orders,
        COUNT(DISTINCT customer_id) as unique_customers,
        SUM(amount) as total_amount
    FROM "airflow"."public"."stg_orders"
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT
    date,
    total_orders,
    unique_customers,
    total_amount,
    total_amount / NULLIF(total_orders, 0) as avg_order_value,
    total_amount / NULLIF(unique_customers, 0) as avg_customer_spend
FROM daily_sales
  );
  
[0m12:29:15.033029 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m12:29:15.033353 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:29:15.033731 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */

  
    

  create  table "airflow"."public"."fct_customer_purchase_patterns__dbt_tmp"
  
  
    as
  
  (
    

WITH customer_orders AS (
    SELECT
        customer_id,
        order_date,
        amount,
        LAG(order_date) OVER (
            PARTITION BY customer_id 
            ORDER BY order_date
        ) as previous_order_date
    FROM "airflow"."public"."stg_orders"
),

customer_metrics AS (
    SELECT
        customer_id,
        COUNT(*) as total_orders,
        SUM(amount) as total_amount,
        MIN(order_date) as first_order_date,
        MAX(order_date) as last_order_date,
        AVG(amount) as avg_order_amount,
        -- Use PostgreSQL's date subtraction
        AVG(
            CASE 
                WHEN previous_order_date IS NOT NULL 
                THEN DATE_PART('day', order_date::timestamp - previous_order_date::timestamp)
            END
        ) as avg_days_between_orders
    FROM customer_orders
    GROUP BY customer_id
)

SELECT
    customer_id,
    total_orders,
    total_amount,
    first_order_date,
    last_order_date,
    avg_order_amount,
    avg_days_between_orders,
    CASE
        WHEN total_orders >= 10 THEN 'High'
        WHEN total_orders >= 5 THEN 'Medium'
        ELSE 'Low'
    END as frequency_segment,
    CASE
        WHEN avg_order_amount >= 200 THEN 'Premium'
        WHEN avg_order_amount >= 100 THEN 'Standard'
        ELSE 'Basic'
    END as value_segment
FROM customer_metrics
  );
  
[0m12:29:15.037046 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
[0m12:29:15.037532 [debug] [Thread-4  ]: SQL status: SELECT 3 in 0.0 seconds
[0m12:29:15.040721 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:29:15.043549 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m12:29:15.043182 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:29:15.043952 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */
alter table "airflow"."public"."fct_customer_purchase_patterns" rename to "fct_customer_purchase_patterns__dbt_backup"
[0m12:29:15.044224 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:29:15.046549 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:29:15.047087 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m12:29:15.046860 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:29:15.049652 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:29:15.050151 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */
alter table "airflow"."public"."fct_customer_purchase_patterns__dbt_tmp" rename to "fct_customer_purchase_patterns"
[0m12:29:15.049927 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:29:15.053252 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:29:15.053771 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:29:15.054031 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:29:15.053547 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:29:15.055251 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: COMMIT
[0m12:29:15.055837 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:29:15.056123 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: COMMIT
[0m12:29:15.055578 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:29:15.058036 [debug] [Thread-3  ]: Applying DROP to: "airflow"."public"."fct_daily_sales__dbt_backup"
[0m12:29:15.059891 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:29:15.060205 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
drop table if exists "airflow"."public"."fct_daily_sales__dbt_backup" cascade
[0m12:29:15.058305 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m12:29:15.062181 [debug] [Thread-4  ]: Applying DROP to: "airflow"."public"."fct_customer_purchase_patterns__dbt_backup"
[0m12:29:15.062808 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:29:15.063363 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */
drop table if exists "airflow"."public"."fct_customer_purchase_patterns__dbt_backup" cascade
[0m12:29:15.063103 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:29:15.064615 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (execute): 12:29:15.007702 => 12:29:15.064466
[0m12:29:15.065284 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: Close
[0m12:29:15.065989 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1740e4-70c4-4aab-8c9b-5b32c77e8a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817823d0>]}
[0m12:29:15.066540 [info ] [Thread-3  ]: 4 of 4 OK created sql table model public.fct_daily_sales ....................... [[32mSELECT 2[0m in 0.07s]
[0m12:29:15.067056 [debug] [Thread-3  ]: Finished running node model.simple_dbt_project.fct_daily_sales
[0m12:29:15.064914 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:29:15.068291 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (execute): 12:29:15.023914 => 12:29:15.068152
[0m12:29:15.068607 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: Close
[0m12:29:15.069158 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1740e4-70c4-4aab-8c9b-5b32c77e8a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8178bca0>]}
[0m12:29:15.069614 [info ] [Thread-4  ]: 3 of 4 OK created sql table model public.fct_customer_purchase_patterns ........ [[32mSELECT 3[0m in 0.07s]
[0m12:29:15.070073 [debug] [Thread-4  ]: Finished running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:29:15.071248 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:15.071531 [debug] [MainThread]: On master: BEGIN
[0m12:29:15.071766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:29:15.074186 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:29:15.074512 [debug] [MainThread]: On master: COMMIT
[0m12:29:15.074763 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:15.074991 [debug] [MainThread]: On master: COMMIT
[0m12:29:15.075301 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:29:15.075576 [debug] [MainThread]: On master: Close
[0m12:29:15.076078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:15.076410 [debug] [MainThread]: Connection 'model.simple_dbt_project.my_first_model' was properly closed.
[0m12:29:15.076693 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m12:29:15.076930 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_customer_purchase_patterns' was properly closed.
[0m12:29:15.077175 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_daily_sales' was properly closed.
[0m12:29:15.077468 [info ] [MainThread]: 
[0m12:29:15.077759 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m12:29:15.078582 [debug] [MainThread]: Command end result
[0m12:29:15.086174 [info ] [MainThread]: 
[0m12:29:15.086624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:29:15.087036 [info ] [MainThread]: 
[0m12:29:15.087464 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:29:15.088266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5275807, "process_user_time": 1.932368, "process_kernel_time": 0.152581, "process_mem_max_rss": "182184", "process_out_blocks": "1662", "process_in_blocks": "0"}
[0m12:29:15.088729 [debug] [MainThread]: Command `dbt run` succeeded at 12:29:15.088628 after 0.53 seconds
[0m12:29:15.089036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a8ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff820ceb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8245a9d0>]}
[0m12:29:15.089362 [debug] [MainThread]: Flushing usage events
[0m12:39:53.137259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93728fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911e7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911e7eb0>]}


============================== 12:39:53.163648 | cf631fe6-80b7-4bde-a60a-580d666572d1 ==============================
[0m12:39:53.163648 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:39:53.164372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:53.357212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf631fe6-80b7-4bde-a60a-580d666572d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929868b0>]}
[0m12:39:53.407373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf631fe6-80b7-4bde-a60a-580d666572d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912f0f70>]}
[0m12:39:53.408052 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:39:53.415549 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:39:53.448351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:53.448832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:53.453540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf631fe6-80b7-4bde-a60a-580d666572d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90257e20>]}
[0m12:39:53.464085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf631fe6-80b7-4bde-a60a-580d666572d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9031ebb0>]}
[0m12:39:53.464519 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m12:39:53.464825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf631fe6-80b7-4bde-a60a-580d666572d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9031ed60>]}
[0m12:39:53.465875 [info ] [MainThread]: 
[0m12:39:53.466486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:53.467739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:39:53.474635 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:39:53.474994 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:39:53.475237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:53.497081 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:39:53.498245 [debug] [ThreadPool]: On list_airflow: Close
[0m12:39:53.499995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m12:39:53.504903 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:39:53.505386 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m12:39:53.505689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:53.509372 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:39:53.509844 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:39:53.510264 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:39:53.518332 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.0 seconds
[0m12:39:53.519882 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m12:39:53.520273 [debug] [ThreadPool]: On list_airflow_public: Close
[0m12:39:53.529084 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:53.529645 [debug] [MainThread]: On master: BEGIN
[0m12:39:53.529976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:53.532996 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:39:53.533349 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:53.533670 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:53.540197 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:53.541087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf631fe6-80b7-4bde-a60a-580d666572d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90257d60>]}
[0m12:39:53.541440 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:53.541768 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:53.542004 [debug] [MainThread]: On master: BEGIN
[0m12:39:53.542373 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:39:53.542614 [debug] [MainThread]: On master: COMMIT
[0m12:39:53.542835 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:53.543110 [debug] [MainThread]: On master: COMMIT
[0m12:39:53.543519 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:39:53.544062 [debug] [MainThread]: On master: Close
[0m12:39:53.544933 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:53.545301 [info ] [MainThread]: 
[0m12:39:53.551072 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.my_first_model
[0m12:39:53.551450 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_orders
[0m12:39:53.551829 [info ] [Thread-1  ]: 1 of 4 START sql view model public.my_first_model .............................. [RUN]
[0m12:39:53.552391 [info ] [Thread-2  ]: 2 of 4 START sql view model public.stg_orders .................................. [RUN]
[0m12:39:53.553073 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.my_first_model)
[0m12:39:53.553635 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.simple_dbt_project.stg_orders'
[0m12:39:53.553983 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.my_first_model
[0m12:39:53.554309 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m12:39:53.558925 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.my_first_model"
[0m12:39:53.561279 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m12:39:53.562801 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (compile): 12:39:53.554536 => 12:39:53.562636
[0m12:39:53.563172 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.my_first_model
[0m12:39:53.563523 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 12:39:53.559204 => 12:39:53.563391
[0m12:39:53.580141 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_orders
[0m12:39:53.585630 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.my_first_model"
[0m12:39:53.589075 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m12:39:53.590365 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:39:53.590960 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:39:53.591655 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m12:39:53.592276 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:39:53.591204 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: BEGIN
[0m12:39:53.593429 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:53.595849 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m12:39:53.596288 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:39:53.597015 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m12:39:53.597589 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:39:53.597984 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:39:53.598341 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */

  create view "airflow"."public"."my_first_model__dbt_tmp"
    
    
  as (
    -- Simple example model
SELECT 1 as id, 'Example' as name
UNION ALL
SELECT 2 as id, 'Test' as name
  );
[0m12:39:53.602345 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:39:53.602863 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:39:53.607930 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:39:53.612460 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:39:53.611896 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:39:53.612933 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model" rename to "my_first_model__dbt_backup"
[0m12:39:53.613613 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:39:53.613899 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:39:53.617538 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:39:53.621218 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
alter table "airflow"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:39:53.620708 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:39:53.621695 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model__dbt_tmp" rename to "my_first_model"
[0m12:39:53.622011 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:39:53.628416 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:39:53.635606 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:39:53.636065 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:39:53.636347 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m12:39:53.634283 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:39:53.636726 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:39:53.637013 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: COMMIT
[0m12:39:53.638595 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:39:53.638884 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m12:39:53.642864 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."my_first_model__dbt_backup"
[0m12:39:53.644598 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public"."stg_orders__dbt_backup"
[0m12:39:53.648322 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m12:39:53.648642 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */
drop view if exists "airflow"."public"."stg_orders__dbt_backup" cascade
[0m12:39:53.647846 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m12:39:53.649043 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
drop view if exists "airflow"."public"."my_first_model__dbt_backup" cascade
[0m12:39:53.650508 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:39:53.651641 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (execute): 12:39:53.563685 => 12:39:53.651511
[0m12:39:53.651929 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: Close
[0m12:39:53.652501 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf631fe6-80b7-4bde-a60a-580d666572d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900704c0>]}
[0m12:39:53.652971 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.my_first_model ......................... [[32mCREATE VIEW[0m in 0.10s]
[0m12:39:53.653453 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.my_first_model
[0m12:39:53.650788 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:39:53.654488 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 12:39:53.585824 => 12:39:53.654368
[0m12:39:53.654801 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: Close
[0m12:39:53.655347 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf631fe6-80b7-4bde-a60a-580d666572d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90124c10>]}
[0m12:39:53.655781 [info ] [Thread-2  ]: 2 of 4 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m12:39:53.656198 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_orders
[0m12:39:53.656817 [debug] [Thread-4  ]: Began running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:39:53.657150 [debug] [Thread-3  ]: Began running node model.simple_dbt_project.fct_daily_sales
[0m12:39:53.657486 [info ] [Thread-4  ]: 3 of 4 START sql table model public.fct_customer_purchase_patterns ............. [RUN]
[0m12:39:53.657894 [info ] [Thread-3  ]: 4 of 4 START sql table model public.fct_daily_sales ............................ [RUN]
[0m12:39:53.658540 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_customer_purchase_patterns'
[0m12:39:53.659042 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_daily_sales'
[0m12:39:53.659371 [debug] [Thread-4  ]: Began compiling node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:39:53.659679 [debug] [Thread-3  ]: Began compiling node model.simple_dbt_project.fct_daily_sales
[0m12:39:53.662131 [debug] [Thread-4  ]: Writing injected SQL for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:39:53.663983 [debug] [Thread-3  ]: Writing injected SQL for node "model.simple_dbt_project.fct_daily_sales"
[0m12:39:53.665495 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (compile): 12:39:53.659883 => 12:39:53.665336
[0m12:39:53.665858 [debug] [Thread-4  ]: Began executing node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:39:53.666189 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (compile): 12:39:53.662379 => 12:39:53.666049
[0m12:39:53.684045 [debug] [Thread-3  ]: Began executing node model.simple_dbt_project.fct_daily_sales
[0m12:39:53.683690 [debug] [Thread-4  ]: Writing runtime sql for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:39:53.687123 [debug] [Thread-3  ]: Writing runtime sql for node "model.simple_dbt_project.fct_daily_sales"
[0m12:39:53.688369 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:39:53.688698 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: BEGIN
[0m12:39:53.688976 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:39:53.689457 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: BEGIN
[0m12:39:53.689700 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:39:53.689201 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:39:53.692981 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m12:39:53.693395 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:39:53.693790 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */

  
    

  create  table "airflow"."public"."fct_customer_purchase_patterns__dbt_tmp"
  
  
    as
  
  (
    

WITH customer_orders AS (
    SELECT
        customer_id,
        order_date,
        amount,
        LAG(order_date) OVER (
            PARTITION BY customer_id 
            ORDER BY order_date
        ) as previous_order_date
    FROM "airflow"."public"."stg_orders"
),

customer_metrics AS (
    SELECT
        customer_id,
        COUNT(*) as total_orders,
        SUM(amount) as total_amount,
        MIN(order_date) as first_order_date,
        MAX(order_date) as last_order_date,
        AVG(amount) as avg_order_amount,
        -- Use PostgreSQL's date subtraction
        AVG(
            CASE 
                WHEN previous_order_date IS NOT NULL 
                THEN DATE_PART('day', order_date::timestamp - previous_order_date::timestamp)
            END
        ) as avg_days_between_orders
    FROM customer_orders
    GROUP BY customer_id
)

SELECT
    customer_id,
    total_orders,
    total_amount,
    first_order_date,
    last_order_date,
    avg_order_amount,
    avg_days_between_orders,
    CASE
        WHEN total_orders >= 10 THEN 'High'
        WHEN total_orders >= 5 THEN 'Medium'
        ELSE 'Low'
    END as frequency_segment,
    CASE
        WHEN avg_order_amount >= 200 THEN 'Premium'
        WHEN avg_order_amount >= 100 THEN 'Standard'
        ELSE 'Basic'
    END as value_segment
FROM customer_metrics
  );
  
[0m12:39:53.694287 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:39:53.694600 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:39:53.694910 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */

  
    

  create  table "airflow"."public"."fct_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', order_date) as date,
        COUNT(DISTINCT order_id) as total_orders,
        COUNT(DISTINCT customer_id) as unique_customers,
        SUM(amount) as total_amount
    FROM "airflow"."public"."stg_orders"
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT
    date,
    total_orders,
    unique_customers,
    total_amount,
    total_amount / NULLIF(total_orders, 0) as avg_order_value,
    total_amount / NULLIF(unique_customers, 0) as avg_customer_spend
FROM daily_sales
  );
  
[0m12:39:53.701251 [debug] [Thread-4  ]: SQL status: SELECT 3 in 0.0 seconds
[0m12:39:53.701621 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
[0m12:39:53.704011 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:39:53.706514 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */
alter table "airflow"."public"."fct_customer_purchase_patterns" rename to "fct_customer_purchase_patterns__dbt_backup"
[0m12:39:53.706179 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:39:53.706880 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m12:39:53.707227 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:39:53.709733 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:39:53.710294 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */
alter table "airflow"."public"."fct_customer_purchase_patterns__dbt_tmp" rename to "fct_customer_purchase_patterns"
[0m12:39:53.710026 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:39:53.712181 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:39:53.712674 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
alter table "airflow"."public"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m12:39:53.712453 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:39:53.715743 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: COMMIT
[0m12:39:53.716260 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:39:53.716523 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: COMMIT
[0m12:39:53.716034 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:39:53.717621 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:39:53.717972 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:39:53.718333 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: COMMIT
[0m12:39:53.718609 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
[0m12:39:53.720440 [debug] [Thread-4  ]: Applying DROP to: "airflow"."public"."fct_customer_purchase_patterns__dbt_backup"
[0m12:39:53.720703 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:39:53.723895 [debug] [Thread-3  ]: Applying DROP to: "airflow"."public"."fct_daily_sales__dbt_backup"
[0m12:39:53.724379 [debug] [Thread-3  ]: Using postgres connection "model.simple_dbt_project.fct_daily_sales"
[0m12:39:53.724668 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_daily_sales"} */
drop table if exists "airflow"."public"."fct_daily_sales__dbt_backup" cascade
[0m12:39:53.722281 [debug] [Thread-4  ]: Using postgres connection "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m12:39:53.725072 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.fct_customer_purchase_patterns"} */
drop table if exists "airflow"."public"."fct_customer_purchase_patterns__dbt_backup" cascade
[0m12:39:53.726897 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:39:53.727206 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:39:53.728950 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (execute): 12:39:53.684310 => 12:39:53.728820
[0m12:39:53.729224 [debug] [Thread-3  ]: On model.simple_dbt_project.fct_daily_sales: Close
[0m12:39:53.728117 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (execute): 12:39:53.666349 => 12:39:53.727974
[0m12:39:53.730166 [debug] [Thread-4  ]: On model.simple_dbt_project.fct_customer_purchase_patterns: Close
[0m12:39:53.729815 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf631fe6-80b7-4bde-a60a-580d666572d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900c5ca0>]}
[0m12:39:53.730733 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf631fe6-80b7-4bde-a60a-580d666572d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901621c0>]}
[0m12:39:53.731761 [info ] [Thread-4  ]: 3 of 4 OK created sql table model public.fct_customer_purchase_patterns ........ [[32mSELECT 3[0m in 0.07s]
[0m12:39:53.731261 [info ] [Thread-3  ]: 4 of 4 OK created sql table model public.fct_daily_sales ....................... [[32mSELECT 2[0m in 0.07s]
[0m12:39:53.732630 [debug] [Thread-3  ]: Finished running node model.simple_dbt_project.fct_daily_sales
[0m12:39:53.732234 [debug] [Thread-4  ]: Finished running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m12:39:53.733817 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:53.734109 [debug] [MainThread]: On master: BEGIN
[0m12:39:53.734368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:53.740652 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:39:53.741018 [debug] [MainThread]: On master: COMMIT
[0m12:39:53.741282 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:53.741515 [debug] [MainThread]: On master: COMMIT
[0m12:39:53.741792 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:39:53.742030 [debug] [MainThread]: On master: Close
[0m12:39:53.742508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:53.742750 [debug] [MainThread]: Connection 'model.simple_dbt_project.my_first_model' was properly closed.
[0m12:39:53.742986 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m12:39:53.743205 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_customer_purchase_patterns' was properly closed.
[0m12:39:53.743428 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_daily_sales' was properly closed.
[0m12:39:53.743722 [info ] [MainThread]: 
[0m12:39:53.744067 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m12:39:53.744844 [debug] [MainThread]: Command end result
[0m12:39:53.753257 [info ] [MainThread]: 
[0m12:39:53.753660 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:53.753949 [info ] [MainThread]: 
[0m12:39:53.754227 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:39:53.755020 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.64631957, "process_user_time": 2.265732, "process_kernel_time": 0.585189, "process_mem_max_rss": "156952", "process_out_blocks": "4206", "process_in_blocks": "0"}
[0m12:39:53.755438 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:53.755345 after 0.65 seconds
[0m12:39:53.755754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93728fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901e0220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9025e100>]}
[0m12:39:53.756085 [debug] [MainThread]: Flushing usage events
[0m12:39:59.112056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd86fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993c4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993c4d00>]}


============================== 12:39:59.121552 | 4d5ce749-a435-48e2-9c67-351530f91486 ==============================
[0m12:39:59.121552 [info ] [MainThread]: Running with dbt=1.7.3
[0m12:39:59.122121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:39:59.278598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d5ce749-a435-48e2-9c67-351530f91486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99485d90>]}
[0m12:39:59.330830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d5ce749-a435-48e2-9c67-351530f91486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff994ae970>]}
[0m12:39:59.331508 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m12:39:59.336622 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m12:39:59.362225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:59.362592 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:59.368031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d5ce749-a435-48e2-9c67-351530f91486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98505e80>]}
[0m12:39:59.380068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d5ce749-a435-48e2-9c67-351530f91486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985d3c70>]}
[0m12:39:59.380469 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m12:39:59.380766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d5ce749-a435-48e2-9c67-351530f91486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985d3df0>]}
[0m12:39:59.381777 [info ] [MainThread]: 
[0m12:39:59.382320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:59.383526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m12:39:59.391355 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:39:59.391742 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m12:39:59.391985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:59.404736 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:39:59.405283 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m12:39:59.405594 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:39:59.408385 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.0 seconds
[0m12:39:59.409688 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m12:39:59.410046 [debug] [ThreadPool]: On list_airflow_public: Close
[0m12:39:59.419617 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:59.419989 [debug] [MainThread]: On master: BEGIN
[0m12:39:59.420233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:59.422733 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:39:59.423016 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:59.423309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:59.427433 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:59.428253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d5ce749-a435-48e2-9c67-351530f91486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9880f100>]}
[0m12:39:59.428608 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:59.428943 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:59.429189 [debug] [MainThread]: On master: BEGIN
[0m12:39:59.429672 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:39:59.429922 [debug] [MainThread]: On master: COMMIT
[0m12:39:59.430145 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:59.430372 [debug] [MainThread]: On master: COMMIT
[0m12:39:59.430677 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:39:59.430914 [debug] [MainThread]: On master: Close
[0m12:39:59.431429 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:59.431766 [info ] [MainThread]: 
[0m12:39:59.439567 [debug] [Thread-1  ]: Began running node test.simple_dbt_project.not_null_stg_orders_amount.2546645448
[0m12:39:59.439926 [debug] [Thread-2  ]: Began running node test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:39:59.440443 [debug] [Thread-3  ]: Began running node test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:39:59.440741 [info ] [Thread-1  ]: 1 of 5 START test not_null_stg_orders_amount ................................... [RUN]
[0m12:39:59.441099 [debug] [Thread-4  ]: Began running node test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5
[0m12:39:59.441399 [info ] [Thread-2  ]: 2 of 5 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m12:39:59.441779 [info ] [Thread-3  ]: 3 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m12:39:59.442318 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now test.simple_dbt_project.not_null_stg_orders_amount.2546645448)
[0m12:39:59.442678 [info ] [Thread-4  ]: 4 of 5 START test positive_values_stg_orders_amount__True ...................... [RUN]
[0m12:39:59.443259 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m12:39:59.443896 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m12:39:59.444197 [debug] [Thread-1  ]: Began compiling node test.simple_dbt_project.not_null_stg_orders_amount.2546645448
[0m12:39:59.444677 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5'
[0m12:39:59.444999 [debug] [Thread-2  ]: Began compiling node test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:39:59.445369 [debug] [Thread-3  ]: Began compiling node test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:39:59.455438 [debug] [Thread-1  ]: Writing injected SQL for node "test.simple_dbt_project.not_null_stg_orders_amount.2546645448"
[0m12:39:59.455743 [debug] [Thread-4  ]: Began compiling node test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5
[0m12:39:59.458674 [debug] [Thread-2  ]: Writing injected SQL for node "test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:39:59.461433 [debug] [Thread-3  ]: Writing injected SQL for node "test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:39:59.464756 [debug] [Thread-4  ]: Writing injected SQL for node "test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5"
[0m12:39:59.466552 [debug] [Thread-1  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_amount.2546645448 (compile): 12:39:59.445603 => 12:39:59.466345
[0m12:39:59.467056 [debug] [Thread-1  ]: Began executing node test.simple_dbt_project.not_null_stg_orders_amount.2546645448
[0m12:39:59.477867 [debug] [Thread-1  ]: Writing runtime sql for node "test.simple_dbt_project.not_null_stg_orders_amount.2546645448"
[0m12:39:59.478765 [debug] [Thread-2  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 12:39:59.455985 => 12:39:59.478501
[0m12:39:59.479450 [debug] [Thread-2  ]: Began executing node test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:39:59.479969 [debug] [Thread-4  ]: Timing info for test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5 (compile): 12:39:59.461785 => 12:39:59.479715
[0m12:39:59.480557 [debug] [Thread-3  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64 (compile): 12:39:59.458937 => 12:39:59.480242
[0m12:39:59.483202 [debug] [Thread-2  ]: Writing runtime sql for node "test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:39:59.483802 [debug] [Thread-4  ]: Began executing node test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5
[0m12:39:59.484144 [debug] [Thread-3  ]: Began executing node test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:39:59.484595 [debug] [Thread-1  ]: Using postgres connection "test.simple_dbt_project.not_null_stg_orders_amount.2546645448"
[0m12:39:59.486132 [debug] [Thread-4  ]: Writing runtime sql for node "test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5"
[0m12:39:59.487615 [debug] [Thread-3  ]: Writing runtime sql for node "test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:39:59.487954 [debug] [Thread-1  ]: On test.simple_dbt_project.not_null_stg_orders_amount.2546645448: BEGIN
[0m12:39:59.488263 [debug] [Thread-2  ]: Using postgres connection "test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:39:59.488808 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:59.489284 [debug] [Thread-2  ]: On test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m12:39:59.489594 [debug] [Thread-4  ]: Using postgres connection "test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5"
[0m12:39:59.490013 [debug] [Thread-3  ]: Using postgres connection "test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:39:59.490773 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:39:59.491302 [debug] [Thread-4  ]: On test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5: BEGIN
[0m12:39:59.491736 [debug] [Thread-3  ]: On test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m12:39:59.492365 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:39:59.492979 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:39:59.494192 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:39:59.494705 [debug] [Thread-1  ]: Using postgres connection "test.simple_dbt_project.not_null_stg_orders_amount.2546645448"
[0m12:39:59.495115 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m12:39:59.495489 [debug] [Thread-1  ]: On test.simple_dbt_project.not_null_stg_orders_amount.2546645448: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "test.simple_dbt_project.not_null_stg_orders_amount.2546645448"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from "airflow"."public"."stg_orders"
where amount is null



      
    ) dbt_internal_test
[0m12:39:59.495974 [debug] [Thread-2  ]: Using postgres connection "test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:39:59.496567 [debug] [Thread-2  ]: On test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "airflow"."public"."stg_orders"
where customer_id is null



      
    ) dbt_internal_test
[0m12:39:59.497932 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:59.498488 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:59.500496 [debug] [Thread-2  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 12:39:59.480847 => 12:39:59.500332
[0m12:39:59.500823 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:39:59.501702 [debug] [Thread-1  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_amount.2546645448 (execute): 12:39:59.467425 => 12:39:59.501557
[0m12:39:59.501993 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m12:39:59.503252 [debug] [Thread-4  ]: Using postgres connection "test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5"
[0m12:39:59.502628 [debug] [Thread-3  ]: Using postgres connection "test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:39:59.502961 [debug] [Thread-1  ]: On test.simple_dbt_project.not_null_stg_orders_amount.2546645448: ROLLBACK
[0m12:39:59.502287 [debug] [Thread-2  ]: On test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m12:39:59.503544 [debug] [Thread-4  ]: On test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

-- Common interview question: implement a custom test
WITH validation AS (
    SELECT
        amount as value
    FROM "airflow"."public"."stg_orders"
    WHERE amount is not null
        
            AND amount < 0
        
)

SELECT *
FROM validation


      
    ) dbt_internal_test
[0m12:39:59.503880 [debug] [Thread-3  ]: On test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "airflow"."public"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m12:39:59.504297 [debug] [Thread-1  ]: On test.simple_dbt_project.not_null_stg_orders_amount.2546645448: Close
[0m12:39:59.504581 [debug] [Thread-2  ]: On test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m12:39:59.505384 [info ] [Thread-1  ]: 1 of 5 PASS not_null_stg_orders_amount ......................................... [[32mPASS[0m in 0.06s]
[0m12:39:59.505783 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:59.506453 [info ] [Thread-2  ]: 2 of 5 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 0.06s]
[0m12:39:59.506776 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:59.507189 [debug] [Thread-1  ]: Finished running node test.simple_dbt_project.not_null_stg_orders_amount.2546645448
[0m12:39:59.508207 [debug] [Thread-3  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64 (execute): 12:39:59.486389 => 12:39:59.508067
[0m12:39:59.508613 [debug] [Thread-2  ]: Finished running node test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:39:59.509463 [debug] [Thread-4  ]: Timing info for test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5 (execute): 12:39:59.484807 => 12:39:59.509326
[0m12:39:59.509847 [debug] [Thread-1  ]: Began running node test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m12:39:59.510193 [debug] [Thread-3  ]: On test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m12:39:59.510586 [debug] [Thread-4  ]: On test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5: ROLLBACK
[0m12:39:59.510922 [info ] [Thread-1  ]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m12:39:59.511389 [debug] [Thread-3  ]: On test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m12:39:59.511855 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.simple_dbt_project.not_null_stg_orders_amount.2546645448, now test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m12:39:59.512125 [debug] [Thread-4  ]: On test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5: Close
[0m12:39:59.512733 [info ] [Thread-3  ]: 3 of 5 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.07s]
[0m12:39:59.513090 [debug] [Thread-1  ]: Began compiling node test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m12:39:59.513754 [info ] [Thread-4  ]: 4 of 5 PASS positive_values_stg_orders_amount__True ............................ [[32mPASS[0m in 0.07s]
[0m12:39:59.514181 [debug] [Thread-3  ]: Finished running node test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:39:59.518434 [debug] [Thread-1  ]: Writing injected SQL for node "test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:39:59.518909 [debug] [Thread-4  ]: Finished running node test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5
[0m12:39:59.520041 [debug] [Thread-1  ]: Timing info for test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a (compile): 12:39:59.514443 => 12:39:59.519886
[0m12:39:59.520340 [debug] [Thread-1  ]: Began executing node test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m12:39:59.521907 [debug] [Thread-1  ]: Writing runtime sql for node "test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:39:59.522747 [debug] [Thread-1  ]: Using postgres connection "test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:39:59.523010 [debug] [Thread-1  ]: On test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m12:39:59.523251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:59.525419 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:39:59.525747 [debug] [Thread-1  ]: Using postgres connection "test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:39:59.526024 [debug] [Thread-1  ]: On test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "airflow"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:39:59.526898 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:59.527849 [debug] [Thread-1  ]: Timing info for test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a (execute): 12:39:59.520515 => 12:39:59.527704
[0m12:39:59.528138 [debug] [Thread-1  ]: On test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m12:39:59.528477 [debug] [Thread-1  ]: On test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m12:39:59.529041 [info ] [Thread-1  ]: 5 of 5 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.02s]
[0m12:39:59.529480 [debug] [Thread-1  ]: Finished running node test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m12:39:59.530537 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:59.530833 [debug] [MainThread]: On master: BEGIN
[0m12:39:59.531103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:59.533613 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:39:59.533932 [debug] [MainThread]: On master: COMMIT
[0m12:39:59.534159 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:59.534392 [debug] [MainThread]: On master: COMMIT
[0m12:39:59.534703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:39:59.534955 [debug] [MainThread]: On master: Close
[0m12:39:59.535461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:59.535712 [debug] [MainThread]: Connection 'test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m12:39:59.535941 [debug] [MainThread]: Connection 'test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5' was properly closed.
[0m12:39:59.536160 [debug] [MainThread]: Connection 'test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m12:39:59.536400 [debug] [MainThread]: Connection 'test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5' was properly closed.
[0m12:39:59.536683 [info ] [MainThread]: 
[0m12:39:59.536955 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m12:39:59.537679 [debug] [MainThread]: Command end result
[0m12:39:59.543824 [info ] [MainThread]: 
[0m12:39:59.544161 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:59.544427 [info ] [MainThread]: 
[0m12:39:59.544722 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:39:59.545405 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45922676, "process_user_time": 2.448947, "process_kernel_time": 0.294557, "process_mem_max_rss": "152304", "process_out_blocks": "1639", "process_in_blocks": "0"}
[0m12:39:59.545782 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:59.545697 after 0.46 seconds
[0m12:39:59.546063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd86fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9880f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff994ae970>]}
[0m12:39:59.546356 [debug] [MainThread]: Flushing usage events
[0m23:01:15.293667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d73ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63dbdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63db910>]}


============================== 23:01:15.308721 | d8145571-3b0b-421c-9790-38d14d73fecf ==============================
[0m23:01:15.308721 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:01:15.309204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:01:15.482942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8145571-3b0b-421c-9790-38d14d73fecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c3e370>]}
[0m23:01:15.538638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8145571-3b0b-421c-9790-38d14d73fecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63db580>]}
[0m23:01:15.539576 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m23:01:15.547322 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:01:15.580301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:01:15.580737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:01:15.584906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8145571-3b0b-421c-9790-38d14d73fecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5497df0>]}
[0m23:01:15.594777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8145571-3b0b-421c-9790-38d14d73fecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5559be0>]}
[0m23:01:15.595160 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m23:01:15.595509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8145571-3b0b-421c-9790-38d14d73fecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5559d60>]}
[0m23:01:15.596574 [info ] [MainThread]: 
[0m23:01:15.597135 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:01:15.598109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:01:15.604605 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:01:15.604920 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:01:15.605159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:15.616106 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:01:15.617591 [debug] [ThreadPool]: On list_airflow: Close
[0m23:01:15.621225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m23:01:15.628584 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:01:15.629029 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m23:01:15.629322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:15.632268 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:01:15.632747 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:01:15.633079 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:01:15.637087 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.0 seconds
[0m23:01:15.638617 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m23:01:15.639037 [debug] [ThreadPool]: On list_airflow_public: Close
[0m23:01:15.646475 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:15.646791 [debug] [MainThread]: On master: BEGIN
[0m23:01:15.647029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:15.649159 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:01:15.649468 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:15.649777 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:01:15.651832 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:01:15.652597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8145571-3b0b-421c-9790-38d14d73fecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5684820>]}
[0m23:01:15.652932 [debug] [MainThread]: On master: ROLLBACK
[0m23:01:15.653252 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:15.653518 [debug] [MainThread]: On master: BEGIN
[0m23:01:15.653872 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:01:15.654142 [debug] [MainThread]: On master: COMMIT
[0m23:01:15.654407 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:15.654637 [debug] [MainThread]: On master: COMMIT
[0m23:01:15.654924 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:01:15.655160 [debug] [MainThread]: On master: Close
[0m23:01:15.655658 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:01:15.656049 [info ] [MainThread]: 
[0m23:01:15.661151 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.my_first_model
[0m23:01:15.661489 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_orders
[0m23:01:15.661843 [info ] [Thread-1  ]: 1 of 4 START sql view model public.my_first_model .............................. [RUN]
[0m23:01:15.662318 [info ] [Thread-2  ]: 2 of 4 START sql view model public.stg_orders .................................. [RUN]
[0m23:01:15.662856 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.my_first_model)
[0m23:01:15.663305 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_airflow, now model.simple_dbt_project.stg_orders)
[0m23:01:15.663605 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.my_first_model
[0m23:01:15.663889 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m23:01:15.668432 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.my_first_model"
[0m23:01:15.670497 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m23:01:15.672540 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (compile): 23:01:15.664089 => 23:01:15.672388
[0m23:01:15.672902 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.my_first_model
[0m23:01:15.673253 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 23:01:15.668683 => 23:01:15.673096
[0m23:01:15.689341 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_orders
[0m23:01:15.694862 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.my_first_model"
[0m23:01:15.698125 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m23:01:15.699626 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:01:15.699953 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: BEGIN
[0m23:01:15.700221 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m23:01:15.700708 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m23:01:15.700973 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:01:15.700436 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:01:15.703539 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:01:15.704083 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m23:01:15.704387 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m23:01:15.703853 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:01:15.704741 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:01:15.705017 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */

  create view "airflow"."public"."my_first_model__dbt_tmp"
    
    
  as (
    -- Simple example model
SELECT 1 as id, 'Example' as name
UNION ALL
SELECT 2 as id, 'Test' as name
  );
[0m23:01:15.705339 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "raw.orders" does not exist
LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
              ^

[0m23:01:15.705675 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: ROLLBACK
[0m23:01:15.706213 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 23:01:15.695036 => 23:01:15.706041
[0m23:01:15.706540 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: Close
[0m23:01:15.707964 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:01:15.712492 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:01:15.713522 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model__dbt_tmp" rename to "my_first_model"
[0m23:01:15.714588 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:01:15.722724 [debug] [Thread-2  ]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m23:01:15.724286 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8145571-3b0b-421c-9790-38d14d73fecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4bbd610>]}
[0m23:01:15.724724 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model public.stg_orders ......................... [[31mERROR[0m in 0.06s]
[0m23:01:15.725166 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_orders
[0m23:01:15.723974 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m23:01:15.725584 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:01:15.725910 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m23:01:15.726269 [debug] [Thread-4  ]: Began running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m23:01:15.726628 [debug] [Thread-3  ]: Began running node model.simple_dbt_project.fct_daily_sales
[0m23:01:15.727037 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:01:15.727327 [info ] [Thread-4  ]: 3 of 4 SKIP relation public.fct_customer_purchase_patterns ..................... [[33mSKIP[0m]
[0m23:01:15.727724 [info ] [Thread-3  ]: 4 of 4 SKIP relation public.fct_daily_sales .................................... [[33mSKIP[0m]
[0m23:01:15.731613 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."my_first_model__dbt_backup"
[0m23:01:15.731983 [debug] [Thread-4  ]: Finished running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m23:01:15.732338 [debug] [Thread-3  ]: Finished running node model.simple_dbt_project.fct_daily_sales
[0m23:01:15.735032 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:01:15.735641 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
drop view if exists "airflow"."public"."my_first_model__dbt_backup" cascade
[0m23:01:15.736353 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:01:15.738094 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (execute): 23:01:15.673418 => 23:01:15.737906
[0m23:01:15.738481 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: Close
[0m23:01:15.739264 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8145571-3b0b-421c-9790-38d14d73fecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b8a6d0>]}
[0m23:01:15.739848 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.my_first_model ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:01:15.740639 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.my_first_model
[0m23:01:15.742069 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:15.742416 [debug] [MainThread]: On master: BEGIN
[0m23:01:15.742752 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:01:15.746354 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:01:15.746674 [debug] [MainThread]: On master: COMMIT
[0m23:01:15.746913 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:15.747151 [debug] [MainThread]: On master: COMMIT
[0m23:01:15.747478 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:01:15.747746 [debug] [MainThread]: On master: Close
[0m23:01:15.748323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:15.748636 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m23:01:15.749206 [debug] [MainThread]: Connection 'model.simple_dbt_project.my_first_model' was properly closed.
[0m23:01:15.749944 [info ] [MainThread]: 
[0m23:01:15.750710 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m23:01:15.751661 [debug] [MainThread]: Command end result
[0m23:01:15.759263 [info ] [MainThread]: 
[0m23:01:15.759673 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:01:15.759980 [info ] [MainThread]: 
[0m23:01:15.760306 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m23:01:15.760627 [info ] [MainThread]: 
[0m23:01:15.761049 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m23:01:15.762019 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.49435824, "process_user_time": 2.016578, "process_kernel_time": 0.29987, "process_mem_max_rss": "156532", "process_in_blocks": "30696", "process_out_blocks": "4162", "command_success": false}
[0m23:01:15.762497 [debug] [MainThread]: Command `dbt run` failed at 23:01:15.762391 after 0.49 seconds
[0m23:01:15.762873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d73ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5497d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56846a0>]}
[0m23:01:15.763240 [debug] [MainThread]: Flushing usage events
[0m23:06:19.494746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e46e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97481850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97481e80>]}


============================== 23:06:19.499099 | d71fc73b-17c4-4b6d-a313-b613c3a815d4 ==============================
[0m23:06:19.499099 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:06:19.499516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m23:06:19.632109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd71fc73b-17c4-4b6d-a313-b613c3a815d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974819d0>]}
[0m23:06:19.680175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd71fc73b-17c4-4b6d-a313-b613c3a815d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97544c70>]}
[0m23:06:19.680910 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m23:06:19.686880 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:06:19.709931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:06:19.710381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:06:19.714873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd71fc73b-17c4-4b6d-a313-b613c3a815d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff965fcf10>]}
[0m23:06:19.725507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd71fc73b-17c4-4b6d-a313-b613c3a815d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff966cacd0>]}
[0m23:06:19.725903 [info ] [MainThread]: Found 4 models, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m23:06:19.726201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd71fc73b-17c4-4b6d-a313-b613c3a815d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff966caeb0>]}
[0m23:06:19.727139 [info ] [MainThread]: 
[0m23:06:19.727690 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:06:19.728588 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:06:19.735181 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:06:19.735840 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:06:19.736115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:19.742940 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:06:19.744047 [debug] [ThreadPool]: On list_airflow: Close
[0m23:06:19.745361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m23:06:19.749542 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:06:19.749865 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m23:06:19.750110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:19.752245 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:06:19.752615 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:06:19.752914 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:06:19.754734 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m23:06:19.755981 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m23:06:19.756328 [debug] [ThreadPool]: On list_airflow_public: Close
[0m23:06:19.763376 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:19.763716 [debug] [MainThread]: On master: BEGIN
[0m23:06:19.763960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:06:19.765882 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:06:19.766149 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:19.766437 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:06:19.773998 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:06:19.774797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd71fc73b-17c4-4b6d-a313-b613c3a815d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96660f70>]}
[0m23:06:19.775149 [debug] [MainThread]: On master: ROLLBACK
[0m23:06:19.775465 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:19.775707 [debug] [MainThread]: On master: BEGIN
[0m23:06:19.776063 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:06:19.776325 [debug] [MainThread]: On master: COMMIT
[0m23:06:19.776553 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:19.776774 [debug] [MainThread]: On master: COMMIT
[0m23:06:19.777052 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:06:19.777277 [debug] [MainThread]: On master: Close
[0m23:06:19.777752 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:06:19.778074 [info ] [MainThread]: 
[0m23:06:19.782802 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.my_first_model
[0m23:06:19.783135 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_orders
[0m23:06:19.783496 [info ] [Thread-1  ]: 1 of 4 START sql view model public.my_first_model .............................. [RUN]
[0m23:06:19.783928 [info ] [Thread-2  ]: 2 of 4 START sql view model public.stg_orders .................................. [RUN]
[0m23:06:19.784588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.my_first_model)
[0m23:06:19.785276 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_airflow, now model.simple_dbt_project.stg_orders)
[0m23:06:19.785859 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.my_first_model
[0m23:06:19.786352 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m23:06:19.792091 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.my_first_model"
[0m23:06:19.794187 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m23:06:19.795878 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 23:06:19.792439 => 23:06:19.795729
[0m23:06:19.796175 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (compile): 23:06:19.786643 => 23:06:19.796049
[0m23:06:19.796802 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.my_first_model
[0m23:06:19.796427 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_orders
[0m23:06:19.823290 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.my_first_model"
[0m23:06:19.824133 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m23:06:19.825478 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:06:19.825817 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: BEGIN
[0m23:06:19.826077 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m23:06:19.826562 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m23:06:19.826806 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m23:06:19.826290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:06:19.829108 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:06:19.829680 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:06:19.829985 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */

  create view "airflow"."public"."my_first_model__dbt_tmp"
    
    
  as (
    -- Simple example model
SELECT 1 as id, 'Example' as name
UNION ALL
SELECT 2 as id, 'Test' as name
  );
[0m23:06:19.829428 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:06:19.830378 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m23:06:19.830747 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m23:06:19.831259 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "raw.orders" does not exist
LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
              ^

[0m23:06:19.831616 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: ROLLBACK
[0m23:06:19.832148 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 23:06:19.812721 => 23:06:19.831994
[0m23:06:19.832659 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: Close
[0m23:06:19.832411 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:06:19.834407 [debug] [Thread-2  ]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m23:06:19.839555 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71fc73b-17c4-4b6d-a313-b613c3a815d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bc1370>]}
[0m23:06:19.839997 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model public.stg_orders ......................... [[31mERROR[0m in 0.05s]
[0m23:06:19.840466 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_orders
[0m23:06:19.839127 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:06:19.840966 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model" rename to "my_first_model__dbt_backup"
[0m23:06:19.841309 [debug] [Thread-4  ]: Began running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m23:06:19.841606 [debug] [Thread-3  ]: Began running node model.simple_dbt_project.fct_daily_sales
[0m23:06:19.842016 [info ] [Thread-4  ]: 3 of 4 SKIP relation public.fct_customer_purchase_patterns ..................... [[33mSKIP[0m]
[0m23:06:19.842311 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:06:19.842674 [info ] [Thread-3  ]: 4 of 4 SKIP relation public.fct_daily_sales .................................... [[33mSKIP[0m]
[0m23:06:19.843053 [debug] [Thread-4  ]: Finished running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m23:06:19.844974 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:06:19.845341 [debug] [Thread-3  ]: Finished running node model.simple_dbt_project.fct_daily_sales
[0m23:06:19.845812 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model__dbt_tmp" rename to "my_first_model"
[0m23:06:19.846422 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:06:19.855668 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m23:06:19.855976 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:06:19.856234 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m23:06:19.857224 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:06:19.860865 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."my_first_model__dbt_backup"
[0m23:06:19.863359 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:06:19.863695 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
drop view if exists "airflow"."public"."my_first_model__dbt_backup" cascade
[0m23:06:19.866458 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:06:19.867426 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (execute): 23:06:19.796988 => 23:06:19.867295
[0m23:06:19.867729 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: Close
[0m23:06:19.868270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71fc73b-17c4-4b6d-a313-b613c3a815d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96592f70>]}
[0m23:06:19.868720 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.my_first_model ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m23:06:19.869124 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.my_first_model
[0m23:06:19.870167 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:19.870453 [debug] [MainThread]: On master: BEGIN
[0m23:06:19.870714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:06:19.872903 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:06:19.873386 [debug] [MainThread]: On master: COMMIT
[0m23:06:19.873907 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:19.874359 [debug] [MainThread]: On master: COMMIT
[0m23:06:19.874772 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:06:19.875084 [debug] [MainThread]: On master: Close
[0m23:06:19.875715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:06:19.875992 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m23:06:19.876210 [debug] [MainThread]: Connection 'model.simple_dbt_project.my_first_model' was properly closed.
[0m23:06:19.876527 [info ] [MainThread]: 
[0m23:06:19.876787 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m23:06:19.877352 [debug] [MainThread]: Command end result
[0m23:06:19.883075 [info ] [MainThread]: 
[0m23:06:19.883384 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:06:19.883712 [info ] [MainThread]: 
[0m23:06:19.884008 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m23:06:19.884290 [info ] [MainThread]: 
[0m23:06:19.884584 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m23:06:19.885155 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.41412595, "process_user_time": 1.787942, "process_kernel_time": 0.124204, "process_mem_max_rss": "151848", "process_out_blocks": "1619", "command_success": false, "process_in_blocks": "0"}
[0m23:06:19.885526 [debug] [MainThread]: Command `dbt run` failed at 23:06:19.885430 after 0.41 seconds
[0m23:06:19.885807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e46e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96446eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bd8a00>]}
[0m23:06:19.886093 [debug] [MainThread]: Flushing usage events
[0m23:56:23.598523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8396df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8101fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8101f3a0>]}


============================== 23:56:23.603098 | f2f2ab24-4438-4d29-b792-f19af46b5cb2 ==============================
[0m23:56:23.603098 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:56:23.603545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m23:56:23.779237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2f2ab24-4438-4d29-b792-f19af46b5cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827d54f0>]}
[0m23:56:23.827237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2f2ab24-4438-4d29-b792-f19af46b5cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8103eeb0>]}
[0m23:56:23.827746 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m23:56:23.833228 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:56:23.841015 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:56:23.841394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f2f2ab24-4438-4d29-b792-f19af46b5cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80320ca0>]}
[0m23:56:24.529947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2f2ab24-4438-4d29-b792-f19af46b5cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800475e0>]}
[0m23:56:24.540834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2f2ab24-4438-4d29-b792-f19af46b5cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804149a0>]}
[0m23:56:24.541327 [info ] [MainThread]: Found 4 models, 1 seed, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m23:56:24.541725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2f2ab24-4438-4d29-b792-f19af46b5cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802ebb50>]}
[0m23:56:24.542906 [info ] [MainThread]: 
[0m23:56:24.543526 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:56:24.544687 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:56:24.551918 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:56:24.552338 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:56:24.552737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:24.556598 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:56:24.557676 [debug] [ThreadPool]: On list_airflow: Close
[0m23:56:24.559524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m23:56:24.564423 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:56:24.564925 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m23:56:24.565352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:24.568692 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:56:24.569241 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:56:24.569526 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:56:24.571884 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.0 seconds
[0m23:56:24.574626 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m23:56:24.575532 [debug] [ThreadPool]: On list_airflow_public: Close
[0m23:56:24.637341 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:24.638472 [debug] [MainThread]: On master: BEGIN
[0m23:56:24.638989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:24.652298 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:24.652945 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:24.653578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:56:24.661986 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:56:24.663209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2f2ab24-4438-4d29-b792-f19af46b5cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8017feb0>]}
[0m23:56:24.663709 [debug] [MainThread]: On master: ROLLBACK
[0m23:56:24.664166 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:24.664456 [debug] [MainThread]: On master: BEGIN
[0m23:56:24.664919 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:24.665242 [debug] [MainThread]: On master: COMMIT
[0m23:56:24.665488 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:24.665701 [debug] [MainThread]: On master: COMMIT
[0m23:56:24.665986 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:56:24.666231 [debug] [MainThread]: On master: Close
[0m23:56:24.666971 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:56:24.667528 [info ] [MainThread]: 
[0m23:56:24.674051 [debug] [Thread-1  ]: Began running node seed.simple_dbt_project.sample_data
[0m23:56:24.674729 [info ] [Thread-1  ]: 1 of 1 START seed file public.sample_data ...................................... [RUN]
[0m23:56:24.675446 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now seed.simple_dbt_project.sample_data)
[0m23:56:24.675758 [debug] [Thread-1  ]: Began compiling node seed.simple_dbt_project.sample_data
[0m23:56:24.676103 [debug] [Thread-1  ]: Timing info for seed.simple_dbt_project.sample_data (compile): 23:56:24.675954 => 23:56:24.675956
[0m23:56:24.676397 [debug] [Thread-1  ]: Began executing node seed.simple_dbt_project.sample_data
[0m23:56:24.694278 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m23:56:24.694717 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: BEGIN
[0m23:56:24.695019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:56:24.698059 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:56:24.698571 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m23:56:24.698849 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.simple_dbt_project.sample_data"} */

    create table "airflow"."public"."sample_data" ("id" integer,"name" text,"country" text)
  
[0m23:56:24.704699 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m23:56:24.721241 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m23:56:24.721881 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: 
          insert into "airflow"."public"."sample_data" ("id", "name", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m23:56:24.722641 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
[0m23:56:24.727459 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.simple_dbt_project.sample_data"
[0m23:56:24.739552 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: COMMIT
[0m23:56:24.740306 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m23:56:24.740643 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: COMMIT
[0m23:56:24.741401 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:56:24.742348 [debug] [Thread-1  ]: Timing info for seed.simple_dbt_project.sample_data (execute): 23:56:24.676570 => 23:56:24.742179
[0m23:56:24.742706 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: Close
[0m23:56:24.743448 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2f2ab24-4438-4d29-b792-f19af46b5cb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5fffa0>]}
[0m23:56:24.744019 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.sample_data .................................. [[32mINSERT 3[0m in 0.07s]
[0m23:56:24.744730 [debug] [Thread-1  ]: Finished running node seed.simple_dbt_project.sample_data
[0m23:56:24.746123 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:24.746425 [debug] [MainThread]: On master: BEGIN
[0m23:56:24.746657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:56:24.749590 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:24.749960 [debug] [MainThread]: On master: COMMIT
[0m23:56:24.750209 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:24.750442 [debug] [MainThread]: On master: COMMIT
[0m23:56:24.750794 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:56:24.751035 [debug] [MainThread]: On master: Close
[0m23:56:24.751635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:24.751994 [debug] [MainThread]: Connection 'seed.simple_dbt_project.sample_data' was properly closed.
[0m23:56:24.752328 [info ] [MainThread]: 
[0m23:56:24.752653 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m23:56:24.753204 [debug] [MainThread]: Command end result
[0m23:56:24.762686 [info ] [MainThread]: 
[0m23:56:24.763117 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:56:24.763729 [info ] [MainThread]: 
[0m23:56:24.764191 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:56:24.765330 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.1910999, "process_user_time": 2.621731, "process_kernel_time": 0.344778, "process_mem_max_rss": "129892", "process_in_blocks": "136", "process_out_blocks": "4072"}
[0m23:56:24.765942 [debug] [MainThread]: Command `dbt seed` succeeded at 23:56:24.765834 after 1.19 seconds
[0m23:56:24.766285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8396df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804149a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802eba60>]}
[0m23:56:24.766653 [debug] [MainThread]: Flushing usage events
[0m23:56:33.147514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d029fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a642790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a642d00>]}


============================== 23:56:33.151563 | 75275c1a-4af5-4283-9b3a-fa6588bf7661 ==============================
[0m23:56:33.151563 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:56:33.152022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:56:33.300130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75275c1a-4af5-4283-9b3a-fa6588bf7661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a705d60>]}
[0m23:56:33.348954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75275c1a-4af5-4283-9b3a-fa6588bf7661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a729970>]}
[0m23:56:33.349596 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m23:56:33.354903 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:56:33.379192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:56:33.379635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:56:33.386109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75275c1a-4af5-4283-9b3a-fa6588bf7661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997c3460>]}
[0m23:56:33.397964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75275c1a-4af5-4283-9b3a-fa6588bf7661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99883250>]}
[0m23:56:33.398356 [info ] [MainThread]: Found 4 models, 1 seed, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m23:56:33.398672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75275c1a-4af5-4283-9b3a-fa6588bf7661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99883160>]}
[0m23:56:33.399825 [info ] [MainThread]: 
[0m23:56:33.400434 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:56:33.401381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m23:56:33.409958 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m23:56:33.410368 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m23:56:33.410610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:33.418818 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:56:33.419911 [debug] [ThreadPool]: On list_airflow: Close
[0m23:56:33.421457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m23:56:33.427079 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:56:33.427548 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m23:56:33.427806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:33.430780 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:56:33.431255 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:56:33.431550 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:56:33.434034 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m23:56:33.435311 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m23:56:33.435677 [debug] [ThreadPool]: On list_airflow_public: Close
[0m23:56:33.443435 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:33.443881 [debug] [MainThread]: On master: BEGIN
[0m23:56:33.444175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:33.446765 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:33.447069 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:33.447355 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:56:33.451511 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:56:33.452289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75275c1a-4af5-4283-9b3a-fa6588bf7661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9979e970>]}
[0m23:56:33.452618 [debug] [MainThread]: On master: ROLLBACK
[0m23:56:33.452941 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:33.453177 [debug] [MainThread]: On master: BEGIN
[0m23:56:33.453541 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:33.453770 [debug] [MainThread]: On master: COMMIT
[0m23:56:33.453981 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:33.454207 [debug] [MainThread]: On master: COMMIT
[0m23:56:33.454494 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:56:33.454750 [debug] [MainThread]: On master: Close
[0m23:56:33.455248 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:56:33.455593 [info ] [MainThread]: 
[0m23:56:33.461737 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.my_first_model
[0m23:56:33.462113 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_orders
[0m23:56:33.462462 [info ] [Thread-1  ]: 1 of 4 START sql view model public.my_first_model .............................. [RUN]
[0m23:56:33.462940 [info ] [Thread-2  ]: 2 of 4 START sql view model public.stg_orders .................................. [RUN]
[0m23:56:33.463753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.my_first_model)
[0m23:56:33.464314 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.simple_dbt_project.stg_orders'
[0m23:56:33.464614 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.my_first_model
[0m23:56:33.464924 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m23:56:33.469551 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.my_first_model"
[0m23:56:33.471700 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m23:56:33.472975 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (compile): 23:56:33.465161 => 23:56:33.472720
[0m23:56:33.473468 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.my_first_model
[0m23:56:33.481805 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 23:56:33.469829 => 23:56:33.481498
[0m23:56:33.494534 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_orders
[0m23:56:33.501465 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.my_first_model"
[0m23:56:33.505072 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m23:56:33.506298 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:56:33.506797 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: BEGIN
[0m23:56:33.507139 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m23:56:33.507667 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m23:56:33.507912 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:56:33.507363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:56:33.511090 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:56:33.511697 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:56:33.511970 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */

  create view "airflow"."public"."my_first_model__dbt_tmp"
    
    
  as (
    -- Simple example model
SELECT 1 as id, 'Example' as name
UNION ALL
SELECT 2 as id, 'Test' as name
  );
[0m23:56:33.511471 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:56:33.512436 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m23:56:33.512909 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m23:56:33.513538 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "raw.orders" does not exist
LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
              ^

[0m23:56:33.513860 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: ROLLBACK
[0m23:56:33.514125 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:56:33.514522 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 23:56:33.501647 => 23:56:33.514381
[0m23:56:33.519458 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_orders: Close
[0m23:56:33.519098 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:56:33.522219 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model" rename to "my_first_model__dbt_backup"
[0m23:56:33.521924 [debug] [Thread-2  ]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m23:56:33.522944 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75275c1a-4af5-4283-9b3a-fa6588bf7661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d60340>]}
[0m23:56:33.523685 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model public.stg_orders ......................... [[31mERROR[0m in 0.06s]
[0m23:56:33.524154 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_orders
[0m23:56:33.523290 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:56:33.526677 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:56:33.527076 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
alter table "airflow"."public"."my_first_model__dbt_tmp" rename to "my_first_model"
[0m23:56:33.527399 [debug] [Thread-4  ]: Began running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m23:56:33.527714 [debug] [Thread-3  ]: Began running node model.simple_dbt_project.fct_daily_sales
[0m23:56:33.528031 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:56:33.528356 [info ] [Thread-4  ]: 3 of 4 SKIP relation public.fct_customer_purchase_patterns ..................... [[33mSKIP[0m]
[0m23:56:33.528702 [info ] [Thread-3  ]: 4 of 4 SKIP relation public.fct_daily_sales .................................... [[33mSKIP[0m]
[0m23:56:33.539169 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m23:56:33.539744 [debug] [Thread-4  ]: Finished running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m23:56:33.540131 [debug] [Thread-3  ]: Finished running node model.simple_dbt_project.fct_daily_sales
[0m23:56:33.540467 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:56:33.541112 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: COMMIT
[0m23:56:33.541946 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:56:33.547087 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."my_first_model__dbt_backup"
[0m23:56:33.551372 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.my_first_model"
[0m23:56:33.552157 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.my_first_model"} */
drop view if exists "airflow"."public"."my_first_model__dbt_backup" cascade
[0m23:56:33.569136 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m23:56:33.593878 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (execute): 23:56:33.473776 => 23:56:33.593304
[0m23:56:33.594445 [debug] [Thread-1  ]: On model.simple_dbt_project.my_first_model: Close
[0m23:56:33.595256 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75275c1a-4af5-4283-9b3a-fa6588bf7661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d99580>]}
[0m23:56:33.596071 [info ] [Thread-1  ]: 1 of 4 OK created sql view model public.my_first_model ......................... [[32mCREATE VIEW[0m in 0.13s]
[0m23:56:33.596774 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.my_first_model
[0m23:56:33.598340 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:33.598795 [debug] [MainThread]: On master: BEGIN
[0m23:56:33.599065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:56:33.602537 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:33.603198 [debug] [MainThread]: On master: COMMIT
[0m23:56:33.608085 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:33.609491 [debug] [MainThread]: On master: COMMIT
[0m23:56:33.611318 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:56:33.611864 [debug] [MainThread]: On master: Close
[0m23:56:33.612518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:33.612900 [debug] [MainThread]: Connection 'model.simple_dbt_project.my_first_model' was properly closed.
[0m23:56:33.613192 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m23:56:33.613522 [info ] [MainThread]: 
[0m23:56:33.613808 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m23:56:33.614822 [debug] [MainThread]: Command end result
[0m23:56:33.624066 [info ] [MainThread]: 
[0m23:56:33.624543 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:56:33.625081 [info ] [MainThread]: 
[0m23:56:33.625753 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m23:56:33.626107 [info ] [MainThread]: 
[0m23:56:33.626640 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m23:56:33.627380 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5049553, "process_user_time": 1.94969, "process_kernel_time": 0.216296, "process_mem_max_rss": "123344", "process_out_blocks": "1627", "command_success": false, "process_in_blocks": "0"}
[0m23:56:33.627821 [debug] [MainThread]: Command `dbt run` failed at 23:56:33.627721 after 0.51 seconds
[0m23:56:33.628156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d029fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999c2430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997c3b80>]}
[0m23:56:33.628480 [debug] [MainThread]: Flushing usage events
[0m23:56:55.528302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1b1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c805760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c805e50>]}


============================== 23:56:55.532845 | 89ccf4e3-30a2-4261-8a8c-726a73aff481 ==============================
[0m23:56:55.532845 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:56:55.533345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m23:56:55.688090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89ccf4e3-30a2-4261-8a8c-726a73aff481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c8c5e50>]}
[0m23:56:55.740579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89ccf4e3-30a2-4261-8a8c-726a73aff481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b17790>]}
[0m23:56:55.741454 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m23:56:55.747464 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:56:55.775047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:56:55.775635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:56:55.780519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89ccf4e3-30a2-4261-8a8c-726a73aff481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b98f430>]}
[0m23:56:55.792573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89ccf4e3-30a2-4261-8a8c-726a73aff481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba4f220>]}
[0m23:56:55.793021 [info ] [MainThread]: Found 4 models, 1 seed, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m23:56:55.793373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ccf4e3-30a2-4261-8a8c-726a73aff481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb790a0>]}
[0m23:56:55.794927 [info ] [MainThread]: 
[0m23:56:55.795754 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:56:55.796975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m23:56:55.804905 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:56:55.805303 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m23:56:55.805563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:55.811088 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:56:55.811656 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:56:55.811994 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:56:55.815099 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m23:56:55.817083 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m23:56:55.818012 [debug] [ThreadPool]: On list_airflow_public: Close
[0m23:56:55.827765 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:55.828257 [debug] [MainThread]: On master: BEGIN
[0m23:56:55.828601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:55.831156 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:55.831499 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:55.831775 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:56:55.835667 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:56:55.836485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ccf4e3-30a2-4261-8a8c-726a73aff481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba4f340>]}
[0m23:56:55.836899 [debug] [MainThread]: On master: ROLLBACK
[0m23:56:55.837263 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:55.837522 [debug] [MainThread]: On master: BEGIN
[0m23:56:55.837915 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:55.838155 [debug] [MainThread]: On master: COMMIT
[0m23:56:55.838378 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:55.838662 [debug] [MainThread]: On master: COMMIT
[0m23:56:55.839042 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:56:55.839371 [debug] [MainThread]: On master: Close
[0m23:56:55.840037 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:56:55.840387 [info ] [MainThread]: 
[0m23:56:55.846296 [debug] [Thread-1  ]: Began running node test.simple_dbt_project.not_null_stg_orders_amount.2546645448
[0m23:56:55.846681 [debug] [Thread-2  ]: Began running node test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:56:55.846973 [debug] [Thread-3  ]: Began running node test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m23:56:55.847250 [info ] [Thread-1  ]: 1 of 5 START test not_null_stg_orders_amount ................................... [RUN]
[0m23:56:55.847646 [debug] [Thread-4  ]: Began running node test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5
[0m23:56:55.848050 [info ] [Thread-2  ]: 2 of 5 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m23:56:55.848537 [info ] [Thread-3  ]: 3 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m23:56:55.849218 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now test.simple_dbt_project.not_null_stg_orders_amount.2546645448)
[0m23:56:55.849685 [info ] [Thread-4  ]: 4 of 5 START test positive_values_stg_orders_amount__True ...................... [RUN]
[0m23:56:55.850359 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m23:56:55.851048 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m23:56:55.851393 [debug] [Thread-1  ]: Began compiling node test.simple_dbt_project.not_null_stg_orders_amount.2546645448
[0m23:56:55.851958 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5'
[0m23:56:55.852329 [debug] [Thread-2  ]: Began compiling node test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:56:55.852687 [debug] [Thread-3  ]: Began compiling node test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m23:56:55.866366 [debug] [Thread-1  ]: Writing injected SQL for node "test.simple_dbt_project.not_null_stg_orders_amount.2546645448"
[0m23:56:55.866768 [debug] [Thread-4  ]: Began compiling node test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5
[0m23:56:55.870465 [debug] [Thread-2  ]: Writing injected SQL for node "test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:55.873238 [debug] [Thread-3  ]: Writing injected SQL for node "test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:55.878009 [debug] [Thread-4  ]: Writing injected SQL for node "test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5"
[0m23:56:55.880438 [debug] [Thread-1  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_amount.2546645448 (compile): 23:56:55.852899 => 23:56:55.880051
[0m23:56:55.880939 [debug] [Thread-1  ]: Began executing node test.simple_dbt_project.not_null_stg_orders_amount.2546645448
[0m23:56:55.891451 [debug] [Thread-1  ]: Writing runtime sql for node "test.simple_dbt_project.not_null_stg_orders_amount.2546645448"
[0m23:56:55.892482 [debug] [Thread-2  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 23:56:55.867161 => 23:56:55.892284
[0m23:56:55.892891 [debug] [Thread-3  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64 (compile): 23:56:55.870829 => 23:56:55.892722
[0m23:56:55.893340 [debug] [Thread-4  ]: Timing info for test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5 (compile): 23:56:55.873903 => 23:56:55.893181
[0m23:56:55.893632 [debug] [Thread-2  ]: Began executing node test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:56:55.894037 [debug] [Thread-3  ]: Began executing node test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m23:56:55.894443 [debug] [Thread-4  ]: Began executing node test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5
[0m23:56:55.896194 [debug] [Thread-2  ]: Writing runtime sql for node "test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:55.896522 [debug] [Thread-1  ]: Using postgres connection "test.simple_dbt_project.not_null_stg_orders_amount.2546645448"
[0m23:56:55.898039 [debug] [Thread-3  ]: Writing runtime sql for node "test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:55.899519 [debug] [Thread-4  ]: Writing runtime sql for node "test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5"
[0m23:56:55.900048 [debug] [Thread-1  ]: On test.simple_dbt_project.not_null_stg_orders_amount.2546645448: BEGIN
[0m23:56:55.900875 [debug] [Thread-2  ]: Using postgres connection "test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:55.901267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:56:55.901610 [debug] [Thread-2  ]: On test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m23:56:55.902177 [debug] [Thread-3  ]: Using postgres connection "test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:55.902605 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m23:56:55.902914 [debug] [Thread-4  ]: Using postgres connection "test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5"
[0m23:56:55.903253 [debug] [Thread-3  ]: On test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m23:56:55.903800 [debug] [Thread-4  ]: On test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5: BEGIN
[0m23:56:55.904339 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m23:56:55.904740 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:56:55.905031 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m23:56:55.905826 [debug] [Thread-1  ]: Using postgres connection "test.simple_dbt_project.not_null_stg_orders_amount.2546645448"
[0m23:56:55.906794 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m23:56:55.907263 [debug] [Thread-1  ]: On test.simple_dbt_project.not_null_stg_orders_amount.2546645448: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "test.simple_dbt_project.not_null_stg_orders_amount.2546645448"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select amount
from "airflow"."public"."stg_orders"
where amount is null



      
    ) dbt_internal_test
[0m23:56:55.907696 [debug] [Thread-2  ]: Using postgres connection "test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:55.908213 [debug] [Thread-2  ]: On test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "airflow"."public"."stg_orders"
where customer_id is null



      
    ) dbt_internal_test
[0m23:56:55.908635 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m23:56:55.908930 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.stg_orders" does not exist
LINE 14: from "airflow"."public"."stg_orders"
              ^

[0m23:56:55.909392 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
[0m23:56:55.910587 [debug] [Thread-4  ]: Using postgres connection "test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5"
[0m23:56:55.909941 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "public.stg_orders" does not exist
LINE 14: from "airflow"."public"."stg_orders"
              ^

[0m23:56:55.910295 [debug] [Thread-1  ]: On test.simple_dbt_project.not_null_stg_orders_amount.2546645448: ROLLBACK
[0m23:56:55.909682 [debug] [Thread-3  ]: Using postgres connection "test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:55.911561 [debug] [Thread-3  ]: On test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "airflow"."public"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m23:56:55.911191 [debug] [Thread-2  ]: On test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m23:56:55.910878 [debug] [Thread-4  ]: On test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

-- Common interview question: implement a custom test
WITH validation AS (
    SELECT
        amount as value
    FROM "airflow"."public"."stg_orders"
    WHERE amount is not null
        
            AND amount < 0
        
)

SELECT *
FROM validation


      
    ) dbt_internal_test
[0m23:56:55.911943 [debug] [Thread-1  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_amount.2546645448 (execute): 23:56:55.881224 => 23:56:55.911800
[0m23:56:55.912452 [debug] [Thread-2  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 23:56:55.894729 => 23:56:55.912311
[0m23:56:55.912714 [debug] [Thread-3  ]: Postgres adapter: Postgres error: relation "public.stg_orders" does not exist
LINE 14: from "airflow"."public"."stg_orders"
              ^

[0m23:56:55.913061 [debug] [Thread-1  ]: On test.simple_dbt_project.not_null_stg_orders_amount.2546645448: Close
[0m23:56:55.913363 [debug] [Thread-4  ]: Postgres adapter: Postgres error: relation "public.stg_orders" does not exist
LINE 13:     FROM "airflow"."public"."stg_orders"
                  ^

[0m23:56:55.913623 [debug] [Thread-2  ]: On test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m23:56:55.913916 [debug] [Thread-3  ]: On test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m23:56:55.914645 [debug] [Thread-4  ]: On test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5: ROLLBACK
[0m23:56:55.915693 [debug] [Thread-3  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64 (execute): 23:56:55.896747 => 23:56:55.915538
[0m23:56:55.916710 [debug] [Thread-3  ]: On test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m23:56:55.916466 [debug] [Thread-4  ]: Timing info for test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5 (execute): 23:56:55.898250 => 23:56:55.916310
[0m23:56:55.918412 [debug] [Thread-4  ]: On test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5: Close
[0m23:56:55.919577 [debug] [Thread-1  ]: Database Error in test not_null_stg_orders_amount (models/staging/schema.yml)
  relation "public.stg_orders" does not exist
  LINE 14: from "airflow"."public"."stg_orders"
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/schema.yml/not_null_stg_orders_amount.sql
[0m23:56:55.920391 [debug] [Thread-3  ]: Database Error in test not_null_stg_orders_order_id (models/staging/schema.yml)
  relation "public.stg_orders" does not exist
  LINE 14: from "airflow"."public"."stg_orders"
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/schema.yml/not_null_stg_orders_order_id.sql
[0m23:56:55.920808 [error] [Thread-1  ]: 1 of 5 ERROR not_null_stg_orders_amount ........................................ [[31mERROR[0m in 0.07s]
[0m23:56:55.921349 [debug] [Thread-2  ]: Database Error in test not_null_stg_orders_customer_id (models/staging/schema.yml)
  relation "public.stg_orders" does not exist
  LINE 14: from "airflow"."public"."stg_orders"
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/schema.yml/not_null_stg_orders_customer_id.sql
[0m23:56:55.921824 [debug] [Thread-4  ]: Database Error in test positive_values_stg_orders_amount__True (models/staging/schema.yml)
  relation "public.stg_orders" does not exist
  LINE 13:     FROM "airflow"."public"."stg_orders"
                    ^
  compiled Code at target/run/simple_dbt_project/models/staging/schema.yml/positive_values_stg_orders_amount__True.sql
[0m23:56:55.922242 [error] [Thread-3  ]: 3 of 5 ERROR not_null_stg_orders_order_id ...................................... [[31mERROR[0m in 0.07s]
[0m23:56:55.922792 [debug] [Thread-1  ]: Finished running node test.simple_dbt_project.not_null_stg_orders_amount.2546645448
[0m23:56:55.923178 [error] [Thread-2  ]: 2 of 5 ERROR not_null_stg_orders_customer_id ................................... [[31mERROR[0m in 0.07s]
[0m23:56:55.923637 [error] [Thread-4  ]: 4 of 5 ERROR positive_values_stg_orders_amount__True ........................... [[31mERROR[0m in 0.07s]
[0m23:56:55.924156 [debug] [Thread-3  ]: Finished running node test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m23:56:55.924578 [debug] [Thread-1  ]: Began running node test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m23:56:55.925033 [debug] [Thread-2  ]: Finished running node test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:56:55.925419 [debug] [Thread-4  ]: Finished running node test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5
[0m23:56:55.925821 [info ] [Thread-1  ]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m23:56:55.926691 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.simple_dbt_project.not_null_stg_orders_amount.2546645448, now test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m23:56:55.927011 [debug] [Thread-1  ]: Began compiling node test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m23:56:55.931580 [debug] [Thread-1  ]: Writing injected SQL for node "test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m23:56:55.932754 [debug] [Thread-1  ]: Timing info for test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a (compile): 23:56:55.927217 => 23:56:55.932603
[0m23:56:55.933041 [debug] [Thread-1  ]: Began executing node test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m23:56:55.934681 [debug] [Thread-1  ]: Writing runtime sql for node "test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m23:56:55.935668 [debug] [Thread-1  ]: Using postgres connection "test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m23:56:55.935952 [debug] [Thread-1  ]: On test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m23:56:55.936231 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:56:55.938399 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:56:55.938708 [debug] [Thread-1  ]: Using postgres connection "test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m23:56:55.938998 [debug] [Thread-1  ]: On test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "airflow"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:56:55.939533 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.stg_orders" does not exist
LINE 15: from "airflow"."public"."stg_orders"
              ^

[0m23:56:55.939844 [debug] [Thread-1  ]: On test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m23:56:55.940316 [debug] [Thread-1  ]: Timing info for test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a (execute): 23:56:55.933220 => 23:56:55.940156
[0m23:56:55.940617 [debug] [Thread-1  ]: On test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m23:56:55.941568 [debug] [Thread-1  ]: Database Error in test unique_stg_orders_order_id (models/staging/schema.yml)
  relation "public.stg_orders" does not exist
  LINE 15: from "airflow"."public"."stg_orders"
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/schema.yml/unique_stg_orders_order_id.sql
[0m23:56:55.942030 [error] [Thread-1  ]: 5 of 5 ERROR unique_stg_orders_order_id ........................................ [[31mERROR[0m in 0.02s]
[0m23:56:55.942607 [debug] [Thread-1  ]: Finished running node test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m23:56:55.944303 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:55.944680 [debug] [MainThread]: On master: BEGIN
[0m23:56:55.944942 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:56:55.948448 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:55.948904 [debug] [MainThread]: On master: COMMIT
[0m23:56:55.949223 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:55.949811 [debug] [MainThread]: On master: COMMIT
[0m23:56:55.950155 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:56:55.950564 [debug] [MainThread]: On master: Close
[0m23:56:55.951801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:55.952240 [debug] [MainThread]: Connection 'test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m23:56:55.952548 [debug] [MainThread]: Connection 'test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5' was properly closed.
[0m23:56:55.952781 [debug] [MainThread]: Connection 'test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m23:56:55.952995 [debug] [MainThread]: Connection 'test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5' was properly closed.
[0m23:56:55.953253 [info ] [MainThread]: 
[0m23:56:55.953554 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m23:56:55.954428 [debug] [MainThread]: Command end result
[0m23:56:55.962566 [info ] [MainThread]: 
[0m23:56:55.963077 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m23:56:55.963574 [info ] [MainThread]: 
[0m23:56:55.963979 [error] [MainThread]:   Database Error in test not_null_stg_orders_amount (models/staging/schema.yml)
  relation "public.stg_orders" does not exist
  LINE 14: from "airflow"."public"."stg_orders"
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/schema.yml/not_null_stg_orders_amount.sql
[0m23:56:55.964438 [info ] [MainThread]: 
[0m23:56:55.964941 [error] [MainThread]:   Database Error in test not_null_stg_orders_order_id (models/staging/schema.yml)
  relation "public.stg_orders" does not exist
  LINE 14: from "airflow"."public"."stg_orders"
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/schema.yml/not_null_stg_orders_order_id.sql
[0m23:56:55.965638 [info ] [MainThread]: 
[0m23:56:55.965996 [error] [MainThread]:   Database Error in test not_null_stg_orders_customer_id (models/staging/schema.yml)
  relation "public.stg_orders" does not exist
  LINE 14: from "airflow"."public"."stg_orders"
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/schema.yml/not_null_stg_orders_customer_id.sql
[0m23:56:55.966327 [info ] [MainThread]: 
[0m23:56:55.966724 [error] [MainThread]:   Database Error in test positive_values_stg_orders_amount__True (models/staging/schema.yml)
  relation "public.stg_orders" does not exist
  LINE 13:     FROM "airflow"."public"."stg_orders"
                    ^
  compiled Code at target/run/simple_dbt_project/models/staging/schema.yml/positive_values_stg_orders_amount__True.sql
[0m23:56:55.967113 [info ] [MainThread]: 
[0m23:56:55.968147 [error] [MainThread]:   Database Error in test unique_stg_orders_order_id (models/staging/schema.yml)
  relation "public.stg_orders" does not exist
  LINE 15: from "airflow"."public"."stg_orders"
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/schema.yml/unique_stg_orders_order_id.sql
[0m23:56:55.969150 [info ] [MainThread]: 
[0m23:56:55.970236 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m23:56:55.971691 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.4694343, "process_user_time": 1.877438, "process_kernel_time": 0.192839, "process_mem_max_rss": "122416", "process_in_blocks": "16", "process_out_blocks": "1658", "command_success": false}
[0m23:56:55.972218 [debug] [MainThread]: Command `dbt test` failed at 23:56:55.972091 after 0.47 seconds
[0m23:56:55.972878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1b1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b17790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb795e0>]}
[0m23:56:55.973292 [debug] [MainThread]: Flushing usage events
[0m23:57:05.105841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9429bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b3f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b3fdc0>]}


============================== 23:57:05.109636 | 177a30d0-22b9-4a93-bed6-70462130028c ==============================
[0m23:57:05.109636 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:57:05.110104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:57:05.251290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '177a30d0-22b9-4a93-bed6-70462130028c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8284100>]}
[0m23:57:05.300218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '177a30d0-22b9-4a93-bed6-70462130028c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5e5e520>]}
[0m23:57:05.300928 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m23:57:05.306229 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m23:57:05.329638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:57:05.330149 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:57:05.335967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '177a30d0-22b9-4a93-bed6-70462130028c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5bd15b0>]}
[0m23:57:05.338055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '177a30d0-22b9-4a93-bed6-70462130028c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c912b0>]}
[0m23:57:05.338379 [info ] [MainThread]: Found 4 models, 1 seed, 5 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m23:57:05.338674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '177a30d0-22b9-4a93-bed6-70462130028c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c91370>]}
[0m23:57:05.339936 [info ] [MainThread]: 
[0m23:57:05.341305 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:57:05.342713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m23:57:05.350780 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:57:05.351150 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m23:57:05.351446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:05.355598 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:57:05.355932 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m23:57:05.356173 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:57:05.358556 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m23:57:05.360037 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m23:57:05.360554 [debug] [ThreadPool]: On list_airflow_public: Close
[0m23:57:05.370606 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:05.371003 [debug] [MainThread]: On master: BEGIN
[0m23:57:05.371233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:57:05.374516 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:57:05.375096 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:05.375491 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:57:05.379854 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:57:05.380886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '177a30d0-22b9-4a93-bed6-70462130028c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5edb040>]}
[0m23:57:05.381248 [debug] [MainThread]: On master: ROLLBACK
[0m23:57:05.381629 [debug] [MainThread]: On master: Close
[0m23:57:05.382128 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:57:05.382544 [info ] [MainThread]: 
[0m23:57:05.388096 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.my_first_model
[0m23:57:05.388457 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_orders
[0m23:57:05.388735 [debug] [Thread-3  ]: Began running node seed.simple_dbt_project.sample_data
[0m23:57:05.391165 [debug] [Thread-3  ]: Acquiring new postgres connection 'seed.simple_dbt_project.sample_data'
[0m23:57:05.390217 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.simple_dbt_project.stg_orders'
[0m23:57:05.389153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.my_first_model)
[0m23:57:05.391651 [debug] [Thread-3  ]: Began compiling node seed.simple_dbt_project.sample_data
[0m23:57:05.392020 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m23:57:05.392364 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.my_first_model
[0m23:57:05.397422 [debug] [Thread-3  ]: Timing info for seed.simple_dbt_project.sample_data (compile): 23:57:05.392602 => 23:57:05.397202
[0m23:57:05.400137 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m23:57:05.401447 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.my_first_model"
[0m23:57:05.401781 [debug] [Thread-3  ]: Began executing node seed.simple_dbt_project.sample_data
[0m23:57:05.402490 [debug] [Thread-3  ]: Timing info for seed.simple_dbt_project.sample_data (execute): 23:57:05.402340 => 23:57:05.402351
[0m23:57:05.403142 [debug] [Thread-3  ]: Finished running node seed.simple_dbt_project.sample_data
[0m23:57:05.403815 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (compile): 23:57:05.400449 => 23:57:05.403683
[0m23:57:05.404119 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 23:57:05.397733 => 23:57:05.403994
[0m23:57:05.404368 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.my_first_model
[0m23:57:05.404977 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.my_first_model (execute): 23:57:05.404853 => 23:57:05.404859
[0m23:57:05.405489 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.my_first_model
[0m23:57:05.404656 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_orders
[0m23:57:05.405846 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 23:57:05.405730 => 23:57:05.405733
[0m23:57:05.406339 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_orders
[0m23:57:05.407202 [debug] [Thread-4  ]: Began running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m23:57:05.407724 [debug] [Thread-3  ]: Began running node model.simple_dbt_project.fct_daily_sales
[0m23:57:05.408011 [debug] [Thread-1  ]: Began running node test.simple_dbt_project.not_null_stg_orders_amount.2546645448
[0m23:57:05.409939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.simple_dbt_project.my_first_model, now test.simple_dbt_project.not_null_stg_orders_amount.2546645448)
[0m23:57:05.408905 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.simple_dbt_project.fct_customer_purchase_patterns'
[0m23:57:05.409443 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.simple_dbt_project.sample_data, now model.simple_dbt_project.fct_daily_sales)
[0m23:57:05.408255 [debug] [Thread-2  ]: Began running node test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:57:05.410257 [debug] [Thread-1  ]: Began compiling node test.simple_dbt_project.not_null_stg_orders_amount.2546645448
[0m23:57:05.410636 [debug] [Thread-4  ]: Began compiling node model.simple_dbt_project.fct_customer_purchase_patterns
[0m23:57:05.410954 [debug] [Thread-3  ]: Began compiling node model.simple_dbt_project.fct_daily_sales
[0m23:57:05.411430 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.simple_dbt_project.stg_orders, now test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m23:57:05.421447 [debug] [Thread-1  ]: Writing injected SQL for node "test.simple_dbt_project.not_null_stg_orders_amount.2546645448"
[0m23:57:05.424148 [debug] [Thread-4  ]: Writing injected SQL for node "model.simple_dbt_project.fct_customer_purchase_patterns"
[0m23:57:05.426874 [debug] [Thread-3  ]: Writing injected SQL for node "model.simple_dbt_project.fct_daily_sales"
[0m23:57:05.427357 [debug] [Thread-2  ]: Began compiling node test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:57:05.431541 [debug] [Thread-2  ]: Writing injected SQL for node "test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:57:05.432358 [debug] [Thread-1  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_amount.2546645448 (compile): 23:57:05.411689 => 23:57:05.432151
[0m23:57:05.432807 [debug] [Thread-1  ]: Began executing node test.simple_dbt_project.not_null_stg_orders_amount.2546645448
[0m23:57:05.433229 [debug] [Thread-1  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_amount.2546645448 (execute): 23:57:05.433049 => 23:57:05.433059
[0m23:57:05.433891 [debug] [Thread-1  ]: Finished running node test.simple_dbt_project.not_null_stg_orders_amount.2546645448
[0m23:57:05.434319 [debug] [Thread-1  ]: Began running node test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m23:57:05.434642 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (compile): 23:57:05.424678 => 23:57:05.434487
[0m23:57:05.434985 [debug] [Thread-2  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 23:57:05.428047 => 23:57:05.434826
[0m23:57:05.435457 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.simple_dbt_project.not_null_stg_orders_amount.2546645448, now test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m23:57:05.435770 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (compile): 23:57:05.421719 => 23:57:05.435627
[0m23:57:05.436109 [debug] [Thread-3  ]: Began executing node model.simple_dbt_project.fct_daily_sales
[0m23:57:05.436475 [debug] [Thread-2  ]: Began executing node test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:57:05.436779 [debug] [Thread-1  ]: Began compiling node test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m23:57:05.437069 [debug] [Thread-4  ]: Began executing node model.simple_dbt_project.fct_customer_purchase_patterns
[0m23:57:05.437408 [debug] [Thread-3  ]: Timing info for model.simple_dbt_project.fct_daily_sales (execute): 23:57:05.437253 => 23:57:05.437258
[0m23:57:05.437713 [debug] [Thread-2  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 23:57:05.437591 => 23:57:05.437595
[0m23:57:05.441505 [debug] [Thread-1  ]: Writing injected SQL for node "test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:57:05.442042 [debug] [Thread-4  ]: Timing info for model.simple_dbt_project.fct_customer_purchase_patterns (execute): 23:57:05.441870 => 23:57:05.441881
[0m23:57:05.442687 [debug] [Thread-3  ]: Finished running node model.simple_dbt_project.fct_daily_sales
[0m23:57:05.443219 [debug] [Thread-2  ]: Finished running node test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:57:05.444015 [debug] [Thread-4  ]: Finished running node model.simple_dbt_project.fct_customer_purchase_patterns
[0m23:57:05.444409 [debug] [Thread-3  ]: Began running node test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5
[0m23:57:05.445858 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.simple_dbt_project.fct_daily_sales, now test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5)
[0m23:57:05.445415 [debug] [Thread-1  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64 (compile): 23:57:05.437912 => 23:57:05.445232
[0m23:57:05.444860 [debug] [Thread-2  ]: Began running node test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m23:57:05.446139 [debug] [Thread-3  ]: Began compiling node test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5
[0m23:57:05.446441 [debug] [Thread-1  ]: Began executing node test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m23:57:05.446887 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.simple_dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m23:57:05.451241 [debug] [Thread-3  ]: Writing injected SQL for node "test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5"
[0m23:57:05.451662 [debug] [Thread-1  ]: Timing info for test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64 (execute): 23:57:05.451516 => 23:57:05.451524
[0m23:57:05.451962 [debug] [Thread-2  ]: Began compiling node test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m23:57:05.452675 [debug] [Thread-1  ]: Finished running node test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m23:57:05.457028 [debug] [Thread-2  ]: Writing injected SQL for node "test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m23:57:05.457770 [debug] [Thread-3  ]: Timing info for test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5 (compile): 23:57:05.447109 => 23:57:05.457601
[0m23:57:05.458143 [debug] [Thread-3  ]: Began executing node test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5
[0m23:57:05.458477 [debug] [Thread-3  ]: Timing info for test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5 (execute): 23:57:05.458346 => 23:57:05.458352
[0m23:57:05.459092 [debug] [Thread-3  ]: Finished running node test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5
[0m23:57:05.459465 [debug] [Thread-2  ]: Timing info for test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a (compile): 23:57:05.452927 => 23:57:05.459328
[0m23:57:05.459731 [debug] [Thread-2  ]: Began executing node test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m23:57:05.460018 [debug] [Thread-2  ]: Timing info for test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a (execute): 23:57:05.459899 => 23:57:05.459903
[0m23:57:05.460552 [debug] [Thread-2  ]: Finished running node test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m23:57:05.461361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:05.461624 [debug] [MainThread]: Connection 'test.simple_dbt_project.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m23:57:05.461850 [debug] [MainThread]: Connection 'test.simple_dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m23:57:05.462047 [debug] [MainThread]: Connection 'test.simple_dbt_project.positive_values_stg_orders_amount__True.08bc5288e5' was properly closed.
[0m23:57:05.462238 [debug] [MainThread]: Connection 'model.simple_dbt_project.fct_customer_purchase_patterns' was properly closed.
[0m23:57:05.463197 [debug] [MainThread]: Command end result
[0m23:57:05.475918 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:57:05.476245 [info ] [MainThread]: Building catalog
[0m23:57:05.477569 [debug] [ThreadPool]: Acquiring new postgres connection 'airflow.information_schema'
[0m23:57:05.482148 [debug] [ThreadPool]: Using postgres connection "airflow.information_schema"
[0m23:57:05.482745 [debug] [ThreadPool]: On airflow.information_schema: BEGIN
[0m23:57:05.483117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:05.486083 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:57:05.486487 [debug] [ThreadPool]: Using postgres connection "airflow.information_schema"
[0m23:57:05.486818 [debug] [ThreadPool]: On airflow.information_schema: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "airflow.information_schema"} */

    
    

    select
        'airflow' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sample_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_daily_sales')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('my_first_model')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_customer_purchase_patterns')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:57:05.492822 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m23:57:05.495321 [debug] [ThreadPool]: On airflow.information_schema: ROLLBACK
[0m23:57:05.496032 [debug] [ThreadPool]: On airflow.information_schema: Close
[0m23:57:05.505105 [info ] [MainThread]: Catalog written to /opt/airflow/dbt_project/target/catalog.json
[0m23:57:05.505872 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.42395258, "process_user_time": 1.868756, "process_kernel_time": 0.167336, "process_mem_max_rss": "122240", "process_in_blocks": "2944", "process_out_blocks": "4612"}
[0m23:57:05.506297 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:57:05.506200 after 0.42 seconds
[0m23:57:05.506868 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:57:05.507213 [debug] [MainThread]: Connection 'airflow.information_schema' was properly closed.
[0m23:57:05.507593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9429bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5da81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5e209a0>]}
[0m23:57:05.508017 [debug] [MainThread]: Flushing usage events
[0m23:57:14.777545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991cefa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96800790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96800d00>]}


============================== 23:57:14.781668 | 7d6f1036-9919-4c0c-8169-1e58d44d7247 ==============================
[0m23:57:14.781668 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:57:14.782221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --profiles-dir . --port 8081', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:57:14.921458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d6f1036-9919-4c0c-8169-1e58d44d7247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980449d0>]}
[0m23:57:14.971386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d6f1036-9919-4c0c-8169-1e58d44d7247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968e6fd0>]}
[0m00:26:22.850794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ecabf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2c47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2c4e50>]}


============================== 00:26:22.854996 | 21c5da95-0a50-4fce-9238-e7f6ab4792a1 ==============================
[0m00:26:22.854996 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:26:22.855478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --profiles-dir . --select tag:reference --full-refresh', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:26:23.004441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21c5da95-0a50-4fce-9238-e7f6ab4792a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db647c0>]}
[0m00:26:23.053784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21c5da95-0a50-4fce-9238-e7f6ab4792a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b6bf940>]}
[0m00:26:23.054406 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m00:26:23.062358 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:26:23.070482 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:26:23.070842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21c5da95-0a50-4fce-9238-e7f6ab4792a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b74b100>]}
[0m00:26:23.769304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21c5da95-0a50-4fce-9238-e7f6ab4792a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4aaa30>]}
[0m00:26:23.781797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21c5da95-0a50-4fce-9238-e7f6ab4792a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4a7f70>]}
[0m00:26:23.782357 [info ] [MainThread]: Found 6 models, 1 seed, 15 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m00:26:23.782806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21c5da95-0a50-4fce-9238-e7f6ab4792a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4aa940>]}
[0m00:26:23.784104 [info ] [MainThread]: 
[0m00:26:23.784962 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:26:23.786030 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:26:23.792785 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:26:23.793221 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:26:23.793612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:23.798172 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:26:23.799211 [debug] [ThreadPool]: On list_airflow: Close
[0m00:26:23.801273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public_marts)
[0m00:26:23.805632 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m00:26:23.806354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m00:26:23.806783 [debug] [ThreadPool]: On list_airflow_public_marts: BEGIN
[0m00:26:23.807232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public_staging'
[0m00:26:23.808942 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:26:23.809336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:26:23.810789 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m00:26:23.811141 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m00:26:23.811673 [debug] [ThreadPool]: On list_airflow_public_staging: BEGIN
[0m00:26:23.812054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:23.812400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:23.813885 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:26:23.814387 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m00:26:23.814736 [debug] [ThreadPool]: On list_airflow_public_marts: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_marts"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m00:26:23.815247 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:26:23.815568 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:26:23.815855 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:26:23.816196 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m00:26:23.816555 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:26:23.816946 [debug] [ThreadPool]: On list_airflow_public_staging: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:26:23.817447 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:26:23.818386 [debug] [ThreadPool]: On list_airflow_public_marts: ROLLBACK
[0m00:26:23.818694 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m00:26:23.818993 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:26:23.819263 [debug] [ThreadPool]: On list_airflow_public_marts: Close
[0m00:26:23.820564 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m00:26:23.821388 [debug] [ThreadPool]: On list_airflow_public_staging: ROLLBACK
[0m00:26:23.822227 [debug] [ThreadPool]: On list_airflow_public: Close
[0m00:26:23.822533 [debug] [ThreadPool]: On list_airflow_public_staging: Close
[0m00:26:23.831781 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:23.832263 [debug] [MainThread]: On master: BEGIN
[0m00:26:23.832532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:26:23.835271 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:26:23.835659 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:23.835970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:26:23.840928 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:26:23.842050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21c5da95-0a50-4fce-9238-e7f6ab4792a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4958e0>]}
[0m00:26:23.842439 [debug] [MainThread]: On master: ROLLBACK
[0m00:26:23.842791 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:23.843036 [debug] [MainThread]: On master: BEGIN
[0m00:26:23.843418 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:26:23.843699 [debug] [MainThread]: On master: COMMIT
[0m00:26:23.843961 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:23.844191 [debug] [MainThread]: On master: COMMIT
[0m00:26:23.844504 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:26:23.844817 [debug] [MainThread]: On master: Close
[0m00:26:23.845347 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:26:23.845874 [info ] [MainThread]: 
[0m00:26:23.851174 [debug] [Thread-1  ]: Began running node seed.simple_dbt_project.sample_data
[0m00:26:23.851683 [info ] [Thread-1  ]: 1 of 1 START seed file public.sample_data ...................................... [RUN]
[0m00:26:23.852252 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public_marts, now seed.simple_dbt_project.sample_data)
[0m00:26:23.852608 [debug] [Thread-1  ]: Began compiling node seed.simple_dbt_project.sample_data
[0m00:26:23.852966 [debug] [Thread-1  ]: Timing info for seed.simple_dbt_project.sample_data (compile): 00:26:23.852820 => 00:26:23.852822
[0m00:26:23.853274 [debug] [Thread-1  ]: Began executing node seed.simple_dbt_project.sample_data
[0m00:26:23.872836 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."sample_data"
[0m00:26:23.875473 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m00:26:23.875782 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.simple_dbt_project.sample_data"} */
drop table if exists "airflow"."public"."sample_data" cascade
[0m00:26:23.876052 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:26:23.880943 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m00:26:23.885783 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m00:26:23.886137 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: BEGIN
[0m00:26:23.886590 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:26:23.886915 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m00:26:23.887230 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.simple_dbt_project.sample_data"} */

    create table "airflow"."public"."sample_data" ("id" integer,"name" text,"country" text)
  
[0m00:26:23.890011 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m00:26:23.902770 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m00:26:23.903344 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: 
          insert into "airflow"."public"."sample_data" ("id", "name", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m00:26:23.904164 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
[0m00:26:23.908176 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.simple_dbt_project.sample_data"
[0m00:26:23.926112 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: COMMIT
[0m00:26:23.926557 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m00:26:23.926842 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: COMMIT
[0m00:26:23.928642 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m00:26:23.929350 [debug] [Thread-1  ]: Timing info for seed.simple_dbt_project.sample_data (execute): 00:26:23.853501 => 00:26:23.929195
[0m00:26:23.929644 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: Close
[0m00:26:23.930210 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21c5da95-0a50-4fce-9238-e7f6ab4792a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab63d30>]}
[0m00:26:23.930625 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.sample_data .................................. [[32mCREATE 3[0m in 0.08s]
[0m00:26:23.931049 [debug] [Thread-1  ]: Finished running node seed.simple_dbt_project.sample_data
[0m00:26:23.932141 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:23.932435 [debug] [MainThread]: On master: BEGIN
[0m00:26:23.932670 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:26:23.934549 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:26:23.934888 [debug] [MainThread]: On master: COMMIT
[0m00:26:23.935136 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:23.935377 [debug] [MainThread]: On master: COMMIT
[0m00:26:23.935696 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:26:23.935938 [debug] [MainThread]: On master: Close
[0m00:26:23.936389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:26:23.936638 [debug] [MainThread]: Connection 'seed.simple_dbt_project.sample_data' was properly closed.
[0m00:26:23.936853 [debug] [MainThread]: Connection 'list_airflow_public' was properly closed.
[0m00:26:23.937063 [debug] [MainThread]: Connection 'list_airflow_public_staging' was properly closed.
[0m00:26:23.937312 [info ] [MainThread]: 
[0m00:26:23.937568 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m00:26:23.938026 [debug] [MainThread]: Command end result
[0m00:26:23.944920 [info ] [MainThread]: 
[0m00:26:23.945263 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:26:23.945598 [info ] [MainThread]: 
[0m00:26:23.945901 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:26:23.946489 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.1214632, "process_user_time": 2.522491, "process_kernel_time": 0.278274, "process_mem_max_rss": "152104", "process_out_blocks": "2570", "process_in_blocks": "0"}
[0m00:26:23.946860 [debug] [MainThread]: Command `dbt seed` succeeded at 00:26:23.946774 after 1.12 seconds
[0m00:26:23.947140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ecabf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4a7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b610100>]}
[0m00:26:23.947437 [debug] [MainThread]: Flushing usage events
[0m00:26:27.644074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff964d3bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b41cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b41fd0>]}


============================== 00:26:27.649384 | cab7b3ed-296e-4888-97f4-3548e4412bd9 ==============================
[0m00:26:27.649384 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:26:27.649886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . --select tag:staging --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:26:27.795325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cab7b3ed-296e-4888-97f4-3548e4412bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b03f70>]}
[0m00:26:27.844776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cab7b3ed-296e-4888-97f4-3548e4412bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93bf4ee0>]}
[0m00:26:27.845342 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m00:26:27.851118 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:26:27.873315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:26:27.873653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:26:27.877865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cab7b3ed-296e-4888-97f4-3548e4412bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c96b50>]}
[0m00:26:27.888686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cab7b3ed-296e-4888-97f4-3548e4412bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d51940>]}
[0m00:26:27.889047 [info ] [MainThread]: Found 6 models, 1 seed, 15 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m00:26:27.889350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cab7b3ed-296e-4888-97f4-3548e4412bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d51b20>]}
[0m00:26:27.890185 [info ] [MainThread]: 
[0m00:26:27.890724 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:26:27.891662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:26:27.899162 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:26:27.899490 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:26:27.899730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:27.905680 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:26:27.906572 [debug] [ThreadPool]: On list_airflow: Close
[0m00:26:27.907519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_public_staging)
[0m00:26:27.908370 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "public_staging"
"
[0m00:26:27.911663 [debug] [ThreadPool]: Using postgres connection "create_airflow_public_staging"
[0m00:26:27.911941 [debug] [ThreadPool]: On create_airflow_public_staging: BEGIN
[0m00:26:27.912180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:26:27.914358 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:26:27.914704 [debug] [ThreadPool]: Using postgres connection "create_airflow_public_staging"
[0m00:26:27.914967 [debug] [ThreadPool]: On create_airflow_public_staging: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_public_staging"} */
create schema if not exists "public_staging"
[0m00:26:27.916012 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m00:26:27.916614 [debug] [ThreadPool]: On create_airflow_public_staging: COMMIT
[0m00:26:27.916861 [debug] [ThreadPool]: Using postgres connection "create_airflow_public_staging"
[0m00:26:27.917092 [debug] [ThreadPool]: On create_airflow_public_staging: COMMIT
[0m00:26:27.917583 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m00:26:27.917827 [debug] [ThreadPool]: On create_airflow_public_staging: Close
[0m00:26:27.919183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_public_staging, now list_airflow_public)
[0m00:26:27.923022 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:26:27.923543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public_marts'
[0m00:26:27.923871 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m00:26:27.924353 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public_staging'
[0m00:26:27.925768 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m00:26:27.926073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:26:27.927442 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m00:26:27.927749 [debug] [ThreadPool]: On list_airflow_public_marts: BEGIN
[0m00:26:27.928232 [debug] [ThreadPool]: On list_airflow_public_staging: BEGIN
[0m00:26:27.928632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:27.928949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:27.932507 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:26:27.932938 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:26:27.933551 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:26:27.934982 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:26:27.935467 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m00:26:27.936020 [debug] [ThreadPool]: On list_airflow_public_marts: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_marts"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m00:26:27.936589 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:26:27.937262 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m00:26:27.937634 [debug] [ThreadPool]: On list_airflow_public_staging: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:26:27.938847 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:26:27.939145 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m00:26:27.940000 [debug] [ThreadPool]: On list_airflow_public_marts: ROLLBACK
[0m00:26:27.940319 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:26:27.941387 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m00:26:27.942186 [debug] [ThreadPool]: On list_airflow_public_staging: ROLLBACK
[0m00:26:27.942435 [debug] [ThreadPool]: On list_airflow_public_marts: Close
[0m00:26:27.942805 [debug] [ThreadPool]: On list_airflow_public: Close
[0m00:26:27.943119 [debug] [ThreadPool]: On list_airflow_public_staging: Close
[0m00:26:27.953359 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:27.953806 [debug] [MainThread]: On master: BEGIN
[0m00:26:27.954063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:26:27.956262 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:26:27.956573 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:27.956863 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:26:27.961800 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:26:27.962709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cab7b3ed-296e-4888-97f4-3548e4412bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b59dc0>]}
[0m00:26:27.963057 [debug] [MainThread]: On master: ROLLBACK
[0m00:26:27.963420 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:27.963696 [debug] [MainThread]: On master: BEGIN
[0m00:26:27.964149 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:26:27.964456 [debug] [MainThread]: On master: COMMIT
[0m00:26:27.964759 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:27.965079 [debug] [MainThread]: On master: COMMIT
[0m00:26:27.965463 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:26:27.965739 [debug] [MainThread]: On master: Close
[0m00:26:27.966269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:26:27.966634 [info ] [MainThread]: 
[0m00:26:27.971873 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.stg_orders
[0m00:26:27.972228 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_sample_data
[0m00:26:27.972615 [info ] [Thread-1  ]: 1 of 2 START sql view model public_staging.stg_orders .......................... [RUN]
[0m00:26:27.973036 [info ] [Thread-2  ]: 2 of 2 START sql view model public_staging.stg_sample_data ..................... [RUN]
[0m00:26:27.973611 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.stg_orders)
[0m00:26:27.974071 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_airflow_public_staging, now model.simple_dbt_project.stg_sample_data)
[0m00:26:27.974387 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m00:26:27.974699 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_sample_data
[0m00:26:27.980524 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m00:26:27.983257 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_sample_data"
[0m00:26:27.984960 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 00:26:27.974904 => 00:26:27.984761
[0m00:26:27.985354 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.stg_orders
[0m00:26:27.985710 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_sample_data (compile): 00:26:27.980905 => 00:26:27.985563
[0m00:26:28.000538 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_sample_data
[0m00:26:28.011829 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_sample_data"
[0m00:26:28.012334 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m00:26:28.013522 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:26:28.013856 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: BEGIN
[0m00:26:28.014191 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:26:28.014516 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m00:26:28.015008 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m00:26:28.015382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:26:28.017434 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m00:26:28.017836 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:26:28.018426 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */

  create view "airflow"."public_staging"."stg_sample_data__dbt_tmp"
    
    
  as (
    

SELECT
    id::integer as user_id,
    name as full_name,
    country as country_code,
    current_timestamp as loaded_at
FROM "airflow"."public"."sample_data"
  );
[0m00:26:28.018098 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:26:28.018922 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m00:26:28.019367 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m00:26:28.019968 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw.orders" does not exist
LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
              ^

[0m00:26:28.020392 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: ROLLBACK
[0m00:26:28.020995 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 00:26:27.985880 => 00:26:28.020799
[0m00:26:28.021319 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: Close
[0m00:26:28.023136 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:26:28.025490 [debug] [Thread-1  ]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m00:26:28.030918 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab7b3ed-296e-4888-97f4-3548e4412bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92bbb7c0>]}
[0m00:26:28.031431 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model public_staging.stg_orders ................. [[31mERROR[0m in 0.06s]
[0m00:26:28.031968 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.stg_orders
[0m00:26:28.030388 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:26:28.032415 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
alter table "airflow"."public_staging"."stg_sample_data__dbt_tmp" rename to "stg_sample_data"
[0m00:26:28.033072 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:26:28.042363 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: COMMIT
[0m00:26:28.042717 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:26:28.043000 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: COMMIT
[0m00:26:28.043856 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m00:26:28.048736 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public_staging"."stg_sample_data__dbt_backup"
[0m00:26:28.053024 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:26:28.053819 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
drop view if exists "airflow"."public_staging"."stg_sample_data__dbt_backup" cascade
[0m00:26:28.055533 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:26:28.056976 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_sample_data (execute): 00:26:28.007740 => 00:26:28.056835
[0m00:26:28.057312 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: Close
[0m00:26:28.058046 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab7b3ed-296e-4888-97f4-3548e4412bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a3dd90>]}
[0m00:26:28.058549 [info ] [Thread-2  ]: 2 of 2 OK created sql view model public_staging.stg_sample_data ................ [[32mCREATE VIEW[0m in 0.08s]
[0m00:26:28.059134 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_sample_data
[0m00:26:28.060244 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:28.060542 [debug] [MainThread]: On master: BEGIN
[0m00:26:28.060782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:26:28.063854 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:26:28.064270 [debug] [MainThread]: On master: COMMIT
[0m00:26:28.064544 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:28.064782 [debug] [MainThread]: On master: COMMIT
[0m00:26:28.065074 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:26:28.065339 [debug] [MainThread]: On master: Close
[0m00:26:28.065836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:26:28.066089 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m00:26:28.066339 [debug] [MainThread]: Connection 'list_airflow_public_marts' was properly closed.
[0m00:26:28.066640 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_sample_data' was properly closed.
[0m00:26:28.066939 [info ] [MainThread]: 
[0m00:26:28.067219 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m00:26:28.067779 [debug] [MainThread]: Command end result
[0m00:26:28.074653 [info ] [MainThread]: 
[0m00:26:28.074973 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:26:28.075239 [info ] [MainThread]: 
[0m00:26:28.075520 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m00:26:28.075763 [info ] [MainThread]: 
[0m00:26:28.076058 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:26:28.076687 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4587287, "process_user_time": 2.074576, "process_kernel_time": 0.137038, "process_mem_max_rss": "152116", "process_out_blocks": "1770", "command_success": false, "process_in_blocks": "0"}
[0m00:26:28.077036 [debug] [MainThread]: Command `dbt run` failed at 00:26:28.076959 after 0.46 seconds
[0m00:26:28.077323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff964d3bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b03f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a9dd90>]}
[0m00:26:28.077605 [debug] [MainThread]: Flushing usage events
[0m00:31:31.612634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f51bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f581cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f581fd0>]}


============================== 00:31:31.617090 | 38698784-4274-4b0e-bef2-8240d8851e4f ==============================
[0m00:31:31.617090 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:31:31.617532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir . --select tag:staging --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:31:31.759557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38698784-4274-4b0e-bef2-8240d8851e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f645f70>]}
[0m00:31:31.827998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38698784-4274-4b0e-bef2-8240d8851e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f574ee0>]}
[0m00:31:31.829186 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m00:31:31.835289 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:31:31.865699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:31:31.867376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:31:31.873895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38698784-4274-4b0e-bef2-8240d8851e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e72cb50>]}
[0m00:31:31.909755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38698784-4274-4b0e-bef2-8240d8851e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7eb940>]}
[0m00:31:31.910448 [info ] [MainThread]: Found 6 models, 1 seed, 15 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m00:31:31.911333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38698784-4274-4b0e-bef2-8240d8851e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7ebb20>]}
[0m00:31:31.913837 [info ] [MainThread]: 
[0m00:31:31.914887 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:31.919974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:31:31.930757 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:31:31.931169 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:31:31.931428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:31.941373 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m00:31:31.942505 [debug] [ThreadPool]: On list_airflow: Close
[0m00:31:31.945818 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m00:31:31.950461 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:31:31.950999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public_staging)
[0m00:31:31.951554 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m00:31:31.952121 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public_marts'
[0m00:31:31.953634 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m00:31:31.953999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:31.958153 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m00:31:31.958573 [debug] [ThreadPool]: On list_airflow_public_staging: BEGIN
[0m00:31:31.959129 [debug] [ThreadPool]: On list_airflow_public_marts: BEGIN
[0m00:31:31.960045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:31.959708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:31.962615 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:31:31.963225 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:31:31.963653 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:31:31.964096 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:31:31.964485 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:31:31.965181 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m00:31:31.965533 [debug] [ThreadPool]: On list_airflow_public_staging: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:31:31.964722 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m00:31:31.966055 [debug] [ThreadPool]: On list_airflow_public_marts: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_marts"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m00:31:31.967800 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m00:31:31.968203 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:31.968436 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:31:31.969723 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m00:31:31.970696 [debug] [ThreadPool]: On list_airflow_public_staging: ROLLBACK
[0m00:31:31.971432 [debug] [ThreadPool]: On list_airflow_public_marts: ROLLBACK
[0m00:31:31.973473 [debug] [ThreadPool]: On list_airflow_public_staging: Close
[0m00:31:31.973728 [debug] [ThreadPool]: On list_airflow_public: Close
[0m00:31:31.973957 [debug] [ThreadPool]: On list_airflow_public_marts: Close
[0m00:31:31.983188 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:31.983607 [debug] [MainThread]: On master: BEGIN
[0m00:31:31.983866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:31.986338 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:31:31.986728 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:31.987050 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:31:31.992138 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m00:31:31.993481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38698784-4274-4b0e-bef2-8240d8851e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8f4520>]}
[0m00:31:31.993940 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:31.994363 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:31.994636 [debug] [MainThread]: On master: BEGIN
[0m00:31:31.995114 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:31:31.995395 [debug] [MainThread]: On master: COMMIT
[0m00:31:31.995674 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:31.995910 [debug] [MainThread]: On master: COMMIT
[0m00:31:31.996243 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:31:31.996556 [debug] [MainThread]: On master: Close
[0m00:31:31.997160 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:31:31.997578 [info ] [MainThread]: 
[0m00:31:32.003058 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.stg_orders
[0m00:31:32.003465 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_sample_data
[0m00:31:32.003865 [info ] [Thread-1  ]: 1 of 2 START sql view model public_staging.stg_orders .......................... [RUN]
[0m00:31:32.004303 [info ] [Thread-2  ]: 2 of 2 START sql view model public_staging.stg_sample_data ..................... [RUN]
[0m00:31:32.004931 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public_marts, now model.simple_dbt_project.stg_orders)
[0m00:31:32.005433 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.stg_sample_data)
[0m00:31:32.005779 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m00:31:32.006083 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_sample_data
[0m00:31:32.012625 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m00:31:32.014951 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_sample_data"
[0m00:31:32.017212 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_sample_data (compile): 00:31:32.012973 => 00:31:32.016928
[0m00:31:32.017662 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_sample_data
[0m00:31:32.018018 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 00:31:32.006313 => 00:31:32.017849
[0m00:31:32.036568 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.stg_orders
[0m00:31:32.041369 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_sample_data"
[0m00:31:32.043874 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m00:31:32.045444 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:31:32.046166 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: BEGIN
[0m00:31:32.046486 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:31:32.045901 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m00:31:32.047578 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m00:31:32.048541 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:31:32.050760 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m00:31:32.051300 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:31:32.051703 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */

  create view "airflow"."public_staging"."stg_sample_data__dbt_tmp"
    
    
  as (
    

SELECT
    id::integer as user_id,
    name as full_name,
    country as country_code,
    current_timestamp as loaded_at
FROM "airflow"."public"."sample_data"
  );
[0m00:31:32.052158 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:31:32.052600 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m00:31:32.052984 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m00:31:32.053573 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw.orders" does not exist
LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
              ^

[0m00:31:32.054174 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: ROLLBACK
[0m00:31:32.053890 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:31:32.054698 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 00:31:32.041602 => 00:31:32.054513
[0m00:31:32.059728 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: Close
[0m00:31:32.059308 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:31:32.061904 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
alter table "airflow"."public_staging"."stg_sample_data" rename to "stg_sample_data__dbt_backup"
[0m00:31:32.061630 [debug] [Thread-1  ]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m00:31:32.062329 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38698784-4274-4b0e-bef2-8240d8851e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc41670>]}
[0m00:31:32.063008 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model public_staging.stg_orders ................. [[31mERROR[0m in 0.06s]
[0m00:31:32.063468 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.stg_orders
[0m00:31:32.062629 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:31:32.065718 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:31:32.066167 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
alter table "airflow"."public_staging"."stg_sample_data__dbt_tmp" rename to "stg_sample_data"
[0m00:31:32.066760 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:31:32.076166 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: COMMIT
[0m00:31:32.076484 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:31:32.076747 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: COMMIT
[0m00:31:32.077457 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m00:31:32.081927 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public_staging"."stg_sample_data__dbt_backup"
[0m00:31:32.084465 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:31:32.084776 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
drop view if exists "airflow"."public_staging"."stg_sample_data__dbt_backup" cascade
[0m00:31:32.086172 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:31:32.087235 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_sample_data (execute): 00:31:32.018235 => 00:31:32.087079
[0m00:31:32.087570 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: Close
[0m00:31:32.088172 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38698784-4274-4b0e-bef2-8240d8851e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddcbdf0>]}
[0m00:31:32.088655 [info ] [Thread-2  ]: 2 of 2 OK created sql view model public_staging.stg_sample_data ................ [[32mCREATE VIEW[0m in 0.08s]
[0m00:31:32.089168 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_sample_data
[0m00:31:32.090423 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:32.090736 [debug] [MainThread]: On master: BEGIN
[0m00:31:32.090990 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:32.093341 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:31:32.093681 [debug] [MainThread]: On master: COMMIT
[0m00:31:32.093920 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:32.094137 [debug] [MainThread]: On master: COMMIT
[0m00:31:32.094413 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:31:32.094646 [debug] [MainThread]: On master: Close
[0m00:31:32.095084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:32.095343 [debug] [MainThread]: Connection 'list_airflow_public_staging' was properly closed.
[0m00:31:32.095579 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_sample_data' was properly closed.
[0m00:31:32.095791 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m00:31:32.096040 [info ] [MainThread]: 
[0m00:31:32.096294 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m00:31:32.096820 [debug] [MainThread]: Command end result
[0m00:31:32.102886 [info ] [MainThread]: 
[0m00:31:32.103209 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:31:32.103496 [info ] [MainThread]: 
[0m00:31:32.103747 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m00:31:32.104008 [info ] [MainThread]: 
[0m00:31:32.104269 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:31:32.104889 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.51735085, "process_user_time": 1.856161, "process_kernel_time": 0.160446, "process_mem_max_rss": "152108", "process_out_blocks": "1767", "command_success": false, "process_in_blocks": "0"}
[0m00:31:32.105300 [debug] [MainThread]: Command `dbt run` failed at 00:31:32.105211 after 0.52 seconds
[0m00:31:32.105598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f51bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f645f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e617e50>]}
[0m00:31:32.105888 [debug] [MainThread]: Flushing usage events
[0m00:36:35.783738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d14dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7c1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7c1c10>]}


============================== 00:36:35.787766 | 117d3c8a-ede7-4823-984c-5751b1728d88 ==============================
[0m00:36:35.787766 [info ] [MainThread]: Running with dbt=1.7.3
[0m00:36:35.788429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir . --select tag:staging --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:36:35.924447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '117d3c8a-ede7-4823-984c-5751b1728d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c214430>]}
[0m00:36:35.974312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '117d3c8a-ede7-4823-984c-5751b1728d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b95970>]}
[0m00:36:35.974849 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m00:36:35.980646 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m00:36:36.004997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:36:36.005321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:36:36.009464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '117d3c8a-ede7-4823-984c-5751b1728d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9992cb80>]}
[0m00:36:36.020798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '117d3c8a-ede7-4823-984c-5751b1728d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999e7940>]}
[0m00:36:36.021179 [info ] [MainThread]: Found 6 models, 1 seed, 15 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m00:36:36.021459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '117d3c8a-ede7-4823-984c-5751b1728d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999e7ac0>]}
[0m00:36:36.022296 [info ] [MainThread]: 
[0m00:36:36.022816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:36:36.023632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:36:36.030204 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:36:36.030502 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:36:36.030757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:36:36.036428 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m00:36:36.037368 [debug] [ThreadPool]: On list_airflow: Close
[0m00:36:36.038827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public_staging'
[0m00:36:36.042815 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m00:36:36.043282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public_marts)
[0m00:36:36.043720 [debug] [ThreadPool]: On list_airflow_public_staging: BEGIN
[0m00:36:36.044232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m00:36:36.045499 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m00:36:36.045809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:36:36.047207 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:36:36.047501 [debug] [ThreadPool]: On list_airflow_public_marts: BEGIN
[0m00:36:36.047957 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m00:36:36.048300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:36:36.048669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:36:36.050996 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:36:36.051551 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m00:36:36.051924 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:36:36.052224 [debug] [ThreadPool]: On list_airflow_public_staging: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m00:36:36.052620 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m00:36:36.052935 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:36:36.053325 [debug] [ThreadPool]: On list_airflow_public_marts: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_marts"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m00:36:36.053686 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:36:36.054103 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:36:36.055351 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m00:36:36.056557 [debug] [ThreadPool]: On list_airflow_public_staging: ROLLBACK
[0m00:36:36.056904 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:36:36.057198 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m00:36:36.057955 [debug] [ThreadPool]: On list_airflow_public_marts: ROLLBACK
[0m00:36:36.058226 [debug] [ThreadPool]: On list_airflow_public_staging: Close
[0m00:36:36.059319 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m00:36:36.059724 [debug] [ThreadPool]: On list_airflow_public_marts: Close
[0m00:36:36.060635 [debug] [ThreadPool]: On list_airflow_public: Close
[0m00:36:36.068515 [debug] [MainThread]: Using postgres connection "master"
[0m00:36:36.068852 [debug] [MainThread]: On master: BEGIN
[0m00:36:36.069095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:36:36.071471 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:36:36.071780 [debug] [MainThread]: Using postgres connection "master"
[0m00:36:36.072083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:36:36.076664 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m00:36:36.077614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '117d3c8a-ede7-4823-984c-5751b1728d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99880790>]}
[0m00:36:36.078014 [debug] [MainThread]: On master: ROLLBACK
[0m00:36:36.078391 [debug] [MainThread]: Using postgres connection "master"
[0m00:36:36.078647 [debug] [MainThread]: On master: BEGIN
[0m00:36:36.079063 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:36:36.079310 [debug] [MainThread]: On master: COMMIT
[0m00:36:36.079549 [debug] [MainThread]: Using postgres connection "master"
[0m00:36:36.079818 [debug] [MainThread]: On master: COMMIT
[0m00:36:36.080148 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:36:36.080413 [debug] [MainThread]: On master: Close
[0m00:36:36.080964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:36:36.081339 [info ] [MainThread]: 
[0m00:36:36.087123 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.stg_orders
[0m00:36:36.087473 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_sample_data
[0m00:36:36.087844 [info ] [Thread-1  ]: 1 of 2 START sql view model public_staging.stg_orders .......................... [RUN]
[0m00:36:36.088233 [info ] [Thread-2  ]: 2 of 2 START sql view model public_staging.stg_sample_data ..................... [RUN]
[0m00:36:36.088757 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.stg_orders)
[0m00:36:36.089202 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_airflow_public_marts, now model.simple_dbt_project.stg_sample_data)
[0m00:36:36.089505 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m00:36:36.089813 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_sample_data
[0m00:36:36.095539 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m00:36:36.097501 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_sample_data"
[0m00:36:36.098979 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_sample_data (compile): 00:36:36.095821 => 00:36:36.098822
[0m00:36:36.099286 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 00:36:36.090018 => 00:36:36.099153
[0m00:36:36.099867 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.stg_orders
[0m00:36:36.099543 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_sample_data
[0m00:36:36.121960 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_sample_data"
[0m00:36:36.122311 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m00:36:36.123977 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:36:36.124314 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: BEGIN
[0m00:36:36.124573 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m00:36:36.125059 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m00:36:36.125303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:36:36.124805 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:36:36.127557 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m00:36:36.127937 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m00:36:36.128464 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m00:36:36.128227 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m00:36:36.128900 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:36:36.129458 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */

  create view "airflow"."public_staging"."stg_sample_data__dbt_tmp"
    
    
  as (
    

SELECT
    id::integer as user_id,
    name as full_name,
    country as country_code,
    current_timestamp as loaded_at
FROM "airflow"."public"."sample_data"
  );
[0m00:36:36.129221 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw.orders" does not exist
LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
              ^

[0m00:36:36.129881 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: ROLLBACK
[0m00:36:36.130514 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 00:36:36.100059 => 00:36:36.130312
[0m00:36:36.130848 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: Close
[0m00:36:36.132093 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:36:36.132894 [debug] [Thread-1  ]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m00:36:36.137885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117d3c8a-ede7-4823-984c-5751b1728d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9980d4c0>]}
[0m00:36:36.138324 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model public_staging.stg_orders ................. [[31mERROR[0m in 0.05s]
[0m00:36:36.138804 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.stg_orders
[0m00:36:36.137443 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:36:36.139248 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
alter table "airflow"."public_staging"."stg_sample_data" rename to "stg_sample_data__dbt_backup"
[0m00:36:36.139851 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:36:36.141770 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:36:36.142065 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
alter table "airflow"."public_staging"."stg_sample_data__dbt_tmp" rename to "stg_sample_data"
[0m00:36:36.142472 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:36:36.151807 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: COMMIT
[0m00:36:36.152136 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:36:36.152424 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: COMMIT
[0m00:36:36.153183 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m00:36:36.157524 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public_staging"."stg_sample_data__dbt_backup"
[0m00:36:36.159989 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m00:36:36.160301 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
drop view if exists "airflow"."public_staging"."stg_sample_data__dbt_backup" cascade
[0m00:36:36.161280 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m00:36:36.162194 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_sample_data (execute): 00:36:36.119835 => 00:36:36.162062
[0m00:36:36.162485 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: Close
[0m00:36:36.163057 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117d3c8a-ede7-4823-984c-5751b1728d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e722e0>]}
[0m00:36:36.163544 [info ] [Thread-2  ]: 2 of 2 OK created sql view model public_staging.stg_sample_data ................ [[32mCREATE VIEW[0m in 0.07s]
[0m00:36:36.164178 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_sample_data
[0m00:36:36.165382 [debug] [MainThread]: Using postgres connection "master"
[0m00:36:36.165677 [debug] [MainThread]: On master: BEGIN
[0m00:36:36.165925 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:36:36.168189 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:36:36.168495 [debug] [MainThread]: On master: COMMIT
[0m00:36:36.168765 [debug] [MainThread]: Using postgres connection "master"
[0m00:36:36.168995 [debug] [MainThread]: On master: COMMIT
[0m00:36:36.169275 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:36:36.169504 [debug] [MainThread]: On master: Close
[0m00:36:36.170069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:36:36.170366 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_sample_data' was properly closed.
[0m00:36:36.170633 [debug] [MainThread]: Connection 'list_airflow_public_staging' was properly closed.
[0m00:36:36.170892 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m00:36:36.171191 [info ] [MainThread]: 
[0m00:36:36.171492 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m00:36:36.172050 [debug] [MainThread]: Command end result
[0m00:36:36.178617 [info ] [MainThread]: 
[0m00:36:36.178975 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:36:36.179236 [info ] [MainThread]: 
[0m00:36:36.179498 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m00:36:36.179752 [info ] [MainThread]: 
[0m00:36:36.180062 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:36:36.180649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.42196828, "process_user_time": 1.831805, "process_kernel_time": 0.150819, "process_mem_max_rss": "152104", "process_out_blocks": "1767", "command_success": false, "process_in_blocks": "0"}
[0m00:36:36.181021 [debug] [MainThread]: Command `dbt run` failed at 00:36:36.180930 after 0.42 seconds
[0m00:36:36.181310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d14dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b95970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99bc39a0>]}
[0m00:36:36.181608 [debug] [MainThread]: Flushing usage events
[0m05:07:54.945099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a570f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b44790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b44d00>]}


============================== 05:07:54.949837 | 3c76fca8-4cb5-4f29-9366-39be37ba77bf ==============================
[0m05:07:54.949837 [info ] [MainThread]: Running with dbt=1.7.3
[0m05:07:54.950425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed --profiles-dir . --select tag:reference --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:07:55.113950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c76fca8-4cb5-4f29-9366-39be37ba77bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894178b0>]}
[0m05:07:55.163625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c76fca8-4cb5-4f29-9366-39be37ba77bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8842c1c0>]}
[0m05:07:55.164203 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m05:07:55.169522 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m05:07:55.199763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:07:55.200205 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:07:55.204722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c76fca8-4cb5-4f29-9366-39be37ba77bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86cbbbe0>]}
[0m05:07:55.216284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c76fca8-4cb5-4f29-9366-39be37ba77bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d589d0>]}
[0m05:07:55.216689 [info ] [MainThread]: Found 6 models, 1 seed, 15 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m05:07:55.217020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c76fca8-4cb5-4f29-9366-39be37ba77bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d58bb0>]}
[0m05:07:55.217885 [info ] [MainThread]: 
[0m05:07:55.218431 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:07:55.219557 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m05:07:55.227214 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m05:07:55.227653 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m05:07:55.227995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:07:55.236121 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:07:55.237083 [debug] [ThreadPool]: On list_airflow: Close
[0m05:07:55.238703 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m05:07:55.242913 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m05:07:55.243438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public_staging)
[0m05:07:55.243855 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m05:07:55.244337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public_marts'
[0m05:07:55.246286 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m05:07:55.246748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:07:55.249163 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m05:07:55.249783 [debug] [ThreadPool]: On list_airflow_public_staging: BEGIN
[0m05:07:55.250589 [debug] [ThreadPool]: On list_airflow_public_marts: BEGIN
[0m05:07:55.250989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:07:55.251338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:07:55.255702 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:07:55.256275 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m05:07:55.256706 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:07:55.257043 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:07:55.258567 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:07:55.259338 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m05:07:55.259882 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m05:07:55.260411 [debug] [ThreadPool]: On list_airflow_public_staging: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m05:07:55.260856 [debug] [ThreadPool]: On list_airflow_public_marts: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_marts"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m05:07:55.263210 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m05:07:55.263600 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:07:55.265059 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m05:07:55.265433 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m05:07:55.266368 [debug] [ThreadPool]: On list_airflow_public_marts: ROLLBACK
[0m05:07:55.267277 [debug] [ThreadPool]: On list_airflow_public_staging: ROLLBACK
[0m05:07:55.267563 [debug] [ThreadPool]: On list_airflow_public: Close
[0m05:07:55.267889 [debug] [ThreadPool]: On list_airflow_public_marts: Close
[0m05:07:55.268155 [debug] [ThreadPool]: On list_airflow_public_staging: Close
[0m05:07:55.285735 [debug] [MainThread]: Using postgres connection "master"
[0m05:07:55.288851 [debug] [MainThread]: On master: BEGIN
[0m05:07:55.289935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:07:55.294646 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:07:55.295409 [debug] [MainThread]: Using postgres connection "master"
[0m05:07:55.295888 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:07:55.332038 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m05:07:55.334580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c76fca8-4cb5-4f29-9366-39be37ba77bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86cbbf10>]}
[0m05:07:55.335287 [debug] [MainThread]: On master: ROLLBACK
[0m05:07:55.335934 [debug] [MainThread]: Using postgres connection "master"
[0m05:07:55.337264 [debug] [MainThread]: On master: BEGIN
[0m05:07:55.339374 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:07:55.340356 [debug] [MainThread]: On master: COMMIT
[0m05:07:55.340948 [debug] [MainThread]: Using postgres connection "master"
[0m05:07:55.341589 [debug] [MainThread]: On master: COMMIT
[0m05:07:55.342309 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:07:55.342827 [debug] [MainThread]: On master: Close
[0m05:07:55.343729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:07:55.344226 [info ] [MainThread]: 
[0m05:07:55.353707 [debug] [Thread-1  ]: Began running node seed.simple_dbt_project.sample_data
[0m05:07:55.355094 [info ] [Thread-1  ]: 1 of 1 START seed file public.sample_data ...................................... [RUN]
[0m05:07:55.356366 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public_staging, now seed.simple_dbt_project.sample_data)
[0m05:07:55.356936 [debug] [Thread-1  ]: Began compiling node seed.simple_dbt_project.sample_data
[0m05:07:55.357329 [debug] [Thread-1  ]: Timing info for seed.simple_dbt_project.sample_data (compile): 05:07:55.357157 => 05:07:55.357160
[0m05:07:55.357643 [debug] [Thread-1  ]: Began executing node seed.simple_dbt_project.sample_data
[0m05:07:55.390665 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."sample_data"
[0m05:07:55.393885 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m05:07:55.394357 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.simple_dbt_project.sample_data"} */
drop table if exists "airflow"."public"."sample_data" cascade
[0m05:07:55.394641 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:07:55.399268 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m05:07:55.404717 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m05:07:55.405816 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: BEGIN
[0m05:07:55.406804 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m05:07:55.407462 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m05:07:55.408174 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "seed.simple_dbt_project.sample_data"} */

    create table "airflow"."public"."sample_data" ("id" integer,"name" text,"country" text)
  
[0m05:07:55.413399 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m05:07:55.424984 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m05:07:55.425457 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: 
          insert into "airflow"."public"."sample_data" ("id", "name", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m05:07:55.426587 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
[0m05:07:55.433087 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.simple_dbt_project.sample_data"
[0m05:07:55.447593 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: COMMIT
[0m05:07:55.448866 [debug] [Thread-1  ]: Using postgres connection "seed.simple_dbt_project.sample_data"
[0m05:07:55.451831 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: COMMIT
[0m05:07:55.457209 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m05:07:55.458959 [debug] [Thread-1  ]: Timing info for seed.simple_dbt_project.sample_data (execute): 05:07:55.357845 => 05:07:55.458613
[0m05:07:55.459467 [debug] [Thread-1  ]: On seed.simple_dbt_project.sample_data: Close
[0m05:07:55.460212 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c76fca8-4cb5-4f29-9366-39be37ba77bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86bc9640>]}
[0m05:07:55.460780 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.sample_data .................................. [[32mCREATE 3[0m in 0.10s]
[0m05:07:55.461379 [debug] [Thread-1  ]: Finished running node seed.simple_dbt_project.sample_data
[0m05:07:55.462618 [debug] [MainThread]: Using postgres connection "master"
[0m05:07:55.462959 [debug] [MainThread]: On master: BEGIN
[0m05:07:55.463760 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:07:55.473214 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:07:55.473917 [debug] [MainThread]: On master: COMMIT
[0m05:07:55.474589 [debug] [MainThread]: Using postgres connection "master"
[0m05:07:55.475103 [debug] [MainThread]: On master: COMMIT
[0m05:07:55.476188 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:07:55.476575 [debug] [MainThread]: On master: Close
[0m05:07:55.478749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:07:55.481320 [debug] [MainThread]: Connection 'seed.simple_dbt_project.sample_data' was properly closed.
[0m05:07:55.481674 [debug] [MainThread]: Connection 'list_airflow_public' was properly closed.
[0m05:07:55.481928 [debug] [MainThread]: Connection 'list_airflow_public_marts' was properly closed.
[0m05:07:55.482302 [info ] [MainThread]: 
[0m05:07:55.482734 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m05:07:55.483296 [debug] [MainThread]: Command end result
[0m05:07:55.490968 [info ] [MainThread]: 
[0m05:07:55.491508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:07:55.491898 [info ] [MainThread]: 
[0m05:07:55.492280 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:07:55.493297 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.57602805, "process_user_time": 2.295877, "process_kernel_time": 0.365643, "process_mem_max_rss": "152116", "process_out_blocks": "1752", "process_in_blocks": "0"}
[0m05:07:55.493876 [debug] [MainThread]: Command `dbt seed` succeeded at 05:07:55.493764 after 0.58 seconds
[0m05:07:55.494253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a570f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b81700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b8ecd0>]}
[0m05:07:55.494610 [debug] [MainThread]: Flushing usage events
[0m05:08:00.709120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9ef0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb74c4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb74c4e50>]}


============================== 05:08:00.713511 | 7581be40-5700-4812-895b-73c0019bc87c ==============================
[0m05:08:00.713511 [info ] [MainThread]: Running with dbt=1.7.3
[0m05:08:00.714066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . --select tag:staging --full-refresh', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:08:00.872357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7581be40-5700-4812-895b-73c0019bc87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb74c9580>]}
[0m05:08:00.921721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7581be40-5700-4812-895b-73c0019bc87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75864c0>]}
[0m05:08:00.922353 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m05:08:00.927496 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m05:08:00.949936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:08:00.950275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:08:00.954699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7581be40-5700-4812-895b-73c0019bc87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6654b20>]}
[0m05:08:00.965491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7581be40-5700-4812-895b-73c0019bc87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb670f8e0>]}
[0m05:08:00.965918 [info ] [MainThread]: Found 6 models, 1 seed, 15 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m05:08:00.966247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7581be40-5700-4812-895b-73c0019bc87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6635eb0>]}
[0m05:08:00.967134 [info ] [MainThread]: 
[0m05:08:00.967697 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:08:00.968939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m05:08:00.978011 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m05:08:00.978400 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m05:08:00.978663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:08:00.988416 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:08:00.989387 [debug] [ThreadPool]: On list_airflow: Close
[0m05:08:00.990964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public_marts)
[0m05:08:00.995038 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m05:08:00.995521 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m05:08:00.995755 [debug] [ThreadPool]: On list_airflow_public_marts: BEGIN
[0m05:08:00.996556 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public_staging'
[0m05:08:00.997805 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m05:08:00.998157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:08:00.999782 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m05:08:01.000083 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m05:08:01.000623 [debug] [ThreadPool]: On list_airflow_public_staging: BEGIN
[0m05:08:01.001044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:08:01.001392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:08:01.003516 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:08:01.004162 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m05:08:01.004553 [debug] [ThreadPool]: On list_airflow_public_marts: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_marts"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m05:08:01.004912 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:08:01.005290 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m05:08:01.005614 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:08:01.005897 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:08:01.006234 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m05:08:01.006727 [debug] [ThreadPool]: On list_airflow_public_staging: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m05:08:01.007263 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:08:01.008297 [debug] [ThreadPool]: On list_airflow_public_marts: ROLLBACK
[0m05:08:01.008797 [debug] [ThreadPool]: On list_airflow_public_marts: Close
[0m05:08:01.009100 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m05:08:01.009359 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:08:01.012065 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m05:08:01.013596 [debug] [ThreadPool]: On list_airflow_public_staging: ROLLBACK
[0m05:08:01.014234 [debug] [ThreadPool]: On list_airflow_public: Close
[0m05:08:01.014560 [debug] [ThreadPool]: On list_airflow_public_staging: Close
[0m05:08:01.023069 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:01.023403 [debug] [MainThread]: On master: BEGIN
[0m05:08:01.023644 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:08:01.025727 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:08:01.026018 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:01.026325 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:08:01.030923 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m05:08:01.031707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7581be40-5700-4812-895b-73c0019bc87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6947340>]}
[0m05:08:01.032067 [debug] [MainThread]: On master: ROLLBACK
[0m05:08:01.032440 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:01.032681 [debug] [MainThread]: On master: BEGIN
[0m05:08:01.033069 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:08:01.033362 [debug] [MainThread]: On master: COMMIT
[0m05:08:01.033594 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:01.033812 [debug] [MainThread]: On master: COMMIT
[0m05:08:01.034110 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:08:01.034382 [debug] [MainThread]: On master: Close
[0m05:08:01.034891 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:08:01.035221 [info ] [MainThread]: 
[0m05:08:01.140315 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.stg_orders
[0m05:08:01.140852 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_sample_data
[0m05:08:01.141403 [info ] [Thread-1  ]: 1 of 2 START sql view model public_staging.stg_orders .......................... [RUN]
[0m05:08:01.142008 [info ] [Thread-2  ]: 2 of 2 START sql view model public_staging.stg_sample_data ..................... [RUN]
[0m05:08:01.142727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public_staging, now model.simple_dbt_project.stg_orders)
[0m05:08:01.143381 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.stg_sample_data)
[0m05:08:01.143816 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m05:08:01.144278 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_sample_data
[0m05:08:01.152119 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m05:08:01.154797 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_sample_data"
[0m05:08:01.225797 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 05:08:01.144560 => 05:08:01.225412
[0m05:08:01.228478 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.stg_orders
[0m05:08:01.229152 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_sample_data (compile): 05:08:01.152499 => 05:08:01.228958
[0m05:08:01.241674 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_sample_data
[0m05:08:01.265361 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_sample_data"
[0m05:08:01.265841 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m05:08:01.272676 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m05:08:01.273810 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: BEGIN
[0m05:08:01.274539 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m05:08:01.273432 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m05:08:01.277159 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m05:08:01.278113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:08:01.281013 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m05:08:01.281938 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m05:08:01.284970 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m05:08:01.284567 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m05:08:01.285822 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */

  create view "airflow"."public_staging"."stg_sample_data__dbt_tmp"
    
    
  as (
    

SELECT
    id::integer as user_id,
    name as full_name,
    country as country_code,
    current_timestamp as loaded_at
FROM "airflow"."public"."sample_data"
  );
[0m05:08:01.285350 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m05:08:01.286703 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw.orders" does not exist
LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
              ^

[0m05:08:01.287189 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: ROLLBACK
[0m05:08:01.287828 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 05:08:01.229377 => 05:08:01.287634
[0m05:08:01.288239 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: Close
[0m05:08:01.288573 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:08:01.294325 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m05:08:01.296153 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
alter table "airflow"."public_staging"."stg_sample_data__dbt_tmp" rename to "stg_sample_data"
[0m05:08:01.295789 [debug] [Thread-1  ]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m05:08:01.296768 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7581be40-5700-4812-895b-73c0019bc87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65a2340>]}
[0m05:08:01.297560 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model public_staging.stg_orders ................. [[31mERROR[0m in 0.15s]
[0m05:08:01.298057 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.stg_orders
[0m05:08:01.297104 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:08:01.307799 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: COMMIT
[0m05:08:01.308285 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m05:08:01.308578 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: COMMIT
[0m05:08:01.309770 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m05:08:01.314247 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public_staging"."stg_sample_data__dbt_backup"
[0m05:08:01.317008 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m05:08:01.317383 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
drop view if exists "airflow"."public_staging"."stg_sample_data__dbt_backup" cascade
[0m05:08:01.318121 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m05:08:01.319159 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_sample_data (execute): 05:08:01.248513 => 05:08:01.318999
[0m05:08:01.319446 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: Close
[0m05:08:01.320020 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7581be40-5700-4812-895b-73c0019bc87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6534670>]}
[0m05:08:01.320533 [info ] [Thread-2  ]: 2 of 2 OK created sql view model public_staging.stg_sample_data ................ [[32mCREATE VIEW[0m in 0.18s]
[0m05:08:01.320987 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_sample_data
[0m05:08:01.322361 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:01.322665 [debug] [MainThread]: On master: BEGIN
[0m05:08:01.322926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:08:01.325037 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:08:01.325367 [debug] [MainThread]: On master: COMMIT
[0m05:08:01.325648 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:01.325903 [debug] [MainThread]: On master: COMMIT
[0m05:08:01.326199 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:08:01.326443 [debug] [MainThread]: On master: Close
[0m05:08:01.326909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:08:01.327173 [debug] [MainThread]: Connection 'list_airflow_public_marts' was properly closed.
[0m05:08:01.327394 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_sample_data' was properly closed.
[0m05:08:01.327645 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m05:08:01.327908 [info ] [MainThread]: 
[0m05:08:01.328203 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m05:08:01.328734 [debug] [MainThread]: Command end result
[0m05:08:01.338168 [info ] [MainThread]: 
[0m05:08:01.338595 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:08:01.338926 [info ] [MainThread]: 
[0m05:08:01.339609 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m05:08:01.339961 [info ] [MainThread]: 
[0m05:08:01.340342 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m05:08:01.341314 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.65941787, "process_user_time": 2.217795, "process_kernel_time": 0.252778, "process_mem_max_rss": "152132", "process_out_blocks": "1766", "command_success": false, "process_in_blocks": "0"}
[0m05:08:01.342033 [debug] [MainThread]: Command `dbt run` failed at 05:08:01.341889 after 0.66 seconds
[0m05:08:01.342486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9ef0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75864c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb688de20>]}
[0m05:08:01.358852 [debug] [MainThread]: Flushing usage events
[0m06:10:41.820934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89129d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86741730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86741c10>]}


============================== 06:10:41.824935 | f65d8d9d-4c06-4218-a3d8-a9104a66457a ==============================
[0m06:10:41.824935 [info ] [MainThread]: Running with dbt=1.7.3
[0m06:10:41.825462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir . --select tag:staging --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m06:10:41.974662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f65d8d9d-4c06-4218-a3d8-a9104a66457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880de430>]}
[0m06:10:42.026047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f65d8d9d-4c06-4218-a3d8-a9104a66457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b3f940>]}
[0m06:10:42.026726 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m06:10:42.032478 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m06:10:42.056840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:10:42.057237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:10:42.061814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f65d8d9d-4c06-4218-a3d8-a9104a66457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858d6b80>]}
[0m06:10:42.077316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f65d8d9d-4c06-4218-a3d8-a9104a66457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8598d940>]}
[0m06:10:42.078010 [info ] [MainThread]: Found 6 models, 1 seed, 15 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m06:10:42.078523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f65d8d9d-4c06-4218-a3d8-a9104a66457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8598dac0>]}
[0m06:10:42.079972 [info ] [MainThread]: 
[0m06:10:42.080717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:10:42.081754 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:10:42.089264 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:10:42.089672 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:10:42.089927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:10:42.095371 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m06:10:42.096506 [debug] [ThreadPool]: On list_airflow: Close
[0m06:10:42.098511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public_staging)
[0m06:10:42.102698 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m06:10:42.103272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m06:10:42.103700 [debug] [ThreadPool]: On list_airflow_public_staging: BEGIN
[0m06:10:42.104259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public_marts'
[0m06:10:42.105753 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m06:10:42.106132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:10:42.107624 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m06:10:42.107968 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m06:10:42.108464 [debug] [ThreadPool]: On list_airflow_public_marts: BEGIN
[0m06:10:42.109011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:10:42.109381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:10:42.110704 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:10:42.111424 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m06:10:42.111798 [debug] [ThreadPool]: On list_airflow_public_staging: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m06:10:42.112610 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:10:42.112953 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:10:42.113258 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m06:10:42.113667 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m06:10:42.114307 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m06:10:42.114602 [debug] [ThreadPool]: On list_airflow_public_marts: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_marts"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m06:10:42.114967 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:10:42.115947 [debug] [ThreadPool]: On list_airflow_public_staging: ROLLBACK
[0m06:10:42.116747 [debug] [ThreadPool]: On list_airflow_public_staging: Close
[0m06:10:42.118496 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m06:10:42.118827 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m06:10:42.120152 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m06:10:42.121111 [debug] [ThreadPool]: On list_airflow_public_marts: ROLLBACK
[0m06:10:42.121651 [debug] [ThreadPool]: On list_airflow_public: Close
[0m06:10:42.121929 [debug] [ThreadPool]: On list_airflow_public_marts: Close
[0m06:10:42.132411 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:42.132826 [debug] [MainThread]: On master: BEGIN
[0m06:10:42.133100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:10:42.135675 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:10:42.136035 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:42.136347 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:10:42.140841 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m06:10:42.141953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f65d8d9d-4c06-4218-a3d8-a9104a66457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858d6c70>]}
[0m06:10:42.142339 [debug] [MainThread]: On master: ROLLBACK
[0m06:10:42.142782 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:42.143094 [debug] [MainThread]: On master: BEGIN
[0m06:10:42.143599 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:10:42.143904 [debug] [MainThread]: On master: COMMIT
[0m06:10:42.144159 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:42.144413 [debug] [MainThread]: On master: COMMIT
[0m06:10:42.144760 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:10:42.145062 [debug] [MainThread]: On master: Close
[0m06:10:42.145579 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:10:42.145903 [info ] [MainThread]: 
[0m06:10:42.153132 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.stg_orders
[0m06:10:42.153648 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_sample_data
[0m06:10:42.154347 [info ] [Thread-1  ]: 1 of 2 START sql view model public_staging.stg_orders .......................... [RUN]
[0m06:10:42.155781 [info ] [Thread-2  ]: 2 of 2 START sql view model public_staging.stg_sample_data ..................... [RUN]
[0m06:10:42.156555 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public_marts, now model.simple_dbt_project.stg_orders)
[0m06:10:42.157155 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.stg_sample_data)
[0m06:10:42.157620 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m06:10:42.158093 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_sample_data
[0m06:10:42.167175 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m06:10:42.170744 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_sample_data"
[0m06:10:42.172096 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 06:10:42.158433 => 06:10:42.171884
[0m06:10:42.172537 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.stg_orders
[0m06:10:42.172990 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_sample_data (compile): 06:10:42.167705 => 06:10:42.172784
[0m06:10:42.189624 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_sample_data
[0m06:10:42.207127 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m06:10:42.207791 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_sample_data"
[0m06:10:42.208949 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m06:10:42.209310 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m06:10:42.210016 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: BEGIN
[0m06:10:42.209602 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m06:10:42.210985 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m06:10:42.212166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:10:42.219370 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m06:10:42.220328 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m06:10:42.220770 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m06:10:42.219981 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m06:10:42.221541 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m06:10:42.222357 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */

  create view "airflow"."public_staging"."stg_sample_data__dbt_tmp"
    
    
  as (
    

SELECT
    id::integer as user_id,
    name as full_name,
    country as country_code,
    current_timestamp as loaded_at
FROM "airflow"."public"."sample_data"
  );
[0m06:10:42.222000 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw.orders" does not exist
LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
              ^

[0m06:10:42.223054 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: ROLLBACK
[0m06:10:42.223876 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 06:10:42.173206 => 06:10:42.223658
[0m06:10:42.224375 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: Close
[0m06:10:42.224737 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m06:10:42.227007 [debug] [Thread-1  ]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m06:10:42.235521 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f65d8d9d-4c06-4218-a3d8-a9104a66457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fba730>]}
[0m06:10:42.234905 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m06:10:42.236166 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model public_staging.stg_orders ................. [[31mERROR[0m in 0.08s]
[0m06:10:42.237144 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
alter table "airflow"."public_staging"."stg_sample_data" rename to "stg_sample_data__dbt_backup"
[0m06:10:42.240612 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.stg_orders
[0m06:10:42.243528 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:10:42.247538 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m06:10:42.248112 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
alter table "airflow"."public_staging"."stg_sample_data__dbt_tmp" rename to "stg_sample_data"
[0m06:10:42.248885 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:10:42.266318 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: COMMIT
[0m06:10:42.267017 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m06:10:42.267436 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: COMMIT
[0m06:10:42.268666 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m06:10:42.274740 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public_staging"."stg_sample_data__dbt_backup"
[0m06:10:42.277660 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m06:10:42.278072 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
drop view if exists "airflow"."public_staging"."stg_sample_data__dbt_backup" cascade
[0m06:10:42.279279 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m06:10:42.280455 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_sample_data (execute): 06:10:42.195451 => 06:10:42.280286
[0m06:10:42.280777 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: Close
[0m06:10:42.281442 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f65d8d9d-4c06-4218-a3d8-a9104a66457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f9db80>]}
[0m06:10:42.282004 [info ] [Thread-2  ]: 2 of 2 OK created sql view model public_staging.stg_sample_data ................ [[32mCREATE VIEW[0m in 0.12s]
[0m06:10:42.282629 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_sample_data
[0m06:10:42.283779 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:42.284098 [debug] [MainThread]: On master: BEGIN
[0m06:10:42.284354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:10:42.287036 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:10:42.287817 [debug] [MainThread]: On master: COMMIT
[0m06:10:42.288439 [debug] [MainThread]: Using postgres connection "master"
[0m06:10:42.288759 [debug] [MainThread]: On master: COMMIT
[0m06:10:42.289159 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:10:42.289442 [debug] [MainThread]: On master: Close
[0m06:10:42.290081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:10:42.290411 [debug] [MainThread]: Connection 'list_airflow_public_staging' was properly closed.
[0m06:10:42.290665 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_sample_data' was properly closed.
[0m06:10:42.290945 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m06:10:42.291310 [info ] [MainThread]: 
[0m06:10:42.291668 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m06:10:42.292293 [debug] [MainThread]: Command end result
[0m06:10:42.300476 [info ] [MainThread]: 
[0m06:10:42.300976 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:10:42.301359 [info ] [MainThread]: 
[0m06:10:42.301879 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m06:10:42.302250 [info ] [MainThread]: 
[0m06:10:42.302651 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m06:10:42.303453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.50848436, "process_user_time": 2.394599, "process_kernel_time": 0.191349, "process_mem_max_rss": "152124", "process_out_blocks": "1767", "command_success": false, "process_in_blocks": "0"}
[0m06:10:42.303910 [debug] [MainThread]: Command `dbt run` failed at 06:10:42.303813 after 0.51 seconds
[0m06:10:42.304249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89129d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880de430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b0d250>]}
[0m06:10:42.304586 [debug] [MainThread]: Flushing usage events
[0m07:00:01.546081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ee6b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805f77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805f7b50>]}


============================== 07:00:01.564254 | 709517c3-6960-4670-9614-2b98f6a7fdaa ==============================
[0m07:00:01.564254 [info ] [MainThread]: Running with dbt=1.7.3
[0m07:00:01.566219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir . --select tag:staging --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:00:02.215020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '709517c3-6960-4670-9614-2b98f6a7fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d9caf0>]}
[0m07:00:02.365132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '709517c3-6960-4670-9614-2b98f6a7fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff856314c0>]}
[0m07:00:02.367030 [info ] [MainThread]: Registered adapter: postgres=1.7.3
[0m07:00:02.383093 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m07:00:02.475148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:00:02.476781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:00:02.497874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '709517c3-6960-4670-9614-2b98f6a7fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f696a90>]}
[0m07:00:02.546007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '709517c3-6960-4670-9614-2b98f6a7fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f750850>]}
[0m07:00:02.549989 [info ] [MainThread]: Found 6 models, 1 seed, 15 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m07:00:02.551880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '709517c3-6960-4670-9614-2b98f6a7fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7507c0>]}
[0m07:00:02.558347 [info ] [MainThread]: 
[0m07:00:02.561661 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:00:02.566962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:00:02.611287 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:00:02.613181 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:00:02.614368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:02.668218 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m07:00:02.672854 [debug] [ThreadPool]: On list_airflow: Close
[0m07:00:02.687406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public_marts)
[0m07:00:02.700493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public_staging'
[0m07:00:02.725165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m07:00:02.733069 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m07:00:02.741071 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m07:00:02.753936 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m07:00:02.756983 [debug] [ThreadPool]: On list_airflow_public_marts: BEGIN
[0m07:00:02.761254 [debug] [ThreadPool]: On list_airflow_public_staging: BEGIN
[0m07:00:02.766165 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m07:00:02.769219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:00:02.772600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:02.775628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:02.794845 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:00:02.798607 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_marts"
[0m07:00:02.801184 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:00:02.803936 [debug] [ThreadPool]: On list_airflow_public_marts: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_marts"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m07:00:02.805930 [debug] [ThreadPool]: Using postgres connection "list_airflow_public_staging"
[0m07:00:02.807449 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:00:02.808925 [debug] [ThreadPool]: On list_airflow_public_staging: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m07:00:02.810566 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m07:00:02.812348 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:00:02.818050 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:00:02.824854 [debug] [ThreadPool]: On list_airflow_public_marts: ROLLBACK
[0m07:00:02.826771 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m07:00:02.828570 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.0 seconds
[0m07:00:02.830743 [debug] [ThreadPool]: On list_airflow_public_marts: Close
[0m07:00:02.835248 [debug] [ThreadPool]: On list_airflow_public_staging: ROLLBACK
[0m07:00:02.842134 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m07:00:02.848335 [debug] [ThreadPool]: On list_airflow_public_staging: Close
[0m07:00:02.852133 [debug] [ThreadPool]: On list_airflow_public: Close
[0m07:00:02.905818 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:02.907453 [debug] [MainThread]: On master: BEGIN
[0m07:00:02.908811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:00:02.924935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:00:02.926402 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:02.927528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:00:02.949149 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m07:00:02.953489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '709517c3-6960-4670-9614-2b98f6a7fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8cfb20>]}
[0m07:00:02.955812 [debug] [MainThread]: On master: ROLLBACK
[0m07:00:02.957991 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:02.959475 [debug] [MainThread]: On master: BEGIN
[0m07:00:02.961776 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:00:02.962677 [debug] [MainThread]: On master: COMMIT
[0m07:00:02.963498 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:02.964224 [debug] [MainThread]: On master: COMMIT
[0m07:00:02.965247 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:00:02.966127 [debug] [MainThread]: On master: Close
[0m07:00:02.969361 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:00:02.971914 [info ] [MainThread]: 
[0m07:00:03.039468 [debug] [Thread-1  ]: Began running node model.simple_dbt_project.stg_orders
[0m07:00:03.042053 [debug] [Thread-2  ]: Began running node model.simple_dbt_project.stg_sample_data
[0m07:00:03.043943 [info ] [Thread-1  ]: 1 of 2 START sql view model public_staging.stg_orders .......................... [RUN]
[0m07:00:03.046135 [info ] [Thread-2  ]: 2 of 2 START sql view model public_staging.stg_sample_data ..................... [RUN]
[0m07:00:03.048426 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.simple_dbt_project.stg_orders)
[0m07:00:03.050033 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_airflow_public_staging, now model.simple_dbt_project.stg_sample_data)
[0m07:00:03.051196 [debug] [Thread-1  ]: Began compiling node model.simple_dbt_project.stg_orders
[0m07:00:03.052351 [debug] [Thread-2  ]: Began compiling node model.simple_dbt_project.stg_sample_data
[0m07:00:03.099409 [debug] [Thread-1  ]: Writing injected SQL for node "model.simple_dbt_project.stg_orders"
[0m07:00:03.101830 [debug] [Thread-2  ]: Writing injected SQL for node "model.simple_dbt_project.stg_sample_data"
[0m07:00:03.106109 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (compile): 07:00:03.053161 => 07:00:03.105118
[0m07:00:03.108185 [debug] [Thread-1  ]: Began executing node model.simple_dbt_project.stg_orders
[0m07:00:03.116609 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_sample_data (compile): 07:00:03.078245 => 07:00:03.115870
[0m07:00:03.125360 [debug] [Thread-2  ]: Began executing node model.simple_dbt_project.stg_sample_data
[0m07:00:03.246892 [debug] [Thread-1  ]: Writing runtime sql for node "model.simple_dbt_project.stg_orders"
[0m07:00:03.251061 [debug] [Thread-2  ]: Writing runtime sql for node "model.simple_dbt_project.stg_sample_data"
[0m07:00:03.253968 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m07:00:03.255111 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: BEGIN
[0m07:00:03.256906 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:00:03.256086 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m07:00:03.259056 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: BEGIN
[0m07:00:03.260331 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m07:00:03.266882 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m07:00:03.270577 [debug] [Thread-1  ]: Using postgres connection "model.simple_dbt_project.stg_orders"
[0m07:00:03.273588 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_orders"} */

  create view "airflow"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

-- Staging model to clean and standardize raw orders data
SELECT
    order_id,
    customer_id,
    CAST(order_date AS DATE) as order_date,
    status,
    amount,
    CURRENT_TIMESTAMP as loaded_at
FROM "airflow"."raw"."orders"  -- This would point to your raw orders table
  );
[0m07:00:03.276166 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m07:00:03.277511 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw.orders" does not exist
LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
              ^

[0m07:00:03.278237 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m07:00:03.280130 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */

  create view "airflow"."public_staging"."stg_sample_data__dbt_tmp"
    
    
  as (
    

SELECT
    id::integer as user_id,
    name as full_name,
    country as country_code,
    current_timestamp as loaded_at
FROM "airflow"."public"."sample_data"
  );
[0m07:00:03.279187 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: ROLLBACK
[0m07:00:03.282212 [debug] [Thread-1  ]: Timing info for model.simple_dbt_project.stg_orders (execute): 07:00:03.109440 => 07:00:03.281586
[0m07:00:03.283606 [debug] [Thread-1  ]: On model.simple_dbt_project.stg_orders: Close
[0m07:00:03.290868 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:00:03.294743 [debug] [Thread-1  ]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m07:00:03.311420 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m07:00:03.313092 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '709517c3-6960-4670-9614-2b98f6a7fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5907c0>]}
[0m07:00:03.314199 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
alter table "airflow"."public_staging"."stg_sample_data" rename to "stg_sample_data__dbt_backup"
[0m07:00:03.316059 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model public_staging.stg_orders ................. [[31mERROR[0m in 0.27s]
[0m07:00:03.318588 [debug] [Thread-1  ]: Finished running node model.simple_dbt_project.stg_orders
[0m07:00:03.319342 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:00:03.326745 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m07:00:03.327756 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
alter table "airflow"."public_staging"."stg_sample_data__dbt_tmp" rename to "stg_sample_data"
[0m07:00:03.329352 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:00:03.373906 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: COMMIT
[0m07:00:03.375253 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m07:00:03.376408 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: COMMIT
[0m07:00:03.378676 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m07:00:03.393069 [debug] [Thread-2  ]: Applying DROP to: "airflow"."public_staging"."stg_sample_data__dbt_backup"
[0m07:00:03.402164 [debug] [Thread-2  ]: Using postgres connection "model.simple_dbt_project.stg_sample_data"
[0m07:00:03.403481 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "default", "target_name": "dev", "node_id": "model.simple_dbt_project.stg_sample_data"} */
drop view if exists "airflow"."public_staging"."stg_sample_data__dbt_backup" cascade
[0m07:00:03.407247 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m07:00:03.410724 [debug] [Thread-2  ]: Timing info for model.simple_dbt_project.stg_sample_data (execute): 07:00:03.142416 => 07:00:03.410235
[0m07:00:03.411671 [debug] [Thread-2  ]: On model.simple_dbt_project.stg_sample_data: Close
[0m07:00:03.413577 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '709517c3-6960-4670-9614-2b98f6a7fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f56a7c0>]}
[0m07:00:03.415157 [info ] [Thread-2  ]: 2 of 2 OK created sql view model public_staging.stg_sample_data ................ [[32mCREATE VIEW[0m in 0.36s]
[0m07:00:03.418352 [debug] [Thread-2  ]: Finished running node model.simple_dbt_project.stg_sample_data
[0m07:00:03.425941 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:03.427060 [debug] [MainThread]: On master: BEGIN
[0m07:00:03.427984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:00:03.436811 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:00:03.437930 [debug] [MainThread]: On master: COMMIT
[0m07:00:03.438748 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:03.439482 [debug] [MainThread]: On master: COMMIT
[0m07:00:03.440545 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:00:03.441559 [debug] [MainThread]: On master: Close
[0m07:00:03.443332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:00:03.444336 [debug] [MainThread]: Connection 'list_airflow_public_marts' was properly closed.
[0m07:00:03.445165 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_sample_data' was properly closed.
[0m07:00:03.446128 [debug] [MainThread]: Connection 'model.simple_dbt_project.stg_orders' was properly closed.
[0m07:00:03.447523 [info ] [MainThread]: 
[0m07:00:03.449694 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m07:00:03.455783 [debug] [MainThread]: Command end result
[0m07:00:03.518281 [info ] [MainThread]: 
[0m07:00:03.521768 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:00:03.522976 [info ] [MainThread]: 
[0m07:00:03.524654 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "raw.orders" does not exist
  LINE 17: FROM "airflow"."raw"."orders"  -- This would point to your r...
                ^
  compiled Code at target/run/simple_dbt_project/models/staging/stg_orders.sql
[0m07:00:03.525886 [info ] [MainThread]: 
[0m07:00:03.527226 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m07:00:03.532071 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0811799, "process_user_time": 6.75983, "process_kernel_time": 0.972586, "process_mem_max_rss": "152132", "process_out_blocks": "1767", "command_success": false, "process_in_blocks": "0"}
[0m07:00:03.534887 [debug] [MainThread]: Command `dbt run` failed at 07:00:03.534418 after 2.08 seconds
[0m07:00:03.536418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ee6b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f835b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7507c0>]}
[0m07:00:03.537493 [debug] [MainThread]: Flushing usage events
