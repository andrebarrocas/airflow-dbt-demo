{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.3", "generated_at": "2025-05-21T12:29:15.078015Z", "invocation_id": "7c1740e4-70c4-4aab-8c9b-5b32c77e8a3e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-21T12:29:14.908343Z", "completed_at": "2025-05-21T12:29:14.915723Z"}, {"name": "execute", "started_at": "2025-05-21T12:29:14.916735Z", "completed_at": "2025-05-21T12:29:14.988213Z"}], "thread_id": "Thread-1", "execution_time": 0.0836181640625, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.simple_dbt_project.my_first_model", "compiled": true, "compiled_code": "-- Simple example model\nSELECT 1 as id, 'Example' as name\nUNION ALL\nSELECT 2 as id, 'Test' as name", "relation_name": "\"airflow\".\"public\".\"my_first_model\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-21T12:29:14.912998Z", "completed_at": "2025-05-21T12:29:14.916436Z"}, {"name": "execute", "started_at": "2025-05-21T12:29:14.939439Z", "completed_at": "2025-05-21T12:29:14.989337Z"}], "thread_id": "Thread-2", "execution_time": 0.08530163764953613, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.simple_dbt_project.stg_orders", "compiled": true, "compiled_code": "\n\n-- Staging model to clean and standardize raw orders data\nSELECT\n    order_id,\n    customer_id,\n    CAST(order_date AS DATE) as order_date,\n    status,\n    amount,\n    CURRENT_TIMESTAMP as loaded_at\nFROM \"airflow\".\"raw\".\"orders\"  -- This would point to your raw orders table", "relation_name": "\"airflow\".\"public\".\"stg_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-21T12:29:15.003057Z", "completed_at": "2025-05-21T12:29:15.006586Z"}, {"name": "execute", "started_at": "2025-05-21T12:29:15.007702Z", "completed_at": "2025-05-21T12:29:15.064466Z"}], "thread_id": "Thread-3", "execution_time": 0.06747865676879883, "adapter_response": {"_message": "SELECT 2", "code": "SELECT", "rows_affected": 2}, "message": "SELECT 2", "failures": null, "unique_id": "model.simple_dbt_project.fct_daily_sales", "compiled": true, "compiled_code": "\n\nWITH daily_sales AS (\n    SELECT\n        DATE_TRUNC('day', order_date) as date,\n        COUNT(DISTINCT order_id) as total_orders,\n        COUNT(DISTINCT customer_id) as unique_customers,\n        SUM(amount) as total_amount\n    FROM \"airflow\".\"public\".\"stg_orders\"\n    WHERE status = 'completed'\n    GROUP BY 1\n)\n\nSELECT\n    date,\n    total_orders,\n    unique_customers,\n    total_amount,\n    total_amount / NULLIF(total_orders, 0) as avg_order_value,\n    total_amount / NULLIF(unique_customers, 0) as avg_customer_spend\nFROM daily_sales", "relation_name": "\"airflow\".\"public\".\"fct_daily_sales\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-21T12:29:14.999591Z", "completed_at": "2025-05-21T12:29:15.006167Z"}, {"name": "execute", "started_at": "2025-05-21T12:29:15.023914Z", "completed_at": "2025-05-21T12:29:15.068152Z"}], "thread_id": "Thread-4", "execution_time": 0.07148385047912598, "adapter_response": {"_message": "SELECT 3", "code": "SELECT", "rows_affected": 3}, "message": "SELECT 3", "failures": null, "unique_id": "model.simple_dbt_project.fct_customer_purchase_patterns", "compiled": true, "compiled_code": "\n\nWITH customer_orders AS (\n    SELECT\n        customer_id,\n        order_date,\n        amount,\n        LAG(order_date) OVER (\n            PARTITION BY customer_id \n            ORDER BY order_date\n        ) as previous_order_date\n    FROM \"airflow\".\"public\".\"stg_orders\"\n),\n\ncustomer_metrics AS (\n    SELECT\n        customer_id,\n        COUNT(*) as total_orders,\n        SUM(amount) as total_amount,\n        MIN(order_date) as first_order_date,\n        MAX(order_date) as last_order_date,\n        AVG(amount) as avg_order_amount,\n        -- Use PostgreSQL's date subtraction\n        AVG(\n            CASE \n                WHEN previous_order_date IS NOT NULL \n                THEN DATE_PART('day', order_date::timestamp - previous_order_date::timestamp)\n            END\n        ) as avg_days_between_orders\n    FROM customer_orders\n    GROUP BY customer_id\n)\n\nSELECT\n    customer_id,\n    total_orders,\n    total_amount,\n    first_order_date,\n    last_order_date,\n    avg_order_amount,\n    avg_days_between_orders,\n    CASE\n        WHEN total_orders >= 10 THEN 'High'\n        WHEN total_orders >= 5 THEN 'Medium'\n        ELSE 'Low'\n    END as frequency_segment,\n    CASE\n        WHEN avg_order_amount >= 200 THEN 'Premium'\n        WHEN avg_order_amount >= 100 THEN 'Standard'\n        ELSE 'Basic'\n    END as value_segment\nFROM customer_metrics", "relation_name": "\"airflow\".\"public\".\"fct_customer_purchase_patterns\""}], "elapsed_time": 0.2346491813659668, "args": {"invocation_command": "dbt run --profiles-dir .", "populate_cache": true, "log_format": "default", "macro_debugging": false, "indirect_selection": "eager", "use_colors_file": true, "version_check": true, "enable_legacy_logger": false, "use_colors": true, "introspect": true, "partial_parse_file_diff": true, "project_dir": "/opt/airflow/dbt_project", "log_level": "info", "log_level_file": "debug", "printer_width": 80, "profiles_dir": ".", "write_json": true, "log_format_file": "debug", "favor_state": false, "select": [], "vars": {}, "strict_mode": false, "cache_selected_only": false, "print": true, "show_resource_report": false, "partial_parse": true, "log_path": "/opt/airflow/dbt_project/logs", "static_parser": true, "defer": false, "which": "run", "log_file_max_bytes": 10485760, "quiet": false, "send_anonymous_usage_stats": true, "warn_error_options": {"include": [], "exclude": []}, "exclude": []}}